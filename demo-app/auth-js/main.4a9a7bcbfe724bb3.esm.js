/*! For license information please see main.4a9a7bcbfe724bb3.esm.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[179],{3435:(e,t,n)=>{"use strict";n(6025),n(9470),n(3661),n(4836),n(8127),n(4049),n(5979),n(217);function r(e){this.message=e}r.prototype=new Error,r.prototype.name="InvalidCharacterError";var i="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,s=0,o=0,a="";i=t.charAt(o++);~i&&(n=s%4?64*n+i:i,s++%4)?a+=String.fromCharCode(255&n>>(-2*s&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return a};function s(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(i(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return i(t)}}function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidTokenError";const a=function(e,t){if("string"!=typeof e)throw new o("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(s(e.split(".")[n]))}catch(e){throw new o("Invalid token specified: "+e.message)}};class c{}c.isCordova=()=>!!(window.cordova||window.phonegap||window.PhoneGap),c.isCapacitor=()=>{var e;return!(null==(e=window.Capacitor)||!e.isNativePlatform())},c.isNativeMobile=()=>c.isCapacitor()||c.isCordova(),c.decodeJwt=e=>{try{return e?a(e):e}catch(t){return console.warn("[@badisi/auth-js] Access token was not decoded as it is not a valid JWT."),e}},c.isUrlMatching=(e,t)=>void 0!==t&&e.includes(t),c.getBaseUrl=()=>{var e;const t=document.baseURI||(null==(e=document.querySelector("base"))?void 0:e.href)||location.origin;return t.endsWith("/")?t:`${t}/`},c.stringToURL=e=>{try{return new URL(e)}catch(t){const n=e.startsWith("/")?e.substring(1,e.length):e;return new URL(`${c.getBaseUrl()}${n}`)}};const l=!0,u=document.createElement("template");u.innerHTML='\n    <demo-app-main>\n        <demo-app-debug tabLabel="Debug"></demo-app-debug>\n        <demo-app-settings tabLabel="Settings"></demo-app-settings>\n    </demo-app-main>\n';class h extends HTMLElement{constructor(){var e;super(),this.demoAppMainEl=void 0,this.demoAppDebugEl=void 0,this.authManagerSubs=[],this.listeners=[],this.attachShadow({mode:"open"}),null==(e=this.shadowRoot)||e.appendChild(document.importNode(u.content,!0))}connectedCallback(){var e,t,n;this.demoAppMainEl=null==(e=this.shadowRoot)?void 0:e.querySelector("demo-app-main"),this.demoAppDebugEl=null==(t=this.shadowRoot)?void 0:t.querySelector("demo-app-debug");(null==(n=this.shadowRoot)?void 0:n.querySelector("demo-app-settings")).isDev=!l,this.listenForHeaderEvents(),this.listenForAuthChanges()}disconnectedCallback(){this.authManagerSubs.forEach((e=>e.unsubscribe())),this.listeners.forEach((e=>e()))}refreshInfo(e,t){if(window.authManager&&this.demoAppMainEl&&this.demoAppDebugEl)switch(e){case"renewing":this.demoAppMainEl.isRenewing=t;break;case"authenticated":this.demoAppMainEl.isAuthenticated=t,this.demoAppDebugEl.isAuthenticated=t;break;case"userSession":this.demoAppDebugEl.userSession=t;break;case"accessToken":this.demoAppDebugEl.accessToken=t,this.demoAppDebugEl.accessTokenDecoded=c.decodeJwt(t);break;case"idToken":this.demoAppDebugEl.idToken=t,this.demoAppDebugEl.idTokenDecoded=c.decodeJwt(t);break;case"userProfile":this.demoAppDebugEl.userProfile=t}}listenForAuthChanges(){const e=window.authManager;e&&this.authManagerSubs.push(e.onRenewingChanged((e=>this.refreshInfo("renewing",e))),e.onAuthenticatedChanged((e=>this.refreshInfo("authenticated",e))),e.onUserSessionChanged((e=>this.refreshInfo("userSession",e))),e.onAccessTokenChanged((e=>this.refreshInfo("accessToken",e))),e.onIdTokenChanged((e=>this.refreshInfo("idToken",e))),e.onUserProfileChanged((e=>this.refreshInfo("userProfile",e))))}listenForHeaderEvents(){const e=window.authManager;if(e&&this.demoAppMainEl){const t=()=>{e.login()};this.demoAppMainEl.addEventListener("login",t);const n=()=>{e.logout("/").then((()=>location.href="/"))};this.demoAppMainEl.addEventListener("logout",n);const r=()=>{e.renew()};this.demoAppMainEl.addEventListener("silentRenew",r),this.listeners.push((()=>{var e;return null==(e=this.demoAppMainEl)?void 0:e.removeEventListener("login",t)}),(()=>{var e;return null==(e=this.demoAppMainEl)?void 0:e.removeEventListener("logout",n)}),(()=>{var e;return null==(e=this.demoAppMainEl)?void 0:e.removeEventListener("silentRenew",r)}))}}}customElements.define("app-root",h);n(5754);n(110),n(5098),n(222),n(6858);const d=function(){this.__data__=[],this.size=0};const p=function(e,t){return e===t||e!=e&&t!=t};const g=function(e,t){for(var n=e.length;n--;)if(p(e[n][0],t))return n;return-1};var f=Array.prototype.splice;const v=function(e){var t=this.__data__,n=g(t,e);return!(n<0)&&(n==t.length-1?t.pop():f.call(t,n,1),--this.size,!0)};const _=function(e){var t=this.__data__,n=g(t,e);return n<0?void 0:t[n][1]};const m=function(e){return g(this.__data__,e)>-1};const w=function(e,t){var n=this.__data__,r=g(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function y(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}y.prototype.clear=d,y.prototype.delete=v,y.prototype.get=_,y.prototype.has=m,y.prototype.set=w;const b=y;const S=function(){this.__data__=new b,this.size=0};const x=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};const k=function(e){return this.__data__.get(e)};const E=function(e){return this.__data__.has(e)};const T="object"==typeof global&&global&&global.Object===Object&&global;var R="object"==typeof self&&self&&self.Object===Object&&self;const I=T||R||Function("return this")();const A=I.Symbol;var P=Object.prototype,O=P.hasOwnProperty,U=P.toString,C=A?A.toStringTag:void 0;const j=function(e){var t=O.call(e,C),n=e[C];try{e[C]=void 0;var i=!0}catch(r){}var s=U.call(e);return i&&(t?e[C]=n:delete e[C]),s};var L=Object.prototype.toString;const M=function(e){return L.call(e)};var N=A?A.toStringTag:void 0;const q=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":N&&N in Object(e)?j(e):M(e)};const $=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};const H=function(e){if(!$(e))return!1;var t=q(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};const B=I["__core-js_shared__"];var D,F=(D=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||""))?"Symbol(src)_1."+D:"";const W=function(e){return!!F&&F in e};var z=Function.prototype.toString;const J=function(e){if(null!=e){try{return z.call(e)}catch(r){}try{return e+""}catch(r){}}return""};var K=/^\[object .+?Constructor\]$/,V=Function.prototype,G=Object.prototype,Q=V.toString,Y=G.hasOwnProperty,X=RegExp("^"+Q.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Z=function(e){return!(!$(e)||W(e))&&(H(e)?X:K).test(J(e))};const ee=function(e,t){return null==e?void 0:e[t]};const te=function(e,t){var n=ee(e,t);return Z(n)?n:void 0};const ne=te(I,"Map");const re=te(Object,"create");const ie=function(){this.__data__=re?re(null):{},this.size=0};const se=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var oe=Object.prototype.hasOwnProperty;const ae=function(e){var t=this.__data__;if(re){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return oe.call(t,e)?t[e]:void 0};var ce=Object.prototype.hasOwnProperty;const le=function(e){var t=this.__data__;return re?void 0!==t[e]:ce.call(t,e)};const ue=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=re&&void 0===t?"__lodash_hash_undefined__":t,this};function he(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}he.prototype.clear=ie,he.prototype.delete=se,he.prototype.get=ae,he.prototype.has=le,he.prototype.set=ue;const de=he;const pe=function(){this.size=0,this.__data__={hash:new de,map:new(ne||b),string:new de}};const ge=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};const fe=function(e,t){var n=e.__data__;return ge(t)?n["string"==typeof t?"string":"hash"]:n.map};const ve=function(e){var t=fe(this,e).delete(e);return this.size-=t?1:0,t};const _e=function(e){return fe(this,e).get(e)};const me=function(e){return fe(this,e).has(e)};const we=function(e,t){var n=fe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function ye(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ye.prototype.clear=pe,ye.prototype.delete=ve,ye.prototype.get=_e,ye.prototype.has=me,ye.prototype.set=we;const be=ye;const Se=function(e,t){var n=this.__data__;if(n instanceof b){var r=n.__data__;if(!ne||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new be(r)}return n.set(e,t),this.size=n.size,this};function xe(e){var t=this.__data__=new b(e);this.size=t.size}xe.prototype.clear=S,xe.prototype.delete=x,xe.prototype.get=k,xe.prototype.has=E,xe.prototype.set=Se;const ke=xe;const Ee=function(){try{var e=te(Object,"defineProperty");return e({},"",{}),e}catch(r){}}();const Te=function(e,t,n){"__proto__"==t&&Ee?Ee(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};const Re=function(e,t,n){(void 0!==n&&!p(e[t],n)||void 0===n&&!(t in e))&&Te(e,t,n)};const Ie=function(e){return function(t,n,r){for(var i=-1,s=Object(t),o=r(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===n(s[c],c,s))break}return t}}();var Ae="object"==typeof exports&&exports&&!exports.nodeType&&exports,Pe=Ae&&"object"==typeof module&&module&&!module.nodeType&&module,Oe=Pe&&Pe.exports===Ae?I.Buffer:void 0,Ue=Oe?Oe.allocUnsafe:void 0;const Ce=function(e,t){if(t)return e.slice();var n=e.length,r=Ue?Ue(n):new e.constructor(n);return e.copy(r),r};const je=I.Uint8Array;const Le=function(e){var t=new e.constructor(e.byteLength);return new je(t).set(new je(e)),t};const Me=function(e,t){var n=t?Le(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};const Ne=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};var qe=Object.create;const $e=function(){function e(){}return function(t){if(!$(t))return{};if(qe)return qe(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const He=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object);var Be=Object.prototype;const De=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Be)};const Fe=function(e){return"function"!=typeof e.constructor||De(e)?{}:$e(He(e))};const We=function(e){return null!=e&&"object"==typeof e};const ze=function(e){return We(e)&&"[object Arguments]"==q(e)};var Je=Object.prototype,Ke=Je.hasOwnProperty,Ve=Je.propertyIsEnumerable;const Ge=ze(function(){return arguments}())?ze:function(e){return We(e)&&Ke.call(e,"callee")&&!Ve.call(e,"callee")};const Qe=Array.isArray;const Ye=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};const Xe=function(e){return null!=e&&Ye(e.length)&&!H(e)};const Ze=function(e){return We(e)&&Xe(e)};const et=function(){return!1};var tt="object"==typeof exports&&exports&&!exports.nodeType&&exports,nt=tt&&"object"==typeof module&&module&&!module.nodeType&&module,rt=nt&&nt.exports===tt?I.Buffer:void 0;const it=(rt?rt.isBuffer:void 0)||et;var st=Function.prototype,ot=Object.prototype,at=st.toString,ct=ot.hasOwnProperty,lt=at.call(Object);const ut=function(e){if(!We(e)||"[object Object]"!=q(e))return!1;var t=He(e);if(null===t)return!0;var n=ct.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&at.call(n)==lt};var ht={};ht["[object Float32Array]"]=ht["[object Float64Array]"]=ht["[object Int8Array]"]=ht["[object Int16Array]"]=ht["[object Int32Array]"]=ht["[object Uint8Array]"]=ht["[object Uint8ClampedArray]"]=ht["[object Uint16Array]"]=ht["[object Uint32Array]"]=!0,ht["[object Arguments]"]=ht["[object Array]"]=ht["[object ArrayBuffer]"]=ht["[object Boolean]"]=ht["[object DataView]"]=ht["[object Date]"]=ht["[object Error]"]=ht["[object Function]"]=ht["[object Map]"]=ht["[object Number]"]=ht["[object Object]"]=ht["[object RegExp]"]=ht["[object Set]"]=ht["[object String]"]=ht["[object WeakMap]"]=!1;const dt=function(e){return We(e)&&Ye(e.length)&&!!ht[q(e)]};const pt=function(e){return function(t){return e(t)}};var gt="object"==typeof exports&&exports&&!exports.nodeType&&exports,ft=gt&&"object"==typeof module&&module&&!module.nodeType&&module,vt=ft&&ft.exports===gt&&T.process,_t=function(){try{var e=ft&&ft.require&&ft.require("util").types;return e||vt&&vt.binding&&vt.binding("util")}catch(r){}}();var mt=_t&&_t.isTypedArray;const wt=mt?pt(mt):dt;const yt=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var bt=Object.prototype.hasOwnProperty;const St=function(e,t,n){var r=e[t];bt.call(e,t)&&p(r,n)&&(void 0!==n||t in e)||Te(e,t,n)};const xt=function(e,t,n,r){var i=!n;n||(n={});for(var s=-1,o=t.length;++s<o;){var a=t[s],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),i?Te(n,a,c):St(n,a,c)}return n};const kt=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var Et=/^(?:0|[1-9]\d*)$/;const Tt=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Et.test(e))&&e>-1&&e%1==0&&e<t};var Rt=Object.prototype.hasOwnProperty;const It=function(e,t){var n=Qe(e),r=!n&&Ge(e),i=!n&&!r&&it(e),s=!n&&!r&&!i&&wt(e),o=n||r||i||s,a=o?kt(e.length,String):[],c=a.length;for(var l in e)!t&&!Rt.call(e,l)||o&&("length"==l||i&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Tt(l,c))||a.push(l);return a};const At=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t};var Pt=Object.prototype.hasOwnProperty;const Ot=function(e){if(!$(e))return At(e);var t=De(e),n=[];for(var r in e)("constructor"!=r||!t&&Pt.call(e,r))&&n.push(r);return n};const Ut=function(e){return Xe(e)?It(e,!0):Ot(e)};const Ct=function(e){return xt(e,Ut(e))};const jt=function(e,t,n,r,i,s,o){var a=yt(e,n),c=yt(t,n),l=o.get(c);if(l)Re(e,n,l);else{var u=s?s(a,c,n+"",e,t,o):void 0,h=void 0===u;if(h){var d=Qe(c),p=!d&&it(c),g=!d&&!p&&wt(c);u=c,d||p||g?Qe(a)?u=a:Ze(a)?u=Ne(a):p?(h=!1,u=Ce(c,!0)):g?(h=!1,u=Me(c,!0)):u=[]:ut(c)||Ge(c)?(u=a,Ge(a)?u=Ct(a):$(a)&&!H(a)||(u=Fe(c))):h=!1}h&&(o.set(c,u),i(u,c,r,s,o),o.delete(c)),Re(e,n,u)}};const Lt=function e(t,n,r,i,s){t!==n&&Ie(n,(function(o,a){if(s||(s=new ke),$(o))jt(t,n,a,r,e,i,s);else{var c=i?i(yt(t,a),o,a+"",t,n,s):void 0;void 0===c&&(c=o),Re(t,a,c)}}),Ut)};const Mt=function(e){return e};const Nt=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var qt=Math.max;const $t=function(e,t,n){return t=qt(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,s=qt(r.length-t,0),o=Array(s);++i<s;)o[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(o),Nt(e,this,a)}};const Ht=function(e){return function(){return e}};const Bt=Ee?function(e,t){return Ee(e,"toString",{configurable:!0,enumerable:!1,value:Ht(t),writable:!0})}:Mt;var Dt=Date.now;const Ft=function(e){var t=0,n=0;return function(){var r=Dt(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Bt);const Wt=function(e,t){return Ft($t(e,t,Mt),e+"")};const zt=function(e,t,n){if(!$(n))return!1;var r=typeof t;return!!("number"==r?Xe(n)&&Tt(t,n.length):"string"==r&&t in n)&&p(n[t],e)};const Jt=function(e){return Wt((function(t,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,o&&zt(n[0],n[1],o)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,s)}return t}))}((function(e,t,n){Lt(e,t,n)}));var Kt,Vt,Gt,Qt=n(1175),Yt=n(9393),Xt=n(4924),Zt=n(9602),en={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},tn=(e=>(e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e))(tn||{});(Gt=tn||(tn={})).reset=function(){Kt=3,Vt=en},Gt.setLevel=function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");Kt=e},Gt.setLogger=function(e){Vt=e};var nn=class{constructor(e){this._name=e}debug(...e){Kt>=4&&Vt.debug(nn._format(this._name,this._method),...e)}info(...e){Kt>=3&&Vt.info(nn._format(this._name,this._method),...e)}warn(...e){Kt>=2&&Vt.warn(nn._format(this._name,this._method),...e)}error(...e){Kt>=1&&Vt.error(nn._format(this._name,this._method),...e)}throw(e){throw this.error(e),e}create(e){const t=Object.create(this);return t._method=e,t.debug("begin"),t}static createStatic(e,t){const n=new nn(`${e}.${t}`);return n.debug("begin"),n}static _format(e,t){const n=`[${e}]`;return t?`${n} ${t}:`:n}static debug(e,...t){Kt>=4&&Vt.debug(nn._format(e),...t)}static info(e,...t){Kt>=3&&Vt.info(nn._format(e),...t)}static warn(e,...t){Kt>=2&&Vt.warn(nn._format(e),...t)}static error(e,...t){Kt>=1&&Vt.error(nn._format(e),...t)}};tn.reset();var rn,sn,on,an,cn=class{static _randomWord(){return Qt.lib.WordArray.random(1).words[0]}static generateUUIDv4(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>(+e^cn._randomWord()&15>>+e/4).toString(16))).replace(/-/g,"")}static generateCodeVerifier(){return cn.generateUUIDv4()+cn.generateUUIDv4()+cn.generateUUIDv4()}static generateCodeChallenge(e){try{const t=Yt(e);return Xt.stringify(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(t){throw nn.error("CryptoUtils.generateCodeChallenge",t),t}}static generateBasicAuth(e,t){const n=Zt.parse([e,t].join(":"));return Xt.stringify(n)}},ln=class{constructor(e){this._name=e,this._logger=new nn(`Event('${this._name}')`),this._callbacks=[]}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const t=this._callbacks.lastIndexOf(e);t>=0&&this._callbacks.splice(t,1)}raise(...e){this._logger.debug("raise:",...e);for(const t of this._callbacks)t(...e)}},un=class{static decode(e){try{return a(e)}catch(t){throw nn.error("JwtUtils.decode",t),t}}},hn=class{static center({...e}){var t;return null==e.width&&(e.width=null!=(t=[800,720,600,480].find((e=>e<=window.outerWidth/1.618)))?t:360),null!=e.left||(e.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-e.width)/2))),null!=e.height&&(null!=e.top||(e.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-e.height)/2)))),e}static serialize(e){return Object.entries(e).filter((([,e])=>null!=e)).map((([e,t])=>`${e}=${"boolean"!=typeof t?t:t?"yes":"no"}`)).join(",")}},dn=class extends ln{constructor(){super(...arguments),this._logger=new nn(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-dn.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=dn.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const t=this._logger.create("init");e=Math.max(Math.floor(e),1);const n=dn.getEpochTime()+e;if(this.expiration===n&&this._timerHandle)return void t.debug("skipping since already initialized for expiration at",this.expiration);this.cancel(),t.debug("using duration",e),this._expiration=n;const r=Math.min(e,5);this._timerHandle=setInterval(this._callback,1e3*r)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},pn=class{static readParams(e,t="query"){if(!e)throw new TypeError("Invalid URL");const n=new URL(e,window.location.origin)["fragment"===t?"hash":"search"];return new URLSearchParams(n.slice(1))}},gn=class extends Error{constructor(e,t){var n,r,i;if(super(e.error_description||e.error||""),this.form=t,this.name="ErrorResponse",!e.error)throw nn.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=e.error,this.error_description=null!=(n=e.error_description)?n:null,this.error_uri=null!=(r=e.error_uri)?r:null,this.state=e.userState,this.session_state=null!=(i=e.session_state)?i:null}},fn=class extends Error{constructor(e){super(e),this.name="ErrorTimeout"}},vn=class{constructor(){this._logger=new nn("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(e){return this._logger.create(`getItem('${e}')`),this._data[e]}setItem(e,t){this._logger.create(`setItem('${e}')`),this._data[e]=t}removeItem(e){this._logger.create(`removeItem('${e}')`),delete this._data[e]}get length(){return Object.getOwnPropertyNames(this._data).length}key(e){return Object.getOwnPropertyNames(this._data)[e]}},_n=class{constructor(e=[],t=null){this._jwtHandler=t,this._logger=new nn("JsonService"),this._contentTypes=[],this._contentTypes.push(...e,"application/json"),t&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(e,t={}){const{timeoutInSeconds:n,...r}=t;if(!n)return await fetch(e,r);const i=new AbortController,s=setTimeout((()=>i.abort()),1e3*n);try{return await fetch(e,{...t,signal:i.signal})}catch(o){if(o instanceof DOMException&&"AbortError"===o.name)throw new fn("Network timed out");throw o}finally{clearTimeout(s)}}async getJson(e,{token:t}={}){const n=this._logger.create("getJson"),r={Accept:this._contentTypes.join(", ")};let i;t&&(n.debug("token passed, setting Authorization header"),r.Authorization="Bearer "+t);try{n.debug("url:",e),i=await this.fetchWithTimeout(e,{method:"GET",headers:r})}catch(a){throw n.error("Network Error"),a}n.debug("HTTP response received, status",i.status);const s=i.headers.get("Content-Type");if(s&&!this._contentTypes.find((e=>s.startsWith(e)))&&n.throw(new Error(`Invalid response Content-Type: ${null!=s?s:"undefined"}, from URL: ${e}`)),i.ok&&this._jwtHandler&&(null==s?void 0:s.startsWith("application/jwt")))return await this._jwtHandler(await i.text());let o;try{o=await i.json()}catch(a){if(n.error("Error parsing JSON response",a),i.ok)throw a;throw new Error(`${i.statusText} (${i.status})`)}if(!i.ok){if(n.error("Error from server:",o),o.error)throw new gn(o);throw new Error(`${i.statusText} (${i.status}): ${JSON.stringify(o)}`)}return o}async postForm(e,{body:t,basicAuth:n,timeoutInSeconds:r}){const i=this._logger.create("postForm"),s={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};let o;void 0!==n&&(s.Authorization="Basic "+n);try{i.debug("url:",e),o=await this.fetchWithTimeout(e,{method:"POST",headers:s,body:t,timeoutInSeconds:r})}catch(u){throw i.error("Network error"),u}i.debug("HTTP response received, status",o.status);const a=o.headers.get("Content-Type");if(a&&!this._contentTypes.find((e=>a.startsWith(e))))throw new Error(`Invalid response Content-Type: ${null!=a?a:"undefined"}, from URL: ${e}`);const c=await o.text();let l={};if(c)try{l=JSON.parse(c)}catch(u){if(i.error("Error parsing JSON response",u),o.ok)throw u;throw new Error(`${o.statusText} (${o.status})`)}if(!o.ok){if(i.error("Error from server:",l),l.error)throw new gn(l,t);throw new Error(`${o.statusText} (${o.status}): ${JSON.stringify(l)}`)}return l}},mn=class{constructor({prefix:e="oidc.",store:t=localStorage}={}){this._logger=new nn("WebStorageStateStore"),this._store=t,this._prefix=e}set(e,t){return this._logger.create(`set('${e}')`),e=this._prefix+e,this._store.setItem(e,t),Promise.resolve()}get(e){this._logger.create(`get('${e}')`),e=this._prefix+e;const t=this._store.getItem(e);return Promise.resolve(t)}remove(e){this._logger.create(`remove('${e}')`),e=this._prefix+e;const t=this._store.getItem(e);return this._store.removeItem(e),Promise.resolve(t)}getAllKeys(){this._logger.create("getAllKeys");const e=[];for(let t=0;t<this._store.length;t++){const n=this._store.key(t);n&&0===n.indexOf(this._prefix)&&e.push(n.substr(this._prefix.length))}return Promise.resolve(e)}},wn=class{constructor({authority:e,metadataUrl:t,metadata:n,signingKeys:r,metadataSeed:i,client_id:s,client_secret:o,response_type:a="code",scope:c="openid",redirect_uri:l,post_logout_redirect_uri:u,client_authentication:h="client_secret_post",prompt:d,display:p,max_age:g,ui_locales:f,acr_values:v,resource:_,response_mode:m="query",filterProtocolClaims:w=!0,loadUserInfo:y=!1,staleStateAgeInSeconds:b=900,clockSkewInSeconds:S=300,userInfoJwtIssuer:x="OP",mergeClaims:k=!1,stateStore:E,extraQueryParams:T={},extraTokenParams:R={}}){if(this.authority=e,t?this.metadataUrl=t:(this.metadataUrl=e,e&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=n,this.metadataSeed=i,this.signingKeys=r,this.client_id=s,this.client_secret=o,this.response_type=a,this.scope=c,this.redirect_uri=l,this.post_logout_redirect_uri=u,this.client_authentication=h,this.prompt=d,this.display=p,this.max_age=g,this.ui_locales=f,this.acr_values=v,this.resource=_,this.response_mode=m,this.filterProtocolClaims=!!w,this.loadUserInfo=!!y,this.staleStateAgeInSeconds=b,this.clockSkewInSeconds=S,this.userInfoJwtIssuer=x,this.mergeClaims=!!k,E)this.stateStore=E;else{const e="undefined"!=typeof window?window.localStorage:new vn;this.stateStore=new mn({store:e})}this.extraQueryParams=T,this.extraTokenParams=R}},yn=class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new nn("TokenClient"),this._jsonService=new _n}async exchangeCode({grant_type:e="authorization_code",redirect_uri:t=this._settings.redirect_uri,client_id:n=this._settings.client_id,client_secret:r=this._settings.client_secret,...i}){const s=this._logger.create("exchangeCode");n||s.throw(new Error("A client_id is required")),t||s.throw(new Error("A redirect_uri is required")),i.code||s.throw(new Error("A code is required")),i.code_verifier||s.throw(new Error("A code_verifier is required"));const o=new URLSearchParams({grant_type:e,redirect_uri:t});for(const[u,h]of Object.entries(i))null!=h&&o.set(u,h);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw s.throw(new Error("A client_secret is required")),null;a=cn.generateBasicAuth(n,r);break;case"client_secret_post":o.append("client_id",n),r&&o.append("client_secret",r)}const c=await this._metadataService.getTokenEndpoint(!1);s.debug("got token endpoint");const l=await this._jsonService.postForm(c,{body:o,basicAuth:a});return s.debug("got response"),l}async exchangeRefreshToken({grant_type:e="refresh_token",client_id:t=this._settings.client_id,client_secret:n=this._settings.client_secret,timeoutInSeconds:r,...i}){const s=this._logger.create("exchangeRefreshToken");t||s.throw(new Error("A client_id is required")),i.refresh_token||s.throw(new Error("A refresh_token is required"));const o=new URLSearchParams({grant_type:e});for(const[u,h]of Object.entries(i))null!=h&&o.set(u,h);let a;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw s.throw(new Error("A client_secret is required")),null;a=cn.generateBasicAuth(t,n);break;case"client_secret_post":o.append("client_id",t),n&&o.append("client_secret",n)}const c=await this._metadataService.getTokenEndpoint(!1);s.debug("got token endpoint");const l=await this._jsonService.postForm(c,{body:o,basicAuth:a,timeoutInSeconds:r});return s.debug("got response"),l}async revoke(e){var t;const n=this._logger.create("revoke");e.token||n.throw(new Error("A token is required"));const r=await this._metadataService.getRevocationEndpoint(!1);n.debug(`got revocation endpoint, revoking ${null!=(t=e.token_type_hint)?t:"default token type"}`);const i=new URLSearchParams;for(const[s,o]of Object.entries(e))null!=o&&i.set(s,o);i.set("client_id",this._settings.client_id),this._settings.client_secret&&i.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(r,{body:i}),n.debug("got response")}},bn=["iss","aud","exp","nbf","iat","jti","auth_time","nonce","acr","amr","azp","at_hash"],Sn=class{constructor(e){this.id=e.id||cn.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=dn.getEpochTime(),this.request_type=e.request_type}toStorageString(){return new nn("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})}static fromStorageString(e){return nn.createStatic("State","fromStorageString"),new Sn(JSON.parse(e))}static async clearStaleState(e,t){const n=nn.createStatic("State","clearStaleState"),r=dn.getEpochTime()-t,i=await e.getAllKeys();n.debug("got keys",i);for(let o=0;o<i.length;o++){const t=i[o],a=await e.get(t);let c=!1;if(a)try{const e=Sn.fromStorageString(a);n.debug("got item from key:",t,e.created),e.created<=r&&(c=!0)}catch(s){n.error("Error parsing state for key:",t,s),c=!0}else n.debug("no item in storage for key:",t),c=!0;c&&(n.debug("removed item for key:",t),e.remove(t))}}},xn=class extends Sn{constructor(e){super(e),!0===e.code_verifier?this.code_verifier=cn.generateCodeVerifier():e.code_verifier&&(this.code_verifier=e.code_verifier),this.code_verifier&&(this.code_challenge=cn.generateCodeChallenge(this.code_verifier)),this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}toStorageString(){return new nn("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){nn.createStatic("SigninState","fromStorageString");const t=JSON.parse(e);return new xn(t)}},kn=class{constructor(e){this.access_token="",this.token_type="",this.profile={},this.state=e.get("state"),this.session_state=e.get("session_state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri"),this.code=e.get("code")}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-dn.getEpochTime()}set expires_in(e){"string"==typeof e&&(e=Number(e)),void 0!==e&&e>=0&&(this.expires_at=Math.floor(e)+dn.getEpochTime())}get isOpenId(){var e;return(null==(e=this.scope)?void 0:e.split(" ").includes("openid"))||!!this.id_token}},En=class{constructor(e){var t;this.id_token=e.id_token,this.session_state=null!=(t=e.session_state)?t:null,this.access_token=e.access_token,this.refresh_token=e.refresh_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=e.profile,this.expires_at=e.expires_at,this.state=e.userState}get expires_in(){if(void 0!==this.expires_at)return this.expires_at-dn.getEpochTime()}set expires_in(e){void 0!==e&&(this.expires_at=Math.floor(e)+dn.getEpochTime())}get expired(){const e=this.expires_in;if(void 0!==e)return e<=0}get scopes(){var e,t;return null!=(t=null==(e=this.scope)?void 0:e.split(" "))?t:[]}toStorageString(){return new nn("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(e){return nn.createStatic("User","fromStorageString"),new En(JSON.parse(e))}},Tn="oidc-client",Rn=class{constructor(){this._abort=new ln("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(e){const t=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");t.debug("setting URL in window"),this._window.location.replace(e.url);const{url:n,keepOpen:r}=await new Promise(((n,r)=>{const i=i=>{var s;const o=i.data,a=null!=(s=e.scriptOrigin)?s:window.location.origin;if(i.origin===a&&(null==o?void 0:o.source)===Tn){try{const n=pn.readParams(o.url,e.response_mode).get("state");if(n||t.warn("no state found in response url"),i.source!==this._window&&n!==e.state)return}catch(c){this._dispose(),r(new Error("Invalid response from window"))}n(o)}};window.addEventListener("message",i,!1),this._disposeHandlers.add((()=>window.removeEventListener("message",i,!1))),this._disposeHandlers.add(this._abort.addHandler((e=>{this._dispose(),r(e)})))}));return t.debug("got response from window"),this._dispose(),r||this.close(),{url:n}}_dispose(){this._logger.create("_dispose");for(const e of this._disposeHandlers)e();this._disposeHandlers.clear()}static _notifyParent(e,t,n=!1,r=window.location.origin){e.postMessage({source:Tn,url:t,keepOpen:n},r)}},In={location:!1,toolbar:!1,height:640},An="_blank",Pn=60,On=2,Un=10,Cn=class extends wn{constructor(e){const{popup_redirect_uri:t=e.redirect_uri,popup_post_logout_redirect_uri:n=e.post_logout_redirect_uri,popupWindowFeatures:r=In,popupWindowTarget:i=An,redirectMethod:s="assign",redirectTarget:o="self",iframeNotifyParentOrigin:a=e.iframeNotifyParentOrigin,iframeScriptOrigin:c=e.iframeScriptOrigin,silent_redirect_uri:l=e.redirect_uri,silentRequestTimeoutInSeconds:u=Un,automaticSilentRenew:h=!0,validateSubOnSilentRenew:d=!0,includeIdTokenInSilentRenew:p=!1,monitorSession:g=!1,monitorAnonymousSession:f=!1,checkSessionIntervalInSeconds:v=On,query_status_response_type:_="code",stopCheckSessionOnError:m=!0,revokeTokenTypes:w=["access_token","refresh_token"],revokeTokensOnSignout:y=!1,accessTokenExpiringNotificationTimeInSeconds:b=Pn,userStore:S}=e;if(super(e),this.popup_redirect_uri=t,this.popup_post_logout_redirect_uri=n,this.popupWindowFeatures=r,this.popupWindowTarget=i,this.redirectMethod=s,this.redirectTarget=o,this.iframeNotifyParentOrigin=a,this.iframeScriptOrigin=c,this.silent_redirect_uri=l,this.silentRequestTimeoutInSeconds=u,this.automaticSilentRenew=h,this.validateSubOnSilentRenew=d,this.includeIdTokenInSilentRenew=p,this.monitorSession=g,this.monitorAnonymousSession=f,this.checkSessionIntervalInSeconds=v,this.stopCheckSessionOnError=m,this.query_status_response_type=_,this.revokeTokenTypes=w,this.revokeTokensOnSignout=y,this.accessTokenExpiringNotificationTimeInSeconds=b,S)this.userStore=S;else{const e="undefined"!=typeof window?window.sessionStorage:new vn;this.userStore=new mn({store:e})}}},jn=class extends Rn{constructor({silentRequestTimeoutInSeconds:e=Un}){super(),this._logger=new nn("IFrameWindow"),this._timeoutInSeconds=e,this._frame=jn.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),window.document.body.appendChild(e),e}async navigate(e){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const t=setTimeout((()=>this._abort.raise(new fn("IFrame timed out without a response"))),1e3*this._timeoutInSeconds);return this._disposeHandlers.add((()=>clearTimeout(t))),await super.navigate(e)}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",(e=>{var t;const n=e.target;null==(t=n.parentNode)||t.removeChild(n),this._abort.raise(new Error("IFrame removed from DOM"))}),!0),null==(e=this._frame.contentWindow)||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,t){return super._notifyParent(window.parent,e,!1,t)}},Ln=class extends Rn{constructor({popupWindowTarget:e=An,popupWindowFeatures:t={}}){super(),this._logger=new nn("PopupWindow");const n=hn.center({...In,...t});this._window=window.open(void 0,e,hn.serialize(n))}async navigate(e){var t;null==(t=this._window)||t.focus();const n=setInterval((()=>{this._window&&!this._window.closed||this._abort.raise(new Error("Popup closed by user"))}),500);return this._disposeHandlers.add((()=>clearInterval(n))),await super.navigate(e)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,t){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,e,t)}};class Mn{constructor(){this.subscribers=[],this.lastNotifiedValue=void 0}add(e){return this.subscribers.push(e),this.lastNotifiedValue&&e(...this.lastNotifiedValue),{unsubscribe:()=>this.unsubscribe(e)}}notify(...e){this.lastNotifiedValue=e,this.subscribers.forEach((t=>{t(...e)}))}unsubscribe(e){if(e){const t=this.subscribers.indexOf(e);-1!==t&&this.subscribers.splice(t,1)}else this.subscribers=[]}}const Nn=window.localStorage,qn=null==(rn=window.Capacitor)||null==(sn=rn.Plugins)?void 0:sn.Storage,$n=null==(on=window.Capacitor)||null==(an=on.Plugins)?void 0:an.SecureStoragePlugin;class Hn{constructor(){if(this._logger=new nn("MobileStorage"),!$n){let e="[@badisi/auth-js] This application is currently using an unsafe storage.\n\n";e+="\u24d8 Please follow the recommended guide and use `capacitor-secure-storage-plugin` instead.",console.warn(e)}$n?this._logger.debug("Using `capacitor-secure-storage-plugin` implementation"):qn?this._logger.debug("Using `@capacitor/storage` implementation"):this._logger.debug("Using `localStorage` implementation")}async length(){return $n?(await $n.keys()).value.length:qn?(await qn.keys()).keys.length:Nn.length}async key(e){return $n?(await $n.keys()).value[e]:qn?(await qn.keys()).keys[e]:Nn.key(e)}async clear(){this._logger.create("clear"),$n?await $n.clear():qn?await qn.clear():Nn.clear()}async getItem(e){if(this._logger.create(`getItem('${e}')`),!$n)return qn?(await qn.get({key:e})).value:Nn.getItem(e);try{return(await $n.get({key:e})).value}catch(t){return null}}async setItem(e,t){this._logger.create(`setItem('${e}')`),$n?await $n.set({key:e,value:t}):qn?await qn.set({key:e,value:t}):Nn.setItem(e,t)}async removeItem(e){this._logger.create(`removeItem('${e}')`),$n?await $n.remove({key:e}):qn?await qn.remove({key:e}):Nn.removeItem(e)}}let Bn;!function(e){e.REDIRECT="REDIRECT",e.POPUP="POPUP"}(Bn||(Bn={}));class Dn{constructor(){this.expired=void 0,this.expires_in=void 0,this.expires_at=void 0}static deserialize(e){const t=new Dn,n=Object.keys(t);for(const r of n)t[r]=e[r];return t}}function Fn(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var Wn,zn,Jn,Kn;const Vn=null==(Wn=window.Capacitor)||null==(zn=Wn.Plugins)?void 0:zn.App,Gn=null==(Jn=window.Capacitor)||null==(Kn=Jn.Plugins)?void 0:Kn.Browser;class Qn{constructor(e){if(this.options=e,this._logger=new nn("MobileWindow"),this.capacitorAppUrlOpenHandle=void 0,this.capacitorBrowserFinishedHandle=void 0,this.originalHandleOpenURL=window.handleOpenURL,this.navigateLogger=void 0,this._resolve=void 0,this._reject=void 0,!c.isCapacitor()&&!c.isCordova()){let e="[@badisi/auth-js] Required core dependency not found.\n\n";e+="\u24d8 Please follow the recommended guide and install either `Capacitor` or `Cordova` dependency.",console.error(e)}if(!Gn){let e="[@badisi/auth-js] Required plugin not found.\n\n";e+="\u24d8 Please follow the recommended guide and install either `@badisi/capacitor-browsertab` or `@capacitor/browser` plugin.",console.error(e)}if(Gn){let e="[@badisi/auth-js] This application is currently using a non recommended browser plugin.\n\n";e+="\u24d8 Please follow the recommended guide and use `@badisi/capacitor-browsertab` instead.",console.warn(e)}}async navigate(e){return this.navigateLogger=this._logger.create("navigate"),this.navigateLogger.debug("url",e.url),new Promise(((t,n)=>{this._resolve=t,this._reject=n,this.installCustomUrlSchemeHandler().then((()=>{Gn&&this.useCapacitorBrowser(e)}))}))}async close(){const e=this._logger.create("close");await(null==Gn?void 0:Gn.close().catch((t=>e.error(t)))),e.debug("success")}async cleanup(){var e,t;const n=this._logger.create("cleanup");window.handleOpenURL=this.originalHandleOpenURL,await(null==(e=this.capacitorBrowserFinishedHandle)?void 0:e.remove()),await(null==(t=this.capacitorAppUrlOpenHandle)?void 0:t.remove()),n.debug("success")}async onError(e){var t,n;null==(t=this.navigateLogger)||t.error("error response:",e),await this.cleanup(),await this.close(),null==(n=this._reject)||n.call(this,new Error(e))}async onSuccess(e){var t,n;null==(t=this.navigateLogger)||t.debug("successful response:",e),await this.cleanup(),await this.close(),null==(n=this._resolve)||n.call(this,{url:e})}async useCapacitorBrowser(e){this.capacitorBrowserFinishedHandle=await(null==Gn?void 0:Gn.addListener("browserFinished",(()=>{this.onError("Capacitor browser closed by user")}))),await(null==Gn?void 0:Gn.open({url:e.url,presentationStyle:"popover"}))}async useBrowserTab(e){}async installCustomUrlSchemeHandler(){const e=this._logger.create("installCustomUrlSchemeHandler");await this.cleanup(),c.isCapacitor()?(e.debug("listening to Capacitor `appUrlOpen` event"),this.capacitorAppUrlOpenHandle=await(null==Vn||null==Vn.addListener?void 0:Vn.addListener("appUrlOpen",(({url:e})=>{this.onSuccess(e)})))):c.isCordova()&&(e.debug("waiting for Cordova `handleOpenURL` callback"),window.handleOpenURL=e=>{var t;null==(t=this.originalHandleOpenURL)||t.call(this,e),this.onSuccess(e)}),e.debug("success")}}class Yn{constructor(e){this._settings=e,this._logger=new nn("MobileNavigator")}prepare(e){return this._logger.create("prepare"),new Qn(e)}}const Xn=["name"],Zn=["name"];class er extends class{constructor(e){this._logger=new nn("UserManager"),this.settings=new Cn(e),this._client=new class{constructor(e){this._logger=new nn("OidcClient"),this.settings=new wn(e),this.metadataService=new class{constructor(e){this._settings=e,this._logger=new nn("MetadataService"),this._jsonService=new _n(["application/jwk-set+json"]),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const e=this._logger.create("getMetadata");if(this._metadata)return e.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw e.throw(new Error("No authority or metadataUrl configured on settings")),null;e.debug("getting metadata from",this._metadataUrl);const t=await this._jsonService.getJson(this._metadataUrl);return e.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,t),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(e=!0){return this._getMetadataProperty("token_endpoint",e)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(e=!0){return this._getMetadataProperty("revocation_endpoint",e)}getKeysEndpoint(e=!0){return this._getMetadataProperty("jwks_uri",e)}async _getMetadataProperty(e,t=!1){const n=this._logger.create(`_getMetadataProperty('${e}')`),r=await this.getMetadata();if(n.debug("resolved"),void 0===r[e]){if(!0===t)return void n.warn("Metadata does not contain optional property");n.throw(new Error("Metadata does not contain property "+e))}return r[e]}async getSigningKeys(){const e=this._logger.create("getSigningKeys");if(this._signingKeys)return e.debug("returning signingKeys from cache"),this._signingKeys;const t=await this.getKeysEndpoint(!1);e.debug("got jwks_uri",t);const n=await this._jsonService.getJson(t);if(e.debug("got key set",n),!Array.isArray(n.keys))throw e.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=n.keys,this._signingKeys}}(this.settings),this._validator=new class{constructor(e,t){this._settings=e,this._metadataService=t,this._logger=new nn("ResponseValidator"),this._userInfoService=new class{constructor(e){this._metadataService=e,this._logger=new nn("UserInfoService"),this._getClaimsFromJwt=async e=>{const t=this._logger.create("_getClaimsFromJwt");try{const n=un.decode(e);return t.debug("JWT decoding successful"),n}catch(n){throw t.error("Error parsing JWT response"),n}},this._jsonService=new _n(void 0,this._getClaimsFromJwt)}async getClaims(e){const t=this._logger.create("getClaims");e||this._logger.throw(new Error("No token passed"));const n=await this._metadataService.getUserInfoEndpoint();t.debug("got userinfo url",n);const r=await this._jsonService.getJson(n,{token:e});return t.debug("got claims",r),r}}(this._metadataService),this._tokenClient=new yn(this._settings,this._metadataService)}async validateSigninResponse(e,t){const n=this._logger.create("validateSigninResponse");this._processSigninState(e,t),n.debug("state processed"),await this._processCode(e,t),n.debug("code processed"),e.isOpenId&&this._validateIdTokenAttributes(e),n.debug("tokens validated"),await this._processClaims(e,null==t?void 0:t.skipUserInfo,e.isOpenId),n.debug("claims processed")}async validateRefreshResponse(e,t){const n=this._logger.create("validateRefreshResponse");e.userState=t.data,null!=e.session_state||(e.session_state=t.session_state),null!=e.scope||(e.scope=t.scope);const r=e.isOpenId&&!!e.id_token;r&&(this._validateIdTokenAttributes(e,t.id_token),n.debug("ID Token validated")),await this._processClaims(e,!1,r),n.debug("claims processed")}validateSignoutResponse(e,t){const n=this._logger.create("validateSignoutResponse");if(t.id!==e.state&&n.throw(new Error("State does not match")),n.debug("state validated"),e.userState=t.data,e.error)throw n.warn("Response was error",e.error),new gn(e)}_processSigninState(e,t){const n=this._logger.create("_processSigninState");if(t.id!==e.state&&n.throw(new Error("State does not match")),t.client_id||n.throw(new Error("No client_id on state")),t.authority||n.throw(new Error("No authority on state")),this._settings.authority!==t.authority&&n.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==t.client_id&&n.throw(new Error("client_id mismatch on settings vs. signin state")),n.debug("state validated"),e.userState=t.data,null!=e.scope||(e.scope=t.scope),e.error)throw n.warn("Response was error",e.error),new gn(e);t.code_verifier&&!e.code&&n.throw(new Error("Expected code in response")),!t.code_verifier&&e.code&&n.throw(new Error("Unexpected code in response"))}async _processClaims(e,t=!1,n=!0){const r=this._logger.create("_processClaims");if(e.profile=this._filterProtocolClaims(e.profile),t||!this._settings.loadUserInfo||!e.access_token)return void r.debug("not loading user info");r.debug("loading user info");const i=await this._userInfoService.getClaims(e.access_token);r.debug("user info claims received from user info endpoint"),n&&i.sub!==e.profile.sub&&r.throw(new Error("subject from UserInfo response does not match subject in ID Token")),e.profile=this._mergeClaims(e.profile,this._filterProtocolClaims(i)),r.debug("user info claims received, updated profile:",e.profile)}_mergeClaims(e,t){const n={...e};for(const[r,i]of Object.entries(t))for(const e of Array.isArray(i)?i:[i]){const t=n[r];t?Array.isArray(t)?t.includes(e)||t.push(e):n[r]!==e&&("object"==typeof e&&this._settings.mergeClaims?n[r]=this._mergeClaims(t,e):n[r]=[t,e]):n[r]=e}return n}_filterProtocolClaims(e){const t={...e};if(this._settings.filterProtocolClaims)for(const n of bn)delete t[n];return t}async _processCode(e,t){const n=this._logger.create("_processCode");if(e.code){n.debug("Validating code");const r=await this._tokenClient.exchangeCode({client_id:t.client_id,client_secret:t.client_secret,code:e.code,redirect_uri:t.redirect_uri,code_verifier:t.code_verifier,...t.extraTokenParams});Object.assign(e,r)}else n.debug("No code to process")}_validateIdTokenAttributes(e,t){var n;const r=this._logger.create("_validateIdTokenAttributes");r.debug("decoding ID Token JWT");const i=un.decode(null!=(n=e.id_token)?n:"");if(i.sub||r.throw(new Error("ID Token is missing a subject claim")),t){const e=un.decode(t);e.sub!==i.sub&&r.throw(new Error("sub in id_token does not match current sub")),e.auth_time&&e.auth_time!==i.auth_time&&r.throw(new Error("auth_time in id_token does not match original auth_time")),e.azp&&e.azp!==i.azp&&r.throw(new Error("azp in id_token does not match original azp")),!e.azp&&i.azp&&r.throw(new Error("azp not in id_token, but present in original id_token"))}e.profile=i}}(this.settings,this.metadataService),this._tokenClient=new yn(this.settings,this.metadataService)}async createSigninRequest({state:e,request:t,request_uri:n,request_type:r,id_token_hint:i,login_hint:s,skipUserInfo:o,nonce:a,response_type:c=this.settings.response_type,scope:l=this.settings.scope,redirect_uri:u=this.settings.redirect_uri,prompt:h=this.settings.prompt,display:d=this.settings.display,max_age:p=this.settings.max_age,ui_locales:g=this.settings.ui_locales,acr_values:f=this.settings.acr_values,resource:v=this.settings.resource,response_mode:_=this.settings.response_mode,extraQueryParams:m=this.settings.extraQueryParams,extraTokenParams:w=this.settings.extraTokenParams}){const y=this._logger.create("createSigninRequest");if("code"!==c)throw new Error("Only the Authorization Code flow (with PKCE) is supported");const b=await this.metadataService.getAuthorizationEndpoint();y.debug("Received authorization endpoint",b);const S=new class{constructor({url:e,authority:t,client_id:n,redirect_uri:r,response_type:i,scope:s,state_data:o,response_mode:a,request_type:c,client_secret:l,nonce:u,skipUserInfo:h,extraQueryParams:d,extraTokenParams:p,...g}){if(this._logger=new nn("SigninRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");if(!n)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!r)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!i)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!s)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!t)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new xn({data:o,request_type:c,code_verifier:!0,client_id:n,authority:t,redirect_uri:r,response_mode:a,client_secret:l,scope:s,extraTokenParams:p,skipUserInfo:h});const f=new URL(e);f.searchParams.append("client_id",n),f.searchParams.append("redirect_uri",r),f.searchParams.append("response_type",i),f.searchParams.append("scope",s),u&&f.searchParams.append("nonce",u),f.searchParams.append("state",this.state.id),this.state.code_challenge&&(f.searchParams.append("code_challenge",this.state.code_challenge),f.searchParams.append("code_challenge_method","S256"));for(const[v,_]of Object.entries({response_mode:a,...g,...d}))null!=_&&f.searchParams.append(v,_.toString());this.url=f.href}}({url:b,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:u,response_type:c,scope:l,state_data:e,prompt:h,display:d,max_age:p,ui_locales:g,id_token_hint:i,login_hint:s,acr_values:f,resource:v,request:t,request_uri:n,extraQueryParams:m,extraTokenParams:w,request_type:r,response_mode:_,client_secret:this.settings.client_secret,skipUserInfo:o,nonce:a});await this.clearStaleState();const x=S.state;return await this.settings.stateStore.set(x.id,x.toStorageString()),S}async readSigninResponseState(e,t=!1){const n=this._logger.create("readSigninResponseState"),r=new kn(pn.readParams(e,this.settings.response_mode));if(!r.state)throw n.throw(new Error("No state in response")),null;const i=await this.settings.stateStore[t?"remove":"get"](r.state);if(!i)throw n.throw(new Error("No matching state found in storage")),null;return{state:xn.fromStorageString(i),response:r}}async processSigninResponse(e){const t=this._logger.create("processSigninResponse"),{state:n,response:r}=await this.readSigninResponseState(e,!0);return t.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(r,n),r}async useRefreshToken({state:e,timeoutInSeconds:t}){const n=this._logger.create("useRefreshToken"),r=await this._tokenClient.exchangeRefreshToken({refresh_token:e.refresh_token,scope:e.scope,timeoutInSeconds:t}),i=new kn(new URLSearchParams);return Object.assign(i,r),n.debug("validating response",i),await this._validator.validateRefreshResponse(i,e),i}async createSignoutRequest({state:e,id_token_hint:t,request_type:n,post_logout_redirect_uri:r=this.settings.post_logout_redirect_uri,extraQueryParams:i=this.settings.extraQueryParams}={}){const s=this._logger.create("createSignoutRequest"),o=await this.metadataService.getEndSessionEndpoint();if(!o)throw s.throw(new Error("No end session endpoint")),null;s.debug("Received end session endpoint",o);const a=new class{constructor({url:e,state_data:t,id_token_hint:n,post_logout_redirect_uri:r,extraQueryParams:i,request_type:s}){if(this._logger=new nn("SignoutRequest"),!e)throw this._logger.error("ctor: No url passed"),new Error("url");const o=new URL(e);n&&o.searchParams.append("id_token_hint",n),r&&(o.searchParams.append("post_logout_redirect_uri",r),t&&(this.state=new Sn({data:t,request_type:s}),o.searchParams.append("state",this.state.id)));for(const[a,c]of Object.entries({...i}))null!=c&&o.searchParams.append(a,c.toString());this.url=o.href}}({url:o,id_token_hint:t,post_logout_redirect_uri:r,state_data:e,extraQueryParams:i,request_type:n});await this.clearStaleState();const c=a.state;return c&&(s.debug("Signout request has state to persist"),await this.settings.stateStore.set(c.id,c.toStorageString())),a}async readSignoutResponseState(e,t=!1){const n=this._logger.create("readSignoutResponseState"),r=new class{constructor(e){this.state=e.get("state"),this.error=e.get("error"),this.error_description=e.get("error_description"),this.error_uri=e.get("error_uri")}}(pn.readParams(e,this.settings.response_mode));if(!r.state){if(n.debug("No state in response"),r.error)throw n.warn("Response was error:",r.error),new gn(r);return{state:void 0,response:r}}const i=await this.settings.stateStore[t?"remove":"get"](r.state);if(!i)throw n.throw(new Error("No matching state found in storage")),null;return{state:Sn.fromStorageString(i),response:r}}async processSignoutResponse(e){const t=this._logger.create("processSignoutResponse"),{state:n,response:r}=await this.readSignoutResponseState(e,!0);return n?(t.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(r,n)):t.debug("No state from storage; skipping response validation"),r}clearStaleState(){return this._logger.create("clearStaleState"),Sn.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(e,t){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:e,token_type_hint:t})}}(e),this._redirectNavigator=new class{constructor(e){this._settings=e,this._logger=new nn("RedirectNavigator")}async prepare({redirectMethod:e=this._settings.redirectMethod,redirectTarget:t=this._settings.redirectTarget}){var n;this._logger.create("prepare");let r=window.self;"top"===t&&(r=null!=(n=window.top)?n:window.self);const i=r.location[e].bind(r.location);let s;return{navigate:async e=>{this._logger.create("navigate");const t=new Promise(((e,t)=>{s=t}));return i(e.url),await t},close:()=>{this._logger.create("close"),null==s||s(new Error("Redirect aborted")),r.stop()}}}}(this.settings),this._popupNavigator=new class{constructor(e){this._settings=e,this._logger=new nn("PopupNavigator")}async prepare({popupWindowFeatures:e=this._settings.popupWindowFeatures,popupWindowTarget:t=this._settings.popupWindowTarget}){return new Ln({popupWindowFeatures:e,popupWindowTarget:t})}async callback(e,t=!1){this._logger.create("callback"),Ln.notifyOpener(e,t)}}(this.settings),this._iframeNavigator=new class{constructor(e){this._settings=e,this._logger=new nn("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:e=this._settings.silentRequestTimeoutInSeconds}){return new jn({silentRequestTimeoutInSeconds:e})}async callback(e){this._logger.create("callback"),jn.notifyParent(e,this._settings.iframeNotifyParentOrigin)}}(this.settings),this._events=new class extends class{constructor(e){this._logger=new nn("AccessTokenEvents"),this._expiringTimer=new dn("Access token expiring"),this._expiredTimer=new dn("Access token expired"),this._expiringNotificationTimeInSeconds=e.expiringNotificationTimeInSeconds}load(e){const t=this._logger.create("load");if(e.access_token&&void 0!==e.expires_in){const n=e.expires_in;if(t.debug("access token present, remaining duration:",n),n>0){let e=n-this._expiringNotificationTimeInSeconds;e<=0&&(e=1),t.debug("registering expiring timer, raising in",e,"seconds"),this._expiringTimer.init(e)}else t.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const r=n+1;t.debug("registering expired timer, raising in",r,"seconds"),this._expiredTimer.init(r)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(e){return this._expiringTimer.addHandler(e)}removeAccessTokenExpiring(e){this._expiringTimer.removeHandler(e)}addAccessTokenExpired(e){return this._expiredTimer.addHandler(e)}removeAccessTokenExpired(e){this._expiredTimer.removeHandler(e)}}{constructor(e){super({expiringNotificationTimeInSeconds:e.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new nn("UserManagerEvents"),this._userLoaded=new ln("User loaded"),this._userUnloaded=new ln("User unloaded"),this._silentRenewError=new ln("Silent renew error"),this._userSignedIn=new ln("User signed in"),this._userSignedOut=new ln("User signed out"),this._userSessionChanged=new ln("User session changed")}load(e,t=!0){super.load(e),t&&this._userLoaded.raise(e)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(e){return this._userLoaded.addHandler(e)}removeUserLoaded(e){return this._userLoaded.removeHandler(e)}addUserUnloaded(e){return this._userUnloaded.addHandler(e)}removeUserUnloaded(e){return this._userUnloaded.removeHandler(e)}addSilentRenewError(e){return this._silentRenewError.addHandler(e)}removeSilentRenewError(e){return this._silentRenewError.removeHandler(e)}_raiseSilentRenewError(e){this._silentRenewError.raise(e)}addUserSignedIn(e){return this._userSignedIn.addHandler(e)}removeUserSignedIn(e){this._userSignedIn.removeHandler(e)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(e){return this._userSignedOut.addHandler(e)}removeUserSignedOut(e){this._userSignedOut.removeHandler(e)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(e){return this._userSessionChanged.addHandler(e)}removeUserSessionChanged(e){this._userSessionChanged.removeHandler(e)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}}(this.settings),this._silentRenewService=new class{constructor(e){this._userManager=e,this._logger=new nn("SilentRenewService"),this._isStarted=!1,this._retryTimer=new dn("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(t){if(t instanceof fn)return e.warn("ErrorTimeout from signinSilent:",t,"retry in 5s"),void this._retryTimer.init(5);e.error("Error from signinSilent:",t),this._userManager.events._raiseSilentRenewError(t)}}}async start(){const e=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(t){e.error("getUser error",t)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}}(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new class{constructor(e){this._userManager=e,this._logger=new nn("SessionMonitor"),this._start=async e=>{const t=e.session_state;if(!t)return;const n=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,n.debug("session_state",t,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,n.debug("session_state",t,", anonymous user")),this._checkSessionIFrame)this._checkSessionIFrame.start(t);else try{const e=await this._userManager.metadataService.getCheckSessionIframe();if(e){n.debug("initializing check session iframe");const r=this._userManager.settings.client_id,i=this._userManager.settings.checkSessionIntervalInSeconds,s=this._userManager.settings.stopCheckSessionOnError,o=new class{constructor(e,t,n,r,i){this._callback=e,this._client_id=t,this._intervalInSeconds=r,this._stopOnError=i,this._logger=new nn("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=e=>{e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(e.data+" message from check session op iframe"))};const s=new URL(n);this._frame_origin=s.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=s.href}load(){return new Promise((e=>{this._frame.onload=()=>{e()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)}))}start(e){if(this._session_state===e)return;this._logger.create("start"),this.stop(),this._session_state=e;const t=()=>{this._frame.contentWindow&&this._session_state&&this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};t(),this._timer=setInterval(t,1e3*this._intervalInSeconds)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}}(this._callback,r,e,i,s);await o.load(),this._checkSessionIFrame=o,o.start(t)}else n.warn("no check session iframe found in the metadata")}catch(r){n.error("Error from getCheckSessionIframe:",r instanceof Error?r.message:r)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const t=setInterval((async()=>{clearInterval(t);try{const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}catch(n){e.error("error from querySessionStatus",n instanceof Error?n.message:n)}}),1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const t=await this._userManager.querySessionStatus();let n=!0;t&&this._checkSessionIFrame?t.sub===this._sub?(n=!1,this._checkSessionIFrame.start(t.session_state),t.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",t.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",t.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",t.sub):e.debug("subject no longer signed into OP"),n?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(t){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",t),this._userManager.events._raiseUserSignedOut())}},e||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch((e=>{this._logger.error(e)}))}async _init(){this._logger.create("_init");const e=await this._userManager.getUser();if(e)this._start(e);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const t={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(t)}}}}(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const e=this._logger.create("getUser"),t=await this._loadUser();return t?(e.info("user loaded"),this._events.load(t,!1),t):(e.info("user not found in storage"),null)}async removeUser(){const e=this._logger.create("removeUser");await this.storeUser(null),e.info("user removed from storage"),this._events.unload()}async signinRedirect(e={}){this._logger.create("signinRedirect");const{redirectMethod:t,...n}=e,r=await this._redirectNavigator.prepare({redirectMethod:t});await this._signinStart({request_type:"si:r",...n},r)}async signinRedirectCallback(e=window.location.href){const t=this._logger.create("signinRedirectCallback"),n=await this._signinEnd(e);return n.profile&&n.profile.sub?t.info("success, signed in subject",n.profile.sub):t.info("no subject"),n}async signinPopup(e={}){const t=this._logger.create("signinPopup"),{popupWindowFeatures:n,popupWindowTarget:r,...i}=e,s=this.settings.popup_redirect_uri;s||t.throw(new Error("No popup_redirect_uri configured"));const o=await this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:r}),a=await this._signin({request_type:"si:p",redirect_uri:s,display:"popup",...i},o);return a&&(a.profile&&a.profile.sub?t.info("success, signed in subject",a.profile.sub):t.info("no subject")),a}async signinPopupCallback(e=window.location.href,t=!1){const n=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(e,t),n.info("success")}async signinSilent(e={}){var t;const n=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:r,...i}=e;let s=await this._loadUser();if(null==s?void 0:s.refresh_token){n.debug("using refresh token");const e=new class{constructor(e){this.refresh_token=e.refresh_token,this.id_token=e.id_token,this.session_state=e.session_state,this.scope=e.scope,this.data=e.state}}(s);return await this._useRefreshToken(e)}const o=this.settings.silent_redirect_uri;let a;o||n.throw(new Error("No silent_redirect_uri configured")),s&&this.settings.validateSubOnSilentRenew&&(n.debug("subject prior to silent renew:",s.profile.sub),a=s.profile.sub);const c=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r});return s=await this._signin({request_type:"si:s",redirect_uri:o,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?null==s?void 0:s.id_token:void 0,...i},c,a),s&&((null==(t=s.profile)?void 0:t.sub)?n.info("success, signed in subject",s.profile.sub):n.info("no subject")),s}async _useRefreshToken(e){const t=await this._client.useRefreshToken({state:e,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),n=new En({...e,...t});return await this.storeUser(n),this._events.load(n),n}async signinSilentCallback(e=window.location.href){const t=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(e),t.info("success")}async signinCallback(e=window.location.href){const{state:t}=await this._client.readSigninResponseState(e);switch(t.request_type){case"si:r":return await this.signinRedirectCallback(e);case"si:p":return await this.signinPopupCallback(e);case"si:s":return await this.signinSilentCallback(e);default:throw new Error("invalid response_type in state")}}async signoutCallback(e=window.location.href,t=!1){const{state:n}=await this._client.readSignoutResponseState(e);if(n)switch(n.request_type){case"so:r":await this.signoutRedirectCallback(e);break;case"so:p":await this.signoutPopupCallback(e,t);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(e={}){const t=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:n,...r}=e,i=this.settings.silent_redirect_uri;i||t.throw(new Error("No silent_redirect_uri configured"));const s=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n}),o=await this._signinStart({request_type:"si:s",redirect_uri:i,prompt:"none",response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...r},s);try{const e=await this._client.processSigninResponse(o.url);return t.debug("got signin response"),e.session_state&&e.profile.sub?(t.info("success for subject",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid}):(t.info("success, user not authenticated"),null)}catch(a){if(this.settings.monitorAnonymousSession&&a instanceof gn)switch(a.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return t.info("success for anonymous user"),{session_state:a.session_state}}throw a}}async _signin(e,t,n){const r=await this._signinStart(e,t);return await this._signinEnd(r.url,n)}async _signinStart(e,t){const n=this._logger.create("_signinStart");try{const r=await this._client.createSigninRequest(e);return n.debug("got signin request"),await t.navigate({url:r.url,state:r.state.id,response_mode:r.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(r){throw n.debug("error after preparing navigator, closing navigator window"),t.close(),r}}async _signinEnd(e,t){const n=this._logger.create("_signinEnd"),r=await this._client.processSigninResponse(e);n.debug("got signin response");const i=new En(r);if(t){if(t!==i.profile.sub)throw n.debug("current user does not match user returned from signin. sub from signin:",i.profile.sub),new gn({...r,error:"login_required"});n.debug("current user matches user returned from signin")}return await this.storeUser(i),n.debug("user stored"),this._events.load(i),i}async signoutRedirect(e={}){const t=this._logger.create("signoutRedirect"),{redirectMethod:n,...r}=e,i=await this._redirectNavigator.prepare({redirectMethod:n});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...r},i),t.info("success")}async signoutRedirectCallback(e=window.location.href){const t=this._logger.create("signoutRedirectCallback"),n=await this._signoutEnd(e);return t.info("success"),n}async signoutPopup(e={}){const t=this._logger.create("signoutPopup"),{popupWindowFeatures:n,popupWindowTarget:r,...i}=e,s=this.settings.popup_post_logout_redirect_uri,o=await this._popupNavigator.prepare({popupWindowFeatures:n,popupWindowTarget:r});await this._signout({request_type:"so:p",post_logout_redirect_uri:s,state:null==s?void 0:{},...i},o),t.info("success")}async signoutPopupCallback(e=window.location.href,t=!1){const n=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(e,t),n.info("success")}async _signout(e,t){const n=await this._signoutStart(e,t);return await this._signoutEnd(n.url)}async _signoutStart(e={},t){var n;const r=this._logger.create("_signoutStart");try{const i=await this._loadUser();r.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(i);const s=e.id_token_hint||i&&i.id_token;s&&(r.debug("setting id_token_hint in signout request"),e.id_token_hint=s),await this.removeUser(),r.debug("user removed, creating signout request");const o=await this._client.createSignoutRequest(e);return r.debug("got signout request"),await t.navigate({url:o.url,state:null==(n=o.state)?void 0:n.id})}catch(i){throw r.debug("error after preparing navigator, closing navigator window"),t.close(),i}}async _signoutEnd(e){const t=this._logger.create("_signoutEnd"),n=await this._client.processSignoutResponse(e);return t.debug("got signout response"),n}async revokeTokens(e){const t=await this._loadUser();await this._revokeInternal(t,e)}async _revokeInternal(e,t=this.settings.revokeTokenTypes){const n=this._logger.create("_revokeInternal");if(!e)return;const r=t.filter((t=>"string"==typeof e[t]));if(r.length){for(const t of r)await this._client.revokeToken(e[t],t),n.info(`${t} revoked successfully`),"access_token"!==t&&(e[t]=null);await this.storeUser(e),n.debug("user stored"),this._events.load(e)}else n.debug("no need to revoke due to no token(s)")}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const e=this._logger.create("_loadUser"),t=await this.settings.userStore.get(this._userStoreKey);return t?(e.debug("user storageString loaded"),En.fromStorageString(t)):(e.debug("no user storageString"),null)}async storeUser(e){const t=this._logger.create("storeUser");if(e){t.debug("storing user");const n=e.toStorageString();await this.settings.userStore.set(this._userStoreKey,n)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}}{constructor(e){super(e),this._mobileNavigator=void 0,this._mobileNavigator=new Yn(this.settings)}async signoutMobile(e={}){const t=this._logger.create("signout"),{name:n}=e,r=Fn(e,Xn),i=this._mobileNavigator.prepare({name:n});await this._signout(Object.assign({request_type:"so:m",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},r),i),t.info("success")}async signinMobile(e={}){var t;const n=this._logger.create("signin"),{name:r}=e,i=Fn(e,Zn),s=this._mobileNavigator.prepare({name:r}),o=await this._signin(Object.assign({request_type:"si:m",redirect_uri:this.settings.redirect_uri},i),s);null!=o&&null!=(t=o.profile)&&t.sub?n.info("success, signed in subject",o.profile.sub):n.info("no subject")}}const tr="auth-js:oidc_manager:redirect_url",nr={loginRequired:!1,loadUserSession:!0,loadUserInfo:!1,automaticSilentRenew:!0,navigationType:Bn.REDIRECT,scope:"openid profile email phone",logLevel:tn.NONE,internal:{response_type:"code",redirect_uri:"?oidc-callback=login",post_logout_redirect_uri:"?oidc-callback=logout",popup_redirect_uri:"oidc/callback/popup_redirect.html",popup_post_logout_redirect_uri:"oidc/callback/popup_redirect.html",silent_redirect_uri:"oidc/callback/silent_redirect.html"}};class rr extends class{}{constructor(...e){super(...e),this.idTokenSubs=new Mn,this.accessTokenSubs=new Mn,this.userProfileSubs=new Mn,this.userSessionSubs=new Mn,this.authenticatedSubs=new Mn,this.renewingSubs=new Mn,this.redirectSubs=new Mn,this.userManagerSubs=[],this._idToken=void 0,this._accessToken=void 0,this._userProfile=void 0,this._userSession=void 0,this._isAuthenticated=void 0,this._isRenewing=!1,this.userManager=void 0,this.settings=nr,this._user=void 0}set user(e){this._user!==e&&(this._user=e,this._idToken=e?e.id_token:void 0,this._accessToken=e?e.access_token:void 0,this._userProfile=null!=e&&e.profile?e.profile:void 0,this._userSession=e?Dn.deserialize(e):void 0,this._isAuthenticated=!(!e||e.expired),this.idTokenSubs.notify(this._idToken),this.accessTokenSubs.notify(this._accessToken),this.userProfileSubs.notify(this._userProfile),this.userSessionSubs.notify(this._userSession),this.authenticatedSubs.notify(this._isAuthenticated))}async init(e){var t,n,r,i,s,o,a,l=this;tn.setLevel(e.logLevel||nr.logLevel||tn.NONE),tn.setLogger(console);const u=c.isNativeMobile(),h=u?`${e.schemeUri}://`:c.getBaseUrl();if(this.settings=Jt({},nr,{internal:{userStore:new mn({store:u?new Hn:new vn}),redirect_uri:`${h}${null==(t=nr.internal)?void 0:t.redirect_uri}`,popup_redirect_uri:`${h}${null==(n=nr.internal)?void 0:n.popup_redirect_uri}`,post_logout_redirect_uri:`${h}${null==(r=nr.internal)?void 0:r.post_logout_redirect_uri}`,popup_post_logout_redirect_uri:`${h}${null==(i=nr.internal)?void 0:i.popup_post_logout_redirect_uri}`,silent_redirect_uri:`${h}${null==(s=nr.internal)?void 0:s.silent_redirect_uri}`}},e),this.patchAuth0Logout(),this.userManager=new er(Object.assign({authority:this.settings.authorityUrl,client_id:this.settings.clientId,scope:this.settings.scope,loadUserInfo:this.settings.loadUserInfo,automaticSilentRenew:this.settings.automaticSilentRenew},this.settings.internal)),this.userManagerSubs.push(this.userManager.events.addUserLoaded((e=>{this.user=e})),this.userManager.events.addUserUnloaded((()=>{this.user=null})),this.userManager.events.addAccessTokenExpired((()=>{this.settings.automaticSilentRenew&&this.signinSilent().catch((e=>this.redirect("/",e)))}))),this.assertNotInInceptionLoop(),c.isUrlMatching(location.href,null==(o=this.settings.internal)?void 0:o.redirect_uri))await this.runSyncOrAsync((()=>this.backFromLoginRedirect()));else if(c.isUrlMatching(location.href,null==(a=this.settings.internal)?void 0:a.post_logout_redirect_uri))await this.runSyncOrAsync((()=>this.backFromLogoutRedirect()));else if(this.settings.loadUserSession||this.settings.loginRequired){var d;const e=async function(){await l.runSyncOrAsync((()=>l.signinSilent().catch((async function(e){if(l.settings.loginRequired){const{error:t,message:n}=e;if(![t,n].includes("login_required"))throw e;await l.login()}else l.authenticatedSubs.notify(!1)}))))},t=await(null==(d=this.userManager)?void 0:d.getUser());t?t.expired?await e():this.user=t:u?this.settings.loginRequired?await this.login():this.authenticatedSubs.notify(!1):await e()}else this.authenticatedSubs.notify(!1)}async login(e=location.href,t){var n,r,i;if(c.isNativeMobile())await(null==(i=this.userManager)?void 0:i.signinMobile()),await this.redirect(e);else if((t||this.settings.navigationType)===Bn.POPUP)await(null==(n=this.userManager)?void 0:n.signinPopup().catch((e=>{var t;throw"Attempted to navigate on a disposed window"===(null==(t=e)?void 0:t.message)&&((e=new Error("[OIDCAuthManager] Attempted to navigate on a disposed window.")).stack=void 0,e.message+="\n\n\u24d8 This may be due to an ad blocker."),e}))),await this.redirect(e);else sessionStorage.setItem(tr,e),await(null==(r=this.userManager)?void 0:r.signinRedirect());return!0===this._isAuthenticated}async logout(e=location.href,t){var n,r,i;if(c.isNativeMobile())await(null==(i=this.userManager)?void 0:i.signoutMobile()),await this.redirect(e);else if((t||this.settings.navigationType)===Bn.POPUP)await(null==(n=this.userManager)?void 0:n.signoutPopup()),await this.redirect(e);else sessionStorage.setItem(tr,e),await(null==(r=this.userManager)?void 0:r.signoutRedirect())}async renew(){return this.signinSilent().catch((e=>console.error(e)))}getSettings(){return this.settings}isRenewing(){return this._isRenewing}async isAuthenticated(){return await this.waitForRenew("isAuthenticated()"),this._isAuthenticated}async getUserProfile(){return await this.waitForRenew("getUserProfile()"),this._userProfile}async getUserSession(){return await this.waitForRenew("getUserSession()"),this._userSession}async getIdToken(){return await this.waitForRenew("getIdToken()"),this._idToken}async getIdTokenDecoded(){return await this.waitForRenew("getIdTokenDecoded()"),c.decodeJwt(this._idToken)}async getAccessToken(){return await this.waitForRenew("getAccessToken()"),this._accessToken}async getAccessTokenDecoded(){return await this.waitForRenew("getAccessTokenDecoded()"),c.decodeJwt(this._accessToken)}destroy(){this.idTokenSubs.unsubscribe(),this.accessTokenSubs.unsubscribe(),this.userProfileSubs.unsubscribe(),this.userSessionSubs.unsubscribe(),this.authenticatedSubs.unsubscribe(),this.renewingSubs.unsubscribe(),this.redirectSubs.unsubscribe(),this.userManagerSubs.forEach((e=>e()))}onIdTokenChanged(e){return this.idTokenSubs.add(e)}onAccessTokenChanged(e){return this.accessTokenSubs.add(e)}onUserProfileChanged(e){return this.userProfileSubs.add(e)}onUserSessionChanged(e){return this.userSessionSubs.add(e)}onAuthenticatedChanged(e){return this.authenticatedSubs.add(e)}onRenewingChanged(e){return this.renewingSubs.add(e)}onRedirect(e){return this.redirectSubs.add(e)}assertNotInInceptionLoop(){var e,t;[null==(e=this.settings.internal)?void 0:e.silent_redirect_uri,null==(t=this.settings.internal)?void 0:t.popup_redirect_uri].forEach((e=>{var t;const n=null==(t=new RegExp(/^.*\/(.*).html$/gm).exec(e||""))?void 0:t[1],r=new Error(`[OIDCAuthManager] ${e||"redirect uri"} was not found.`);if(r.stack=void 0,c.isUrlMatching(location.href,e))throw r.message+="\n\n\u24d8 This usually means you forgot to include the redirect html files in your application assets.",r;if(c.isUrlMatching(location.href,`/${n}.html`))throw r.message+="\n\n\u24d8 This usually means your redirect urls are misconfigured.",r}))}async waitForRenew(e){const t=(new Date).getTime();for(;this._isRenewing;){if((new Date).getTime()>t+5e3){console.warn("[@badisi/auth-js]",`\`${e}\``,"timed out waiting for renew to finish.");break}await new Promise((e=>setTimeout(e,100)))}}async runSyncOrAsync(e){this.settings.loginRequired?await e():e()}async redirect(e,t){t&&(console.error(t),await this.removeUser());const n=c.stringToURL(e||"/");location.origin===n.origin?(history.replaceState(history.state,"",n.href),this.redirectSubs.notify(n)):location.href=n.href}async removeUser(){var e,t;this.user=null,await Promise.all([null==(e=this.userManager)?void 0:e.clearStaleState(),null==(t=this.userManager)?void 0:t.removeUser()])}async signinSilent(){this._isRenewing=!0,this.renewingSubs.notify(!0);try{var e;await(null==(e=this.userManager)?void 0:e.signinSilent())}catch(t){throw await this.removeUser(),t}finally{this._isRenewing=!1,this.renewingSubs.notify(!1)}}async backFromLoginRedirect(){try{var e;await(null==(e=this.userManager)?void 0:e.signinRedirectCallback(location.href)),await this.redirect(sessionStorage.getItem(tr))}catch(t){await this.redirect("/",t)}finally{sessionStorage.removeItem(tr)}}async backFromLogoutRedirect(){try{var e;await(null==(e=this.userManager)?void 0:e.signoutRedirectCallback(location.href)),await this.redirect(sessionStorage.getItem(tr)),await this.removeUser()}catch(t){await this.redirect("/",t)}finally{sessionStorage.removeItem(tr)}}patchAuth0Logout(){if(this.settings.authorityUrl.endsWith("auth0.com")){var e,t;const{authorityUrl:n,clientId:r,navigationType:i}=this.settings,s=i===Bn.POPUP?null==(e=this.settings.internal)?void 0:e.popup_post_logout_redirect_uri:null==(t=this.settings.internal)?void 0:t.post_logout_redirect_uri;this.settings.internal=Jt({},{metadataSeed:{end_session_endpoint:`${n}/v2/logout?client_id=${r}&returnTo=${s}`}},this.settings.internal)}}}n(9544);const ir=(e=>e.CapacitorPlatforms=(e=>{const t=new Map;t.set("web",{name:"web"});const n=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t};return n.addPlatform=(e,t)=>{n.platforms.set(e,t)},n.setPlatform=e=>{n.platforms.has(e)&&(n.currentPlatform=n.platforms.get(e))},n})(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});ir.addPlatform,ir.setPlatform;var sr;!function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(sr||(sr={}));class or extends Error{constructor(e,t){super(e),this.message=e,this.code=t}}const ar=e=>{var t,n,r,i,s;const o=e.CapacitorCustomPlatform||null,a=e.Capacitor||{},c=a.Plugins=a.Plugins||{},l=e.CapacitorPlatforms,u=(null===(t=null==l?void 0:l.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>null!==o?o.name:(e=>{var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"})(e)),h=(null===(n=null==l?void 0:l.currentPlatform)||void 0===n?void 0:n.isNativePlatform)||(()=>"web"!==u()),d=(null===(r=null==l?void 0:l.currentPlatform)||void 0===r?void 0:r.isPluginAvailable)||(e=>{const t=g.get(e);return!!(null==t?void 0:t.platforms.has(u()))||!!p(e)}),p=(null===(i=null==l?void 0:l.currentPlatform)||void 0===i?void 0:i.getPluginHeader)||(e=>{var t;return null===(t=a.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))}),g=new Map,f=(null===(s=null==l?void 0:l.currentPlatform)||void 0===s?void 0:s.registerPlugin)||((e,t={})=>{const n=g.get(e);if(n)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),n.proxy;const r=u(),i=p(e);let s;const l=n=>{let c;const l=(...l)=>{const u=(async()=>(!s&&r in t?s=s="function"==typeof t[r]?await t[r]():t[r]:null!==o&&!s&&"web"in t&&(s=s="function"==typeof t.web?await t.web():t.web),s))().then((t=>{const s=((t,n)=>{var s,o;if(!i){if(t)return null===(o=t[n])||void 0===o?void 0:o.bind(t);throw new or(`"${e}" plugin is not implemented on ${r}`,sr.Unimplemented)}{const r=null==i?void 0:i.methods.find((e=>n===e.name));if(r)return"promise"===r.rtype?t=>a.nativePromise(e,n.toString(),t):(t,r)=>a.nativeCallback(e,n.toString(),t,r);if(t)return null===(s=t[n])||void 0===s?void 0:s.bind(t)}})(t,n);if(s){const e=s(...l);return c=null==e?void 0:e.remove,e}throw new or(`"${e}.${n}()" is not implemented on ${r}`,sr.Unimplemented)}));return"addListener"===n&&(u.remove=async()=>c()),u};return l.toString=()=>`${n.toString()}() { [capacitor code] }`,Object.defineProperty(l,"name",{value:n,writable:!1,configurable:!1}),l},h=l("addListener"),d=l("removeListener"),f=(e,t)=>{const n=h({eventName:e},t),r=async()=>{const r=await n;d({eventName:e,callbackId:r},t)},i=new Promise((e=>n.then((()=>e({remove:r})))));return i.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()},i},v=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return i?f:h;case"removeListener":return d;default:return l(t)}}});return c[e]=v,g.set(e,{name:e,proxy:v,platforms:new Set([...Object.keys(t),...i?[r]:[]])}),v});return a.convertFileSrc||(a.convertFileSrc=e=>e),a.getPlatform=u,a.handleError=t=>e.console.error(t),a.isNativePlatform=h,a.isPluginAvailable=d,a.pluginMethodNoop=(e,t,n)=>Promise.reject(`${n} does not have an implementation of "${t}".`),a.registerPlugin=f,a.Exception=or,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},cr=(e=>e.Capacitor=ar(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});cr.registerPlugin,cr.Plugins;const lr='\n    .flex {\n        flex: 1;\n    }\n\n    .hidden {\n        display: none !important;\n    }\n\n    .row {\n        display: flex;\n        flex-direction: row;\n    }\n\n    .column {\n        display: flex;\n        flex-direction: column;\n    }\n\n    .card {\n        border: 1px solid rgba(0, 0, 0, 0.12);\n        border-radius: 4px;\n        background-color: white;\n        margin: 12px 6px;\n    }\n\n    .card-title {\n        padding: 16px;\n        font-size: 20px;\n        font-weight: 500;\n        color: rgba(0, 0, 0, 0.87);\n        align-items: center;\n    }\n\n    .json-key {\n        color: rgb(124, 77, 255);\n    }\n\n    .json-value {\n        color: rgb(67, 122, 237);\n    }\n\n    .json-string {\n        color: rgb(83, 160, 83);\n    }\n\n    .json-date {\n        color: rgb(200, 56, 198);\n    }\n\n    input {\n        color: #5e35b1;\n        padding: 10px;\n        border: 1px solid #0000001f;\n        border-radius: 4px;\n        font-size: 14px;\n    }\n\n    input:invalid {\n        border-color: #f44336;\n    }\n\n    input[type="checkbox"] {\n        margin-right: 10px;\n    }\n\n    select {\n        color: #5e35b1;\n        padding: 8px 6px;\n        border: 1px solid #0000001f;\n        border-radius: 4px;\n    }\n\n    @media only screen and (max-width: 600px) {\n        :host {\n            padding: 0 !important;\n            padding-bottom: 24px !important;\n        }\n\n        :host .card {\n            border: 0;\n            margin: 0;\n            margin-bottom: 6px;\n        }\n    }\n',ur=(e,t=[])=>e?JSON.stringify(e,null,2).replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/^( *)("[\w-]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/gm,((e,n,r,i,s)=>{let o=n||"";const a=r?r.replace(/[": ]/g,""):void 0;if(a&&(o+=`<span class="json-key">${a}</span>: `),i&&(o+=`<span class="${i.startsWith('"')?"json-string":"json-value"}">${i}</span>`,a&&t.includes(a))){const e=new Date(1e3*Number(i)),t=`${e.toDateString()}, ${e.toLocaleTimeString()}`;t&&(o+=` <span class="json-date">(${t})</span>`)}return o+(s||"")})):"",hr=document.createElement("template");hr.innerHTML=`\n    <style>\n        ${lr}\n\n        :host header {\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            padding-top: calc(0px + var(--safe-area-inset-top));\n            align-items: center;\n            height: 130px;\n            color: white;\n            background: rgb(103, 58, 183);\n            background: linear-gradient(180deg, rgba(103, 58, 183, 1) 0%, rgba(94, 53, 177, 1) 100%);\n        }\n\n        :host header .github-icon {\n            position: absolute;\n            top: calc(20px + var(--safe-area-inset-top));\n            right: 34px;\n            width: 26px;\n            height: 26px;\n            color: white;\n        }\n\n        @keyframes statusLoadingAnimation {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n        }\n\n        :host header .status.loading {\n            background: none;\n        }\n\n        :host header .status.loading:after {\n            display: block;\n            content: " ";\n            width: 11px;\n            height: 11px;\n            border-radius: 50%;\n            border: 2px solid #fff;\n            border-color: #fff transparent #fff transparent;\n            animation: statusLoadingAnimation 1.2s linear infinite;\n        }\n\n        :host header .status.not-authenticated {\n            background-color: #EC407A;\n        }\n\n        :host header .status.authenticated {\n            background-color: #7CB342;\n        }\n\n        :host header .status {\n            position: absolute;\n            top: calc(25px + var(--safe-area-inset-top));\n            right: 70px;\n            width: 15px;\n            height: 15px;\n            z-index: 1;\n            border-radius: 50%;\n            margin-top: 1px;\n            margin-right: 8px;\n        }\n\n        :host header .version {\n            position: absolute;\n            bottom: 13px;\n        }\n\n        :host header .version a {\n            font-size: 13px;\n            font-weight: 300;\n            font-style: italic;\n            text-decoration: none;\n            color: #bda9e1;\n        }\n\n        :host header .version a:hover {\n            text-decoration: underline;\n        }\n\n        :host header .title {\n            position: relative;\n            align-items: center;\n            margin: 8px 0;\n            font-size: 1.4em;\n            font-weight: 400;\n            color: #ede7f6;\n        }\n\n        :host header .title .icon {\n            margin-top: 3px;\n            margin-right: 4px;\n        }\n\n        :host header .title select {\n            cursor: pointer;\n            text-align: center;\n            font-size: 1.1em;\n            font-weight: bold;\n            color: #ede7f6;\n            background: none;\n            border: none;\n            outline: none;\n        }\n\n        :host header .title .tip {\n            position: absolute;\n            right: -204px;\n            font-size: 15px;\n            font-weight: 300;\n            font-style: italic;\n            color: #ffd341;\n        }\n\n        :host header .title .tip .hand {\n            font-size: 18px;\n        }\n\n        :host header button {\n            margin-top: 2px;\n        }\n\n        :host header button:not(:last-child) {\n            margin-right: 10px;\n        }\n\n        @media only screen and (max-width: 600px) {\n            :host header .title {\n                align-self: flex-start;\n                margin-left: 24px;\n            }\n        }\n        @media only screen and (max-width: 1000px) {\n            :host header .title .tip {\n                display: none;\n            }\n        }\n    </style>\n\n    <header class="column">\n        <div class="status loading"></div>\n\n        <a class="github-icon"\n            href="https://github.com/Badisi/auth-js"\n            target="_blank"\n            title="View it on GitHub"\n            aria-label="GitHub repository">\n            <span>\n                <svg viewBox="0 0 24 24"\n                    xmlns="http://www.w3.org/2000/svg">\n                    <path fill="currentColor"\n                        d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12">\n                    </path>\n                </svg>\n            </span>\n        </a>\n\n        <div class="title row">\n            <span class="icon">\ud83d\udee1\ufe0f</span>Demo app &#123; <select id="implementation-select"></select> &#125;\n            <div class="tip"><span class="hand">\ud83d\udc48</span> choose an implementation</div>\n        </div>\n\n        <div class="version"></div>\n\n        <div class="row">\n            <button id="login-button">LOGIN</button>\n            <button id="logout-button">LOGOUT</button>\n            <button id="silent-renew-button">SILENT RENEW</button>\n        </div>\n    </header>\n`;class dr extends HTMLElement{constructor(){var e,t,n,r,i,s,o;super(),this.listeners=[],this.implSelectEl=void 0,this.statusEl=void 0,this.versionEl=void 0,this.loginButtonEl=void 0,this.logoutButtonEl=void 0,this.silentRenewButtonEl=void 0,this.attachShadow({mode:"open"}),null==(e=this.shadowRoot)||e.appendChild(document.importNode(hr.content,!0)),this.implSelectEl=null==(t=this.shadowRoot)?void 0:t.querySelector("#implementation-select"),this.statusEl=null==(n=this.shadowRoot)?void 0:n.querySelector(".status"),this.versionEl=null==(r=this.shadowRoot)?void 0:r.querySelector(".version"),this.loginButtonEl=null==(i=this.shadowRoot)?void 0:i.querySelector("#login-button"),this.logoutButtonEl=null==(s=this.shadowRoot)?void 0:s.querySelector("#logout-button"),this.silentRenewButtonEl=null==(o=this.shadowRoot)?void 0:o.querySelector("#silent-renew-button")}set isRenewing(e){this.statusEl&&this.statusEl.classList[e?"add":"remove"]("loading")}set isAuthenticated(e){this.statusEl&&null!==e&&(this.statusEl.classList.remove("loading"),this.statusEl.title=e?"Authenticated":"Not authenticated",this.statusEl.classList[e?"add":"remove"]("authenticated"),this.statusEl.classList[e?"remove":"add"]("not-authenticated"))}connectedCallback(){if(window.location.href.includes("localhost")){const e=document.createElement("option");e.textContent="localhost",this.implSelectEl.appendChild(e)}else{window.authSettings.getImplementations().forEach((e=>{const t=document.createElement("option");t.value=String(e.label),t.textContent=e.label,this.implSelectEl.appendChild(t)}));const e=()=>{window.location.href=window.authSettings.getImplementations()[this.implSelectEl.selectedIndex].demoUrl};this.implSelectEl.addEventListener("change",e),this.listeners.push((()=>this.implSelectEl.removeEventListener("change",e)))}const e=()=>{var e,t;null==(e=this.shadowRoot)||null==(t=e.querySelector("header .title .tip"))||t.remove(),window.authSettings.saveShowTip(!1)};window.authSettings.getShowTip()?(this.implSelectEl.addEventListener("click",e,{once:!0}),this.listeners.push((()=>this.implSelectEl.removeEventListener("click",e)))):e(),this.refreshImplementation(),this.addEventListeners()}disconnectedCallback(){this.listeners.forEach((e=>e()))}addEventListeners(){var e,t,n;const r=()=>this.dispatchEvent(new Event("login",{bubbles:!0,composed:!0}));null==(e=this.loginButtonEl)||e.addEventListener("click",r);const i=()=>this.dispatchEvent(new Event("logout",{bubbles:!0,composed:!0}));null==(t=this.logoutButtonEl)||t.addEventListener("click",i);const s=()=>this.dispatchEvent(new Event("silentRenew",{bubbles:!0,composed:!0}));null==(n=this.silentRenewButtonEl)||n.addEventListener("click",s),this.listeners.push((()=>{var e;return null==(e=this.loginButtonEl)?void 0:e.removeEventListener("click",r)}),(()=>{var e;return null==(e=this.logoutButtonEl)?void 0:e.removeEventListener("click",i)}),(()=>{var e;return null==(e=this.silentRenewButtonEl)?void 0:e.removeEventListener("click",s)}))}refreshImplementation(){const e=window.authSettings.getImplementations();if(window.location.href.includes("localhost"))this.implSelectEl.selectedIndex=0,this.versionEl.innerHTML="<a>@localhost</a>";else{const t=e.findIndex((e=>window.location.href.includes(e.demoUrl))),n=-1!==t?e[t]:e[0];this.implSelectEl.selectedIndex=-1!==t?t:0,this.versionEl.innerHTML=n.version}}}window.customElements.define("demo-app-header",dr);const pr=document.createElement("template");pr.innerHTML=`\n    <style>\n        ${lr}\n\n        :host .tabs {\n            position: fixed;\n            top: calc(130px + var(--safe-area-inset-top));\n            left: 0;\n            right: 0;\n            z-index: 1;\n            align-self: normal;\n            padding: 10px 0;\n            padding-left: 36px;\n            background-color: #7043bf;\n            box-shadow: 0 3px 5px -1px #0003, 0 6px 10px #00000024, 0 1px 18px #0000001f;\n        }\n\n        :host .tabs a {\n            cursor: pointer;\n            color: white;\n            padding: 8px 16px;\n            border-radius: 4px;\n            transition: background-color 150ms cubic-bezier(0.35, 0, 0.25, 1);\n        }\n\n        :host .tabs a.selected {\n            background-color: #512da8;\n        }\n\n        :host .tabs a:hover {\n            background-color: #4527a0;\n        }\n\n        :host .tabs a:not(:last-child) {\n            margin-right: 10px;\n        }\n\n        :host .tabs-content {\n            position: fixed;\n            top: calc(130px + 55px + var(--safe-area-inset-top));\n            left: 0;\n            right: 0;\n            bottom: calc(0px + var(--safe-area-inset-bottom));\n            overflow: auto;\n        }\n\n        @media only screen and (max-width: 600px) {\n            :host .tabs {\n                padding-left: 0;\n                justify-content: center;\n            }\n        }\n    </style>\n\n    <demo-app-header></demo-app-header>\n    <nav id="tabs" class="tabs row"></nav>\n    <div class="tabs-content">\n        <slot id="views"></slot>\n    </div>\n`;class gr extends HTMLElement{constructor(){var e,t,n;super(),this.listeners=[],this.tabsContentEl=void 0,this.demoAppHeaderEl=void 0,this.tabs=[],this.views=[],this.currentTabIndex=-1,this.attachShadow({mode:"open"}),null==(e=this.shadowRoot)||e.appendChild(document.importNode(pr.content,!0)),this.tabsContentEl=null==(t=this.shadowRoot)?void 0:t.querySelector(".tabs-content"),this.demoAppHeaderEl=null==(n=this.shadowRoot)?void 0:n.querySelector("demo-app-header")}set isRenewing(e){this.demoAppHeaderEl.isRenewing=e}set isAuthenticated(e){this.demoAppHeaderEl.isAuthenticated=e}connectedCallback(){this.drawTabs(),this.showView(window.authSettings?window.authSettings.getCurrentTabIndex():0)}disconnectedCallback(){this.listeners.forEach((e=>e()))}drawTabs(){var e,t;const n=null==(e=this.shadowRoot)?void 0:e.querySelector("#views"),r=null==(t=this.shadowRoot)?void 0:t.querySelector("#tabs");n&&r&&(this.views=n.assignedElements(),this.views.forEach(((e,t)=>{e.style.display="none";const n=document.createElement("a");n.textContent=e.getAttribute("tabLabel")||"?";const i=()=>this.showView(t);n.addEventListener("click",i),this.listeners.push((()=>n.removeEventListener("click",i))),r.appendChild(n),this.tabs.push(n)})))}showView(e){var t,n;this.currentTabIndex!==e&&(this.currentTabIndex=e,this.tabs.forEach(((t,n)=>{t.classList[n!==e?"remove":"add"]("selected")})),this.views.forEach(((t,n)=>{t.style.display=n!==e?"none":"flex"})),null==(t=this.tabsContentEl)||t.scrollTo(0,0),null==(n=window.authSettings)||n.saveCurrentTabIndex(e))}}window.customElements.define("demo-app-main",gr);const fr=document.createElement("template");fr.innerHTML=`\n    <style>\n        ${lr}\n\n        :host {\n            display: flex;\n            flex: 1;\n            flex-direction: column;\n            padding: 20px 28px;\n        }\n\n        :host .info {\n            margin: 16px;\n        }\n\n        :host .info .title {\n            min-width: 130px;\n        }\n\n        :host .info .value {\n            overflow-x: auto;\n            white-space: pre-wrap;\n            word-wrap: break-word;\n        }\n\n        :host .info code {\n            width: 100%;\n        }\n    </style>\n\n    <div class="card">\n        <div class="info column">\n            <div class="title">Authenticated</div>\n            <code>\n                <pre id="isAuthenticated" class="value json-value"></pre>\n            </code>\n        </div>\n\n        <div class="info column">\n            <div class="title">User session</div>\n            <code>\n                <pre id="userSession" class="value"></pre>\n            </code>\n        </div>\n\n        <div class="info column">\n            <div class="title">Access token</div>\n            <code>\n                <pre id="accessToken" class="value json-value"></pre>\n                <pre id="accessTokenDecoded" class="value"></pre>\n            </code>\n        </div>\n\n        <div class="info column">\n            <div class="title">Id token</div>\n            <code>\n                <pre id="idToken" class="value json-value"></pre>\n                <pre id="idTokenDecoded" class="value"></pre>\n            </code>\n        </div>\n\n        <div class="info column">\n            <div class="title">User profile</div>\n            <code>\n                <pre id="userProfile" class="value"></pre>\n            </code>\n        </div>\n    </div>\n`;class vr extends HTMLElement{constructor(){var e;super(),this.attachShadow({mode:"open"}),null==(e=this.shadowRoot)||e.appendChild(document.importNode(fr.content,!0)),this.isAuthenticated=!1,this.userSession=void 0,this.accessToken=void 0,this.accessTokenDecoded=void 0,this.idToken=void 0,this.idTokenDecoded=void 0,this.userProfile=void 0}set isAuthenticated(e){null!==e&&this.update("#isAuthenticated",e)}set userSession(e){this.update("#userSession",ur(e,["expires_at"]))}set accessToken(e){this.update("#accessToken",e)}set accessTokenDecoded(e){const t="string"!=typeof e?ur(e,["exp","iat","auth_time"]):"(no decoded info as it is not a JWT token)";this.update("#accessTokenDecoded",t)}set idToken(e){this.update("#idToken",e)}set idTokenDecoded(e){this.update("#idTokenDecoded",ur(e,["exp","iat","auth_time"]))}set userProfile(e){this.update("#userProfile",ur(e))}update(e,t){var n;const r=null==(n=this.shadowRoot)?void 0:n.querySelector(e);var i,s;r&&(null==t||""===t?null==(i=r.closest(".info"))||i.classList.add("hidden"):(null==(s=r.closest(".info"))||s.classList.remove("hidden"),r.innerHTML=String(t)))}}window.customElements.define("demo-app-debug",vr);n(7807),n(5035),n(8512),n(200);const _r=document.createElement("template");_r.innerHTML=`\n    <style>\n        ${lr}\n\n        :host {\n            display: flex;\n            flex: 1;\n            flex-direction: column;\n            padding: 20px 28px;\n        }\n\n        :host .card {\n            padding: 16px;\n        }\n\n        :host .form-content > * {\n            margin-bottom: 24px;\n        }\n\n        :host .form-content label {\n            margin-bottom: 8px;\n        }\n\n        :host .form-actions {\n            padding: 0 8px;\n            align-items: center;\n        }\n\n        :host .form-actions button {\n            padding: 2px 12px;\n        }\n\n        :host .form-actions button:not(:last-of-type) {\n            margin-right: 12px;\n        }\n\n        :host button {\n            cursor: pointer;\n        }\n\n        :host #apply-settings-button {\n            color: white;\n            padding: 4px 18px;\n            border: none;\n            border-radius: 4px;\n            transition: background-color 150ms cubic-bezier(0.35, 0, 0.25, 1);\n            background-color: #512da8;\n        }\n\n        :host #apply-settings-button:hover {\n            background-color: #4527a0;\n        }\n\n        :host(.dirty) .form-actions #apply-settings-button,\n        :host(.dirty) .form-actions #cancel-settings-button {\n            display: flex !important;\n        }\n    </style>\n\n    <form class="column">\n        <div class="form-content card flex"></div>\n\n        <div class="form-actions row">\n            <div id="reset-settings-dev" class="hidden">\n                RESET DEFAULT TO:\n                <select id="reset-settings-select">\n                    <option value disabled selected>Choose an option</option>\n                </select>\n            </div>\n            <button id="reset-settings-button" type="button">RESET TO DEFAULT</button>\n            <span class="flex"></span>\n            <button id="cancel-settings-button" type="button" class="hidden">CANCEL</button>\n            <button id="apply-settings-button" type="submit" class="hidden">APPLY</button>\n        </div>\n    </form>\n`;class mr extends HTMLElement{constructor(){var e,t,n;super(),this.listeners=[],this.formEl=void 0,this.resetEl=void 0,this.resetDevEl=void 0,this.formContentEl=void 0,this.formIsDirty=!1,this.attachShadow({mode:"open"}),null==(e=this.shadowRoot)||e.appendChild(document.importNode(_r.content,!0)),this.resetEl=null==(t=this.shadowRoot)?void 0:t.querySelector("#reset-settings-button"),this.resetDevEl=null==(n=this.shadowRoot)?void 0:n.querySelector("#reset-settings-dev"),this.isDev=!1}set isDev(e){var t,n,r,i;e?(null==(t=this.resetDevEl)||t.classList.remove("hidden"),null==(n=this.resetEl)||n.classList.add("hidden")):(null==(r=this.resetDevEl)||r.classList.add("hidden"),null==(i=this.resetEl)||i.classList.remove("hidden"))}connectedCallback(){var e,t,n,r,i,s;this.formEl=null==(e=this.shadowRoot)?void 0:e.querySelector("form"),this.formContentEl=null==(t=this.shadowRoot)?void 0:t.querySelector(".form-content"),this.formEl.onsubmit=()=>!1,this.formEl.addEventListener("submit",(()=>this.saveAndReload()),{once:!0});const o=e=>{this.formIsDirty||"reset-settings-select"===e.target.id||(this.formIsDirty=!0,this.classList.add("dirty"))};this.formEl.addEventListener("input",o),this.listeners.push((()=>this.formEl.removeEventListener("input",o))),null==(n=this.resetEl)||n.addEventListener("click",(()=>this.resetAndReload()),{once:!0});const a=null==(r=this.shadowRoot)?void 0:r.querySelector("#reset-settings-select");null==(i=window.authSettings)||i.getSettings().forEach((e=>{const t=document.createElement("option");t.value=String(e.name),t.textContent=e.name,null==a||a.appendChild(t)}));const c=()=>this.resetAndReload(a.value);null==a||a.addEventListener("change",c),this.listeners.push((()=>a.removeEventListener("change",c)));const l=null==(s=this.shadowRoot)?void 0:s.querySelector("#cancel-settings-button"),u=()=>this.cancel();null==l||l.addEventListener("click",u),this.listeners.push((()=>null==l?void 0:l.removeEventListener("click",u))),this.refreshFormContent()}disconnectedCallback(){this.listeners.forEach((e=>e()))}resetAndReload(e){var t;null==(t=window.authSettings)||t.resetCurrentSettings(e),location.reload()}cancel(){this.formIsDirty=!1,this.classList.remove("dirty"),this.refreshFormContent()}setPathValue(e,t,n){const r=t.split(".");r.reduce(((e,t,i)=>{if(i===r.length-1)e[t]=n;else if(!Object.prototype.hasOwnProperty.call(e,t))return e[t]={},e[t];return e}),e)}getPathValue(e,t){return t.split(".").reduce(((e,t)=>e?e[t]:e),e)}refreshFormContent(){this.formContentEl.innerHTML="",window.authSettings.getLibrarySettingsDefinition().sort(((e,t)=>(t._index||0)-(e._index||0))).forEach((e=>{var t;const n=document.createElement("div");this.formContentEl.prepend(n);const r=document.createElement("label");r.htmlFor=e.name.replace(".",""),r.textContent=`${e.label}${e.required?" *":""}`;const i=document.createElement("list"===e.type?"select":"input");i.id=e.name.replace(".",""),i.name=e.name.replace(".",""),i.required=!0===e.required;const s=window.authSettings.getCurrentSettings().librarySettings;switch(e.type){case"boolean":i.checked=this.getPathValue(s,e.name),i.type="checkbox",n.appendChild(i),n.appendChild(r);break;case"list":null==(t=e.values)||t.forEach((e=>{const t=document.createElement("option");t.value=String(e.value),t.textContent=e.label,i.appendChild(t)})),i.value=this.getPathValue(s,e.name),i.classList.add("flex"),n.classList.add("input","column"),n.appendChild(r),n.appendChild(i);break;default:{const t=this.getPathValue(s,e.name);"json"===e.type?i.value=t?JSON.stringify(t):"":i.value=t,n.classList.add("input","column"),n.appendChild(r),n.appendChild(i);break}}}))}saveAndReload(){if(this.formEl.reportValidity()){var e;const t={};window.authSettings.getLibrarySettingsDefinition().forEach((e=>{var n;const r=null==(n=this.shadowRoot)?void 0:n.querySelector(`#${e.name.replace(".","")}`);let i;switch(e.type){case"boolean":i=r.checked;break;case"list":default:i=r.value;break;case"json":try{const e=r.value;e&&""!==e.trim()&&(i=JSON.parse(e))}catch(s){console.error(s)}}this.setPathValue(t,e.name,i)})),null==(e=window.authSettings)||e.saveCurrentLibrarySettings(t),location.reload()}}}window.customElements.define("demo-app-settings",mr);const wr=JSON.parse('{"u2":"@badisi/auth-js","i8":"0.0.0-semantically-released","Xh":"https://github.com/Badisi/auth-js/tree/main/projects/auth-js"}'),yr=JSON.parse('{"u2":"@badisi/ngx-auth","Xh":"https://github.com/Badisi/auth-js/tree/main/projects/ngx-auth"}');const br=[{name:"Auth0",librarySettings:{authorityUrl:"https://dev-fijd1e9x.us.auth0.com",clientId:"kRVVEnAWKMpxxpcodl0TqLXfIHgQvmmt",schemeUri:"demo-app",scope:"openid profile email phone offline_access read:current_user",internal:{extraQueryParams:{audience:"https://dev-fijd1e9x.us.auth0.com/api/v2/"}},navigationType:Bn.REDIRECT,logLevel:tn.NONE,loginRequired:!1,loadUserSession:!0,loadUserInfo:!0,automaticSilentRenew:!0}},{name:"Keycloak (local)",librarySettings:{authorityUrl:"http://localhost:8080/auth/realms/demo",clientId:"demo-app",schemeUri:"demo-app",scope:"openid profile email phone",navigationType:Bn.REDIRECT,logLevel:tn.NONE,loginRequired:!1,loadUserSession:!0,loadUserInfo:!0,automaticSilentRenew:!0}}],Sr=[{name:"authorityUrl",label:"Authority url",type:"string",required:!0},{name:"clientId",label:"Client id",type:"string",required:!0},{name:"schemeUri",label:"Scheme uri",type:"string"},{name:"scope",label:"Scope",type:"string"},{name:"internal.extraQueryParams",label:"Extra query params",type:"json"},{name:"navigationType",label:"Navigation type",type:"list",values:[{label:"REDIRECT",value:Bn.REDIRECT},{label:"POPUP",value:Bn.POPUP}]},{name:"logLevel",label:"Log level",type:"list",values:[{label:"NONE",value:tn.NONE},{label:"ERROR",value:tn.ERROR},{label:"WARN",value:tn.WARN},{label:"INFO",value:tn.INFO},{label:"DEBUG",value:tn.DEBUG}]},{name:"loginRequired",label:"Login required",type:"boolean"},{name:"loadUserSession",label:"Load user's session",type:"boolean"},{name:"loadUserInfo",label:"Load user's info",type:"boolean"},{name:"automaticSilentRenew",label:"Automatic silent renew",type:"boolean"}],xr=new class{constructor(e,t){this.storageKey=e,this.defaultAppSettings=t,this.implementations=[{label:"VanillaJS",demoUrl:"https://badisi.github.io/auth-js/demo-app/auth-js",version:`<a href="${wr.Xh}" target="_blank">${wr.u2}@main</a>`},{label:"Angular",demoUrl:"https://badisi.github.io/auth-js/demo-app/ngx-auth",version:`<a href="${yr.Xh}" target="_blank">${yr.u2}@main</a>`}],this.defaultAppSettings.librarySettingsDefinition.forEach(((e,t)=>e._index=t))}getCurrentTabIndex(){return this.getAppSettings().currentTabIndex}saveCurrentTabIndex(e){const t=this.getAppSettings();t.currentTabIndex=e,this.saveAppSettings(t)}getImplementations(){return this.implementations}getSettings(){return this.getAppSettings().settings}getShowTip(){return this.getAppSettings().showTip}getCurrentSettings(){const e=this.getAppSettings();return e.settings[e.currentSettingsIndex]}resetCurrentSettings(e){const t=this.getAppSettings();let n=t.currentSettingsIndex;if(e){const r=t.settings.findIndex((t=>t.name===e));-1!==r&&(n=r)}t.settings[n]=this.defaultAppSettings.settings[n],t.currentSettingsIndex=n,this.saveAppSettings(t)}getLibrarySettingsDefinition(){return this.getAppSettings().librarySettingsDefinition}saveShowTip(e){const t=this.getAppSettings();t.showTip=e,this.saveAppSettings(t)}saveCurrentLibrarySettings(e){const t=this.getAppSettings();t.settings[t.currentSettingsIndex].librarySettings=e,this.saveAppSettings(t)}saveCurrentOtherSettings(e){const t=this.getAppSettings();t.settings[t.currentSettingsIndex].otherSettings=e,this.saveAppSettings(t)}saveAppSettings(e){sessionStorage.setItem(this.storageKey,JSON.stringify(e))}getAppSettings(){const e=sessionStorage.getItem(this.storageKey);return e?JSON.parse(e):this.defaultAppSettings}}(`auth-js:${wr.i8}:demo-app:settings`,{showTip:!0,currentTabIndex:0,currentSettingsIndex:0,librarySettingsDefinition:Sr,settings:br});(()=>{window.authSettings=xr;const e=document.createElement("div");e.innerHTML="Loading...",document.body.appendChild(e),(async e=>await(async(e,t)=>{const n=new t;return await n.init(e),n})(e,rr))(xr.getCurrentSettings().librarySettings).then((t=>{window.authManager=t,e.replaceWith(document.createElement("app-root"))})).catch((t=>{var n;console.error(t),e.innerHTML=`${t.message}<br/><button id="loginButton">Login</button>`,null==(n=document.body.querySelector("#loginButton"))||n.addEventListener("click",(()=>location.reload()),{once:!0})}))})()},1485:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},8563:(e,t,n)=>{var r=n(6913);e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},186:(e,t,n)=>{var r=n(7952),i=n(6997),s=n(7108),o=r("unscopables"),a=Array.prototype;null==a[o]&&s.f(a,o,{configurable:!0,value:i(null)}),e.exports=function(e){a[o][e]=!0}},3264:(e,t,n)=>{"use strict";var r=n(2370).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},5209:e=>{e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},3536:(e,t,n)=>{var r=n(6913);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},8897:(e,t,n)=>{"use strict";var r=n(1248),i=n(987),s=n(6996),o=n(1855),a=n(6092),c=n(3859),l=n(6418);e.exports=function(e){var t,n,u,h,d,p,g=i(e),f="function"==typeof this?this:Array,v=arguments.length,_=v>1?arguments[1]:void 0,m=void 0!==_,w=l(g),y=0;if(m&&(_=r(_,v>2?arguments[2]:void 0,2)),null==w||f==Array&&o(w))for(n=new f(t=a(g.length));t>y;y++)p=m?_(g[y],y):g[y],c(n,y,p);else for(d=(h=w.call(g)).next,n=new f;!(u=d.call(h)).done;y++)p=m?s(h,_,[u.value,y],!0):u.value,c(n,y,p);return n.length=y,n}},7945:(e,t,n)=>{var r=n(9164),i=n(6092),s=n(2966),o=function(e){return function(t,n,o){var a,c=r(t),l=i(c.length),u=s(o,l);if(e&&n!=n){for(;l>u;)if((a=c[u++])!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},2245:(e,t,n)=>{"use strict";var r=n(3694);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},8605:(e,t,n)=>{var r=n(1485),i=n(987),s=n(6801),o=n(6092),a=function(e){return function(t,n,a,c){r(n);var l=i(t),u=s(l),h=o(l.length),d=e?h-1:0,p=e?-1:1;if(a<2)for(;;){if(d in u){c=u[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in u&&(c=n(c,u[d],d,l));return c}};e.exports={left:a(!1),right:a(!0)}},8813:e=>{var t=Math.floor,n=function(e,s){var o=e.length,a=t(o/2);return o<8?r(e,s):i(n(e.slice(0,a),s),n(e.slice(a),s),s)},r=function(e,t){for(var n,r,i=e.length,s=1;s<i;){for(r=s,n=e[s];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==s++&&(e[r]=n)}return e},i=function(e,t,n){for(var r=e.length,i=t.length,s=0,o=0,a=[];s<r||o<i;)s<r&&o<i?a.push(n(e[s],t[o])<=0?e[s++]:t[o++]):a.push(s<r?e[s++]:t[o++]);return a};e.exports=n},6996:(e,t,n)=>{var r=n(3536),i=n(5635);e.exports=function(e,t,n,s){try{return s?t(r(n)[0],n[1]):t(n)}catch(o){throw i(e),o}}},1964:(e,t,n)=>{var r=n(7952)("iterator"),i=!1;try{var s=0,o={next:function(){return{done:!!s++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,(function(){throw 2}))}catch(a){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var s={};s[r]=function(){return{next:function(){return{done:n=!0}}}},e(s)}catch(a){}return n}},2248:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},996:(e,t,n)=>{var r=n(6695),i=n(2248),s=n(7952)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(n){}}(t=Object(e),s))?n:o?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},1831:(e,t,n)=>{var r=n(322),i=n(3697),s=n(5027),o=n(7108);e.exports=function(e,t){for(var n=i(t),a=o.f,c=s.f,l=0;l<n.length;l++){var u=n[l];r(e,u)||a(e,u,c(t,u))}}},937:(e,t,n)=>{var r=n(7952)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(i){}}return!1}},560:(e,t,n)=>{var r=n(3694);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},1623:(e,t,n)=>{"use strict";var r=n(7824).IteratorPrototype,i=n(6997),s=n(8828),o=n(5411),a=n(3019),c=function(){return this};e.exports=function(e,t,n){var l=t+" Iterator";return e.prototype=i(r,{next:s(1,n)}),o(e,l,!1,!0),a[l]=c,e}},5399:(e,t,n)=>{var r=n(6079),i=n(7108),s=n(8828);e.exports=r?function(e,t,n){return i.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},8828:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},3859:(e,t,n)=>{"use strict";var r=n(5831),i=n(7108),s=n(8828);e.exports=function(e,t,n){var o=r(t);o in e?i.f(e,o,s(0,n)):e[o]=n}},3392:(e,t,n)=>{"use strict";var r=n(5302),i=n(1623),s=n(5024),o=n(1403),a=n(5411),c=n(5399),l=n(3926),u=n(7952),h=n(7442),d=n(3019),p=n(7824),g=p.IteratorPrototype,f=p.BUGGY_SAFARI_ITERATORS,v=u("iterator"),_="keys",m="values",w="entries",y=function(){return this};e.exports=function(e,t,n,u,p,b,S){i(n,t,u);var x,k,E,T=function(e){if(e===p&&O)return O;if(!f&&e in A)return A[e];switch(e){case _:case m:case w:return function(){return new n(this,e)}}return function(){return new n(this)}},R=t+" Iterator",I=!1,A=e.prototype,P=A[v]||A["@@iterator"]||p&&A[p],O=!f&&P||T(p),U="Array"==t&&A.entries||P;if(U&&(x=s(U.call(new e)),g!==Object.prototype&&x.next&&(h||s(x)===g||(o?o(x,g):"function"!=typeof x[v]&&c(x,v,y)),a(x,R,!0,!0),h&&(d[R]=y))),p==m&&P&&P.name!==m&&(I=!0,O=function(){return P.call(this)}),h&&!S||A[v]===O||c(A,v,O),d[t]=O,p)if(k={values:T(m),keys:b?O:T(_),entries:T(w)},S)for(E in k)(f||I||!(E in A))&&l(A,E,k[E]);else r({target:t,proto:!0,forced:f||I},k);return k}},6079:(e,t,n)=>{var r=n(3694);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2200:(e,t,n)=>{var r=n(7230),i=n(6913),s=r.document,o=i(s)&&i(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},5941:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},1346:(e,t,n)=>{var r=n(7749).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},417:e=>{e.exports="object"==typeof window},7636:(e,t,n)=>{var r=n(7749);e.exports=/MSIE|Trident/.test(r)},4619:(e,t,n)=>{var r=n(7749);e.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(r)},5009:(e,t,n)=>{var r=n(2248),i=n(7230);e.exports="process"==r(i.process)},2811:(e,t,n)=>{var r=n(7749);e.exports=/web0s(?!.*chrome)/i.test(r)},7749:(e,t,n)=>{var r=n(1223);e.exports=r("navigator","userAgent")||""},7806:(e,t,n)=>{var r,i,s=n(7230),o=n(7749),a=s.process,c=s.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u?i=(r=u.split("."))[0]<4?1:r[0]+r[1]:o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=r[1]),e.exports=i&&+i},7041:(e,t,n)=>{var r=n(7749).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},9799:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},5302:(e,t,n)=>{var r=n(7230),i=n(5027).f,s=n(5399),o=n(3926),a=n(746),c=n(1831),l=n(4545);e.exports=function(e,t){var n,u,h,d,p,g=e.target,f=e.global,v=e.stat;if(n=f?r:v?r[g]||a(g,{}):(r[g]||{}).prototype)for(u in t){if(d=t[u],h=e.noTargetGet?(p=i(n,u))&&p.value:n[u],!l(f?u:g+(v?".":"#")+u,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;c(d,h)}(e.sham||h&&h.sham)&&s(d,"sham",!0),o(n,u,d,e)}}},3694:e=>{e.exports=function(e){try{return!!e()}catch(t){return!0}}},4430:(e,t,n)=>{"use strict";n(5098);var r=n(3926),i=n(9735),s=n(3694),o=n(7952),a=n(5399),c=o("species"),l=RegExp.prototype;e.exports=function(e,t,n,u){var h=o(e),d=!s((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=d&&!s((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return t=!0,null},n[h](""),!t}));if(!d||!p||n){var g=/./[h],f=t(h,""[e],(function(e,t,n,r,s){var o=t.exec;return o===i||o===l.exec?d&&!s?{done:!0,value:g.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}));r(String.prototype,e,f[0]),r(l,h,f[1])}u&&a(l[h],"sham",!0)}},1248:(e,t,n)=>{var r=n(1485);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},1223:(e,t,n)=>{var r=n(7230),i=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e]):r[e]&&r[e][t]}},6418:(e,t,n)=>{var r=n(996),i=n(3019),s=n(7952)("iterator");e.exports=function(e){if(null!=e)return e[s]||e["@@iterator"]||i[r(e)]}},9853:(e,t,n)=>{var r=n(3536),i=n(6418);e.exports=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return r(t.call(e))}},6968:(e,t,n)=>{var r=n(987),i=Math.floor,s="".replace,o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,c,l,u){var h=n+e.length,d=c.length,p=a;return void 0!==l&&(l=r(l),p=o),s.call(u,p,(function(r,s){var o;switch(s.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(h);case"<":o=l[s.slice(1,-1)];break;default:var a=+s;if(0===a)return r;if(a>d){var u=i(a/10);return 0===u?r:u<=d?void 0===c[u-1]?s.charAt(1):c[u-1]+s.charAt(1):r}o=c[a-1]}return void 0===o?"":o}))}},7230:e=>{var t=function(e){return e&&e.Math==Math&&e};e.exports=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof global&&global)||function(){return this}()||Function("return this")()},322:(e,t,n)=>{var r=n(987),i={}.hasOwnProperty;e.exports=Object.hasOwn||function(e,t){return i.call(r(e),t)}},7076:e=>{e.exports={}},5812:(e,t,n)=>{var r=n(7230);e.exports=function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},6507:(e,t,n)=>{var r=n(1223);e.exports=r("document","documentElement")},4253:(e,t,n)=>{var r=n(6079),i=n(3694),s=n(2200);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},6801:(e,t,n)=>{var r=n(3694),i=n(2248),s="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?s.call(e,""):Object(e)}:Object},8089:(e,t,n)=>{var r=n(6913),i=n(1403);e.exports=function(e,t,n){var s,o;return i&&"function"==typeof(s=t.constructor)&&s!==n&&r(o=s.prototype)&&o!==n.prototype&&i(e,o),e}},4335:(e,t,n)=>{var r=n(1393),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},21:(e,t,n)=>{var r,i,s,o=n(5506),a=n(7230),c=n(6913),l=n(5399),u=n(322),h=n(1393),d=n(375),p=n(7076),g="Object already initialized",f=a.WeakMap;if(o||h.state){var v=h.state||(h.state=new f),_=v.get,m=v.has,w=v.set;r=function(e,t){if(m.call(v,e))throw new TypeError(g);return t.facade=e,w.call(v,e,t),t},i=function(e){return _.call(v,e)||{}},s=function(e){return m.call(v,e)}}else{var y=d("state");p[y]=!0,r=function(e,t){if(u(e,y))throw new TypeError(g);return t.facade=e,l(e,y,t),t},i=function(e){return u(e,y)?e[y]:{}},s=function(e){return u(e,y)}}e.exports={set:r,get:i,has:s,enforce:function(e){return s(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},1855:(e,t,n)=>{var r=n(7952),i=n(3019),s=r("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[s]===e)}},4545:(e,t,n)=>{var r=n(3694),i=/#|\.prototype\./,s=function(e,t){var n=a[o(e)];return n==l||n!=c&&("function"==typeof t?r(t):!!t)},o=s.normalize=function(e){return String(e).replace(i,".").toLowerCase()},a=s.data={},c=s.NATIVE="N",l=s.POLYFILL="P";e.exports=s},6913:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},7442:e=>{e.exports=!1},385:(e,t,n)=>{var r=n(6913),i=n(2248),s=n(7952)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},7581:(e,t,n)=>{var r=n(1223),i=n(9264);e.exports=i?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return"function"==typeof t&&Object(e)instanceof t}},5103:(e,t,n)=>{var r=n(3536),i=n(1855),s=n(6092),o=n(1248),a=n(6418),c=n(5635),l=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,n){var u,h,d,p,g,f,v,_=n&&n.that,m=!(!n||!n.AS_ENTRIES),w=!(!n||!n.IS_ITERATOR),y=!(!n||!n.INTERRUPTED),b=o(t,_,1+m+y),S=function(e){return u&&c(u),new l(!0,e)},x=function(e){return m?(r(e),y?b(e[0],e[1],S):b(e[0],e[1])):y?b(e,S):b(e)};if(w)u=e;else{if("function"!=typeof(h=a(e)))throw TypeError("Target is not iterable");if(i(h)){for(d=0,p=s(e.length);p>d;d++)if((g=x(e[d]))&&g instanceof l)return g;return new l(!1)}u=h.call(e)}for(f=u.next;!(v=f.call(u)).done;){try{g=x(v.value)}catch(k){throw c(u),k}if("object"==typeof g&&g&&g instanceof l)return g}return new l(!1)}},5635:(e,t,n)=>{var r=n(3536);e.exports=function(e){var t=e.return;if(void 0!==t)return r(t.call(e)).value}},7824:(e,t,n)=>{"use strict";var r,i,s,o=n(3694),a=n(5024),c=n(5399),l=n(322),u=n(7952),h=n(7442),d=u("iterator"),p=!1;[].keys&&("next"in(s=[].keys())?(i=a(a(s)))!==Object.prototype&&(r=i):p=!0);var g=null==r||o((function(){var e={};return r[d].call(e)!==e}));g&&(r={}),h&&!g||l(r,d)||c(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},3019:e=>{e.exports={}},3012:(e,t,n)=>{var r,i,s,o,a,c,l,u,h=n(7230),d=n(5027).f,p=n(7823).set,g=n(4619),f=n(2811),v=n(5009),_=h.MutationObserver||h.WebKitMutationObserver,m=h.document,w=h.process,y=h.Promise,b=d(h,"queueMicrotask"),S=b&&b.value;S||(r=function(){var e,t;for(v&&(e=w.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(n){throw i?o():s=void 0,n}}s=void 0,e&&e.enter()},g||v||f||!_||!m?y&&y.resolve?((l=y.resolve(void 0)).constructor=y,u=l.then,o=function(){u.call(l,r)}):o=v?function(){w.nextTick(r)}:function(){p.call(h,r)}:(a=!0,c=m.createTextNode(""),new _(r).observe(c,{characterData:!0}),o=function(){c.data=a=!a})),e.exports=S||function(e){var t={fn:e,next:void 0};s&&(s.next=t),i||(i=t,o()),s=t}},3479:(e,t,n)=>{var r=n(7230);e.exports=r.Promise},8724:(e,t,n)=>{var r=n(7806),i=n(3694);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},4169:(e,t,n)=>{var r=n(3694),i=n(7952),s=n(7442),o=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),s&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},5506:(e,t,n)=>{var r=n(7230),i=n(4335),s=r.WeakMap;e.exports="function"==typeof s&&/native code/.test(i(s))},6935:(e,t,n)=>{"use strict";var r=n(1485),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},6487:(e,t,n)=>{var r=n(385);e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},5016:(e,t,n)=>{"use strict";var r=n(6079),i=n(3694),s=n(6127),o=n(7375),a=n(5486),c=n(987),l=n(6801),u=Object.assign,h=Object.defineProperty;e.exports=!u||i((function(){if(r&&1!==u({b:1},u(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||s(u({},t)).join("")!=i}))?function(e,t){for(var n=c(e),i=arguments.length,u=1,h=o.f,d=a.f;i>u;)for(var p,g=l(arguments[u++]),f=h?s(g).concat(h(g)):s(g),v=f.length,_=0;v>_;)p=f[_++],r&&!d.call(g,p)||(n[p]=g[p]);return n}:u},6997:(e,t,n)=>{var r,i=n(3536),s=n(7673),o=n(9799),a=n(7076),c=n(6507),l=n(2200),u=n(375),h=u("IE_PROTO"),d=function(){},p=function(e){return"<script>"+e+"</"+"script>"},g=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}f=document.domain&&r?g(r):function(){var e,t=l("iframe");if(t.style)return t.style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F}()||g(r);for(var e=o.length;e--;)delete f.prototype[o[e]];return f()};a[h]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[h]=e):n=f(),void 0===t?n:s(n,t)}},7673:(e,t,n)=>{var r=n(6079),i=n(7108),s=n(3536),o=n(6127);e.exports=r?Object.defineProperties:function(e,t){s(e);for(var n,r=o(t),a=r.length,c=0;a>c;)i.f(e,n=r[c++],t[n]);return e}},7108:(e,t,n)=>{var r=n(6079),i=n(4253),s=n(3536),o=n(5831),a=Object.defineProperty;t.f=r?a:function(e,t,n){if(s(e),t=o(t),s(n),i)try{return a(e,t,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},5027:(e,t,n)=>{var r=n(6079),i=n(5486),s=n(8828),o=n(9164),a=n(5831),c=n(322),l=n(4253),u=Object.getOwnPropertyDescriptor;t.f=r?u:function(e,t){if(e=o(e),t=a(t),l)try{return u(e,t)}catch(n){}if(c(e,t))return s(!i.f.call(e,t),e[t])}},7852:(e,t,n)=>{var r=n(3821),i=n(9799).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},7375:(e,t)=>{t.f=Object.getOwnPropertySymbols},5024:(e,t,n)=>{var r=n(322),i=n(987),s=n(375),o=n(560),a=s("IE_PROTO"),c=Object.prototype;e.exports=o?Object.getPrototypeOf:function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?c:null}},3821:(e,t,n)=>{var r=n(322),i=n(9164),s=n(7945).indexOf,o=n(7076);e.exports=function(e,t){var n,a=i(e),c=0,l=[];for(n in a)!r(o,n)&&r(a,n)&&l.push(n);for(;t.length>c;)r(a,n=t[c++])&&(~s(l,n)||l.push(n));return l}},6127:(e,t,n)=>{var r=n(3821),i=n(9799);e.exports=Object.keys||function(e){return r(e,i)}},5486:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},1403:(e,t,n)=>{var r=n(3536),i=n(8563);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(s){}return function(n,s){return r(n),i(s),t?e.call(n,s):n.__proto__=s,n}}():void 0)},7013:(e,t,n)=>{var r=n(6913);e.exports=function(e,t){var n,i;if("string"===t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if("string"!==t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},3697:(e,t,n)=>{var r=n(1223),i=n(7852),s=n(7375),o=n(3536);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(o(e)),n=s.f;return n?t.concat(n(e)):t}},7731:e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},8888:(e,t,n)=>{var r=n(3536),i=n(6913),s=n(6935);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=s.f(e);return(0,n.resolve)(t),n.promise}},7777:(e,t,n)=>{var r=n(3926);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},3926:(e,t,n)=>{var r=n(7230),i=n(5399),s=n(322),o=n(746),a=n(4335),c=n(21),l=c.get,u=c.enforce,h=String(String).split("String");(e.exports=function(e,t,n,a){var c,l=!!a&&!!a.unsafe,d=!!a&&!!a.enumerable,p=!!a&&!!a.noTargetGet;"function"==typeof n&&("string"!=typeof t||s(n,"name")||i(n,"name",t),(c=u(n)).source||(c.source=h.join("string"==typeof t?t:""))),e!==r?(l?!p&&e[t]&&(d=!0):delete e[t],d?e[t]=n:i(e,t,n)):d?e[t]=n:o(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||a(this)}))},5731:(e,t,n)=>{var r=n(2248),i=n(9735);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var s=n.call(e,t);if("object"!=typeof s)throw TypeError("RegExp exec method returned something other than an Object or null");return s}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},9735:(e,t,n)=>{"use strict";var r,i,s=n(9851),o=n(8608),a=n(9154),c=n(3268),l=n(6997),u=n(21).get,h=n(5021),d=n(2916),p=RegExp.prototype.exec,g=c("native-string-replace",String.prototype.replace),f=p,v=(r=/a/,i=/b*/g,p.call(r,"a"),p.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),_=a.UNSUPPORTED_Y||a.BROKEN_CARET,m=void 0!==/()??/.exec("")[1];(v||m||_||h||d)&&(f=function(e){var t,n,r,i,a,c,h,d=this,w=u(d),y=s(e),b=w.raw;if(b)return b.lastIndex=d.lastIndex,t=f.call(b,y),d.lastIndex=b.lastIndex,t;var S=w.groups,x=_&&d.sticky,k=o.call(d),E=d.source,T=0,R=y;if(x&&(-1===(k=k.replace("y","")).indexOf("g")&&(k+="g"),R=y.slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==y.charAt(d.lastIndex-1))&&(E="(?: "+E+")",R=" "+R,T++),n=new RegExp("^(?:"+E+")",k)),m&&(n=new RegExp("^"+E+"$(?!\\s)",k)),v&&(r=d.lastIndex),i=p.call(x?n:d,R),x?i?(i.input=i.input.slice(T),i[0]=i[0].slice(T),i.index=d.lastIndex,d.lastIndex+=i[0].length):d.lastIndex=0:v&&i&&(d.lastIndex=d.global?i.index+i[0].length:r),m&&i&&i.length>1&&g.call(i[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)})),i&&S)for(i.groups=c=l(null),a=0;a<S.length;a++)c[(h=S[a])[0]]=i[h[1]];return i}),e.exports=f},8608:(e,t,n)=>{"use strict";var r=n(3536);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},9154:(e,t,n)=>{var r=n(3694),i=function(e,t){return RegExp(e,t)};t.UNSUPPORTED_Y=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},5021:(e,t,n)=>{var r=n(3694);e.exports=r((function(){var e=RegExp(".","string".charAt(0));return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},2916:(e,t,n)=>{var r=n(3694);e.exports=r((function(){var e=RegExp("(?<a>b)","string".charAt(5));return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},7105:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},746:(e,t,n)=>{var r=n(7230);e.exports=function(e,t){try{Object.defineProperty(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},6898:(e,t,n)=>{"use strict";var r=n(1223),i=n(7108),s=n(7952),o=n(6079),a=s("species");e.exports=function(e){var t=r(e),n=i.f;o&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},5411:(e,t,n)=>{var r=n(7108).f,i=n(322),s=n(7952)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,s)&&r(e,s,{configurable:!0,value:t})}},375:(e,t,n)=>{var r=n(3268),i=n(4525),s=r("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},1393:(e,t,n)=>{var r=n(7230),i=n(746),s="__core-js_shared__",o=r[s]||i(s,{});e.exports=o},3268:(e,t,n)=>{var r=n(7442),i=n(1393);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.16.0",mode:r?"pure":"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})},640:(e,t,n)=>{var r=n(3536),i=n(1485),s=n(7952)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||null==(n=r(o)[s])?t:i(n)}},2370:(e,t,n)=>{var r=n(68),i=n(9851),s=n(7105),o=function(e){return function(t,n){var o,a,c=i(s(t)),l=r(n),u=c.length;return l<0||l>=u?e?"":void 0:(o=c.charCodeAt(l))<55296||o>56319||l+1===u||(a=c.charCodeAt(l+1))<56320||a>57343?e?c.charAt(l):o:e?c.slice(l,l+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},7137:e=>{"use strict";var t=2147483647,n=/[^\0-\u007E]/,r=/[.\u3002\uFF0E\uFF61]/g,i="Overflow: input needs wider integers to process",s=Math.floor,o=String.fromCharCode,a=function(e){return e+22+75*(e<26)},c=function(e,t,n){var r=0;for(e=n?s(e/700):e>>1,e+=s(e/t);e>455;r+=36)e=s(e/35);return s(r+36*e/(e+38))},l=function(e){var n=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var s=e.charCodeAt(n++);56320==(64512&s)?t.push(((1023&i)<<10)+(1023&s)+65536):(t.push(i),n--)}else t.push(i)}return t}(e);var r,l,u=e.length,h=128,d=0,p=72;for(r=0;r<e.length;r++)(l=e[r])<128&&n.push(o(l));var g=n.length,f=g;for(g&&n.push("-");f<u;){var v=t;for(r=0;r<e.length;r++)(l=e[r])>=h&&l<v&&(v=l);var _=f+1;if(v-h>s((t-d)/_))throw RangeError(i);for(d+=(v-h)*_,h=v,r=0;r<e.length;r++){if((l=e[r])<h&&++d>t)throw RangeError(i);if(l==h){for(var m=d,w=36;;w+=36){var y=w<=p?1:w>=p+26?26:w-p;if(m<y)break;var b=m-y,S=36-y;n.push(o(a(y+b%S))),m=s(b/S)}n.push(o(a(m))),p=c(d,_,f==g),d=0,++f}}++d,++h}return n.join("")};e.exports=function(e){var t,i,s=[],o=e.toLowerCase().replace(r,".").split(".");for(t=0;t<o.length;t++)i=o[t],s.push(n.test(i)?"xn--"+l(i):i);return s.join(".")}},511:(e,t,n)=>{var r=n(3694),i=n(1152);e.exports=function(e){return r((function(){return!!i[e]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[e]()||i[e].name!==e}))}},7011:(e,t,n)=>{var r=n(7105),i=n(9851),s="["+n(1152)+"]",o=RegExp("^"+s+s+"*"),a=RegExp(s+s+"*$"),c=function(e){return function(t){var n=i(r(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(a,"")),n}};e.exports={start:c(1),end:c(2),trim:c(3)}},7823:(e,t,n)=>{var r,i,s,o,a=n(7230),c=n(3694),l=n(1248),u=n(6507),h=n(2200),d=n(4619),p=n(5009),g=a.setImmediate,f=a.clearImmediate,v=a.process,_=a.MessageChannel,m=a.Dispatch,w=0,y={},b="onreadystatechange";try{r=a.location}catch(T){}var S=function(e){if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},x=function(e){return function(){S(e)}},k=function(e){S(e.data)},E=function(e){a.postMessage(String(e),r.protocol+"//"+r.host)};g&&f||(g=function(e){for(var t=[],n=arguments.length,r=1;n>r;)t.push(arguments[r++]);return y[++w]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},i(w),w},f=function(e){delete y[e]},p?i=function(e){v.nextTick(x(e))}:m&&m.now?i=function(e){m.now(x(e))}:_&&!d?(o=(s=new _).port2,s.port1.onmessage=k,i=l(o.postMessage,o,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts&&r&&"file:"!==r.protocol&&!c(E)?(i=E,a.addEventListener("message",k,!1)):i=b in h("script")?function(e){u.appendChild(h("script")).onreadystatechange=function(){u.removeChild(this),S(e)}}:function(e){setTimeout(x(e),0)}),e.exports={set:g,clear:f}},2966:(e,t,n)=>{var r=n(68),i=Math.max,s=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):s(n,t)}},9164:(e,t,n)=>{var r=n(6801),i=n(7105);e.exports=function(e){return r(i(e))}},68:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},6092:(e,t,n)=>{var r=n(68),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},987:(e,t,n)=>{var r=n(7105);e.exports=function(e){return Object(r(e))}},5962:(e,t,n)=>{var r=n(6913),i=n(7581),s=n(7013),o=n(7952)("toPrimitive");e.exports=function(e,t){if(!r(e)||i(e))return e;var n,a=e[o];if(void 0!==a){if(void 0===t&&(t="default"),n=a.call(e,t),!r(n)||i(n))return n;throw TypeError("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},5831:(e,t,n)=>{var r=n(5962),i=n(7581);e.exports=function(e){var t=r(e,"string");return i(t)?t:String(t)}},6695:(e,t,n)=>{var r={};r[n(7952)("toStringTag")]="z",e.exports="[object z]"===String(r)},9851:(e,t,n)=>{var r=n(7581);e.exports=function(e){if(r(e))throw TypeError("Cannot convert a Symbol value to a string");return String(e)}},4525:e=>{var t=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+n).toString(36)}},9264:(e,t,n)=>{var r=n(8724);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},7952:(e,t,n)=>{var r=n(7230),i=n(3268),s=n(322),o=n(4525),a=n(8724),c=n(9264),l=i("wks"),u=r.Symbol,h=c?u:u&&u.withoutSetter||o;e.exports=function(e){return s(l,e)&&(a||"string"==typeof l[e])||(a&&s(u,e)?l[e]=u[e]:l[e]=h("Symbol."+e)),l[e]}},1152:e=>{e.exports="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff"},6025:(e,t,n)=>{"use strict";var r=n(5302),i=n(7945).includes,s=n(186);r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s("includes")},4836:(e,t,n)=>{"use strict";var r=n(9164),i=n(186),s=n(3019),o=n(21),a=n(3392),c="Array Iterator",l=o.set,u=o.getterFor(c);e.exports=a(Array,"Array",(function(e,t){l(this,{type:c,target:r(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),s.Arguments=s.Array,i("keys"),i("values"),i("entries")},5035:(e,t,n)=>{"use strict";var r=n(5302),i=n(8605).left,s=n(2245),o=n(7806),a=n(5009);r({target:"Array",proto:!0,forced:!s("reduce")||!a&&o>79&&o<83},{reduce:function(e){return i(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},8512:(e,t,n)=>{"use strict";var r=n(5302),i=n(1485),s=n(987),o=n(6092),a=n(9851),c=n(3694),l=n(8813),u=n(2245),h=n(1346),d=n(7636),p=n(7806),g=n(7041),f=[],v=f.sort,_=c((function(){f.sort(void 0)})),m=c((function(){f.sort(null)})),w=u("sort"),y=!c((function(){if(p)return p<70;if(!(h&&h>3)){if(d)return!0;if(g)return g<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)f.push({k:t+r,v:n})}for(f.sort((function(e,t){return t.v-e.v})),r=0;r<f.length;r++)t=f[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:_||!m||!w||!y},{sort:function(e){void 0!==e&&i(e);var t=s(this);if(y)return void 0===e?v.call(t):v.call(t,e);var n,r,c=[],u=o(t.length);for(r=0;r<u;r++)r in t&&c.push(t[r]);for(c=l(c,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:a(t)>a(n)?1:-1}}(e)),n=c.length,r=0;r<n;)t[r]=c[r++];for(;r<u;)delete t[r++];return t}})},110:(e,t,n)=>{var r=n(5302),i=n(5016);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},5754:(e,t,n)=>{"use strict";var r,i,s,o,a=n(5302),c=n(7442),l=n(7230),u=n(1223),h=n(3479),d=n(3926),p=n(7777),g=n(1403),f=n(5411),v=n(6898),_=n(6913),m=n(1485),w=n(5209),y=n(4335),b=n(5103),S=n(1964),x=n(640),k=n(7823).set,E=n(3012),T=n(8888),R=n(5812),I=n(6935),A=n(7731),P=n(21),O=n(4545),U=n(7952),C=n(417),j=n(5009),L=n(7806),M=U("species"),N="Promise",q=P.get,$=P.set,H=P.getterFor(N),B=h&&h.prototype,D=h,F=B,W=l.TypeError,z=l.document,J=l.process,K=I.f,V=K,G=!!(z&&z.createEvent&&l.dispatchEvent),Q="function"==typeof PromiseRejectionEvent,Y="unhandledrejection",X=!1,Z=O(N,(function(){var e=y(D),t=e!==String(D);if(!t&&66===L)return!0;if(c&&!F.finally)return!0;if(L>=51&&/native code/.test(e))return!1;var n=new D((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[M]=r,!(X=n.then((function(){}))instanceof r)||!t&&C&&!Q})),ee=Z||!S((function(e){D.all(e).catch((function(){}))})),te=function(e){var t;return!(!_(e)||"function"!=typeof(t=e.then))&&t},ne=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;E((function(){for(var r=e.value,i=1==e.state,s=0;n.length>s;){var o,a,c,l=n[s++],u=i?l.ok:l.fail,h=l.resolve,d=l.reject,p=l.domain;try{u?(i||(2===e.rejection&&oe(e),e.rejection=1),!0===u?o=r:(p&&p.enter(),o=u(r),p&&(p.exit(),c=!0)),o===l.promise?d(W("Promise-chain cycle")):(a=te(o))?a.call(o,h,d):h(o)):d(r)}catch(g){p&&!c&&p.exit(),d(g)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&ie(e)}))}},re=function(e,t,n){var r,i;G?((r=z.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),l.dispatchEvent(r)):r={promise:t,reason:n},!Q&&(i=l["on"+e])?i(r):e===Y&&R("Unhandled promise rejection",n)},ie=function(e){k.call(l,(function(){var t,n=e.facade,r=e.value;if(se(e)&&(t=A((function(){j?J.emit("unhandledRejection",r,n):re(Y,n,r)})),e.rejection=j||se(e)?2:1,t.error))throw t.value}))},se=function(e){return 1!==e.rejection&&!e.parent},oe=function(e){k.call(l,(function(){var t=e.facade;j?J.emit("rejectionHandled",t):re("rejectionhandled",t,e.value)}))},ae=function(e,t,n){return function(r){e(t,r,n)}},ce=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ne(e,!0))},le=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw W("Promise can't be resolved itself");var r=te(t);r?E((function(){var n={done:!1};try{r.call(t,ae(le,n,e),ae(ce,n,e))}catch(i){ce(n,i,e)}})):(e.value=t,e.state=1,ne(e,!1))}catch(i){ce({done:!1},i,e)}}};if(Z&&(F=(D=function(e){w(this,D,N),m(e),r.call(this);var t=q(this);try{e(ae(le,t),ae(ce,t))}catch(n){ce(t,n)}}).prototype,(r=function(e){$(this,{type:N,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(F,{then:function(e,t){var n=H(this),r=K(x(this,D));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=j?J.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&ne(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=q(e);this.promise=e,this.resolve=ae(le,t),this.reject=ae(ce,t)},I.f=K=function(e){return e===D||e===s?new i(e):V(e)},!c&&"function"==typeof h&&B!==Object.prototype)){o=B.then,X||(d(B,"then",(function(e,t){var n=this;return new D((function(e,t){o.call(n,e,t)})).then(e,t)}),{unsafe:!0}),d(B,"catch",F.catch,{unsafe:!0}));try{delete B.constructor}catch(ue){}g&&g(B,F)}a({global:!0,wrap:!0,forced:Z},{Promise:D}),f(D,N,!1,!0),v(N),s=u(N),a({target:N,stat:!0,forced:Z},{reject:function(e){var t=K(this);return t.reject.call(void 0,e),t.promise}}),a({target:N,stat:!0,forced:c||Z},{resolve:function(e){return T(c&&this===s?D:this,e)}}),a({target:N,stat:!0,forced:ee},{all:function(e){var t=this,n=K(t),r=n.resolve,i=n.reject,s=A((function(){var n=m(t.resolve),s=[],o=0,a=1;b(e,(function(e){var c=o++,l=!1;s.push(void 0),a++,n.call(t,e).then((function(e){l||(l=!0,s[c]=e,--a||r(s))}),i)})),--a||r(s)}));return s.error&&i(s.value),n.promise},race:function(e){var t=this,n=K(t),r=n.reject,i=A((function(){var i=m(t.resolve);b(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},222:(e,t,n)=>{var r=n(6079),i=n(7230),s=n(4545),o=n(8089),a=n(5399),c=n(7108).f,l=n(7852).f,u=n(385),h=n(9851),d=n(8608),p=n(9154),g=n(3926),f=n(3694),v=n(322),_=n(21).enforce,m=n(6898),w=n(7952),y=n(5021),b=n(2916),S=w("match"),x=i.RegExp,k=x.prototype,E=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,T=/a/g,R=/a/g,I=new x(T)!==T,A=p.UNSUPPORTED_Y,P=r&&(!I||A||y||b||f((function(){return R[S]=!1,x(T)!=T||x(R)==R||"/a/i"!=x(T,"i")})));if(s("RegExp",P)){for(var O=function(e,t){var n,r,i,s,c,l,p=this instanceof O,g=u(e),f=void 0===t,m=[],w=e;if(!p&&g&&f&&e.constructor===O)return e;if((g||e instanceof O)&&(e=e.source,f&&(t="flags"in w?w.flags:d.call(w))),e=void 0===e?"":h(e),t=void 0===t?"":h(t),w=e,y&&"dotAll"in T&&(r=!!t&&t.indexOf("s")>-1)&&(t=t.replace(/s/g,"")),n=t,A&&"sticky"in T&&(i=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,"")),b&&(s=function(e){for(var t,n=e.length,r=0,i="",s=[],o={},a=!1,c=!1,l=0,u="";r<=n;r++){if("\\"===(t=e.charAt(r)))t+=e.charAt(++r);else if("]"===t)a=!1;else if(!a)switch(!0){case"["===t:a=!0;break;case"("===t:E.test(e.slice(r+1))&&(r+=2,c=!0),i+=t,l++;continue;case">"===t&&c:if(""===u||v(o,u))throw new SyntaxError("Invalid capture group name");o[u]=!0,s.push([u,l]),c=!1,u="";continue}c?u+=t:i+=t}return[i,s]}(e),e=s[0],m=s[1]),c=o(x(e,t),p?this:k,O),(r||i||m.length)&&(l=_(c),r&&(l.dotAll=!0,l.raw=O(function(e){for(var t,n=e.length,r=0,i="",s=!1;r<=n;r++)"\\"!==(t=e.charAt(r))?s||"."!==t?("["===t?s=!0:"]"===t&&(s=!1),i+=t):i+="[\\s\\S]":i+=t+e.charAt(++r);return i}(e),n)),i&&(l.sticky=!0),m.length&&(l.groups=m)),e!==w)try{a(c,"source",""===w?"(?:)":w)}catch(S){}return c},U=function(e){e in O||c(O,e,{configurable:!0,get:function(){return x[e]},set:function(t){x[e]=t}})},C=l(x),j=0;C.length>j;)U(C[j++]);k.constructor=O,O.prototype=k,g(i,"RegExp",O)}m("RegExp")},5098:(e,t,n)=>{"use strict";var r=n(5302),i=n(9735);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},6858:(e,t,n)=>{"use strict";var r=n(3926),i=n(3536),s=n(9851),o=n(3694),a=n(8608),c="toString",l=RegExp.prototype,u=l.toString,h=o((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),d=u.name!=c;(h||d)&&r(RegExp.prototype,c,(function(){var e=i(this),t=s(e.source),n=e.flags;return"/"+t+"/"+s(void 0===n&&e instanceof RegExp&&!("flags"in l)?a.call(e):n)}),{unsafe:!0})},3661:(e,t,n)=>{"use strict";var r,i=n(5302),s=n(5027).f,o=n(6092),a=n(9851),c=n(6487),l=n(7105),u=n(937),h=n(7442),d="".endsWith,p=Math.min,g=u("endsWith");i({target:"String",proto:!0,forced:!!(h||g||(r=s(String.prototype,"endsWith"),!r||r.writable))&&!g},{endsWith:function(e){var t=a(l(this));c(e);var n=arguments.length>1?arguments[1]:void 0,r=o(t.length),i=void 0===n?r:p(o(n),r),s=a(e);return d?d.call(t,s,i):t.slice(i-s.length,i)===s}})},9470:(e,t,n)=>{"use strict";var r=n(5302),i=n(6487),s=n(7105),o=n(9851);r({target:"String",proto:!0,forced:!n(937)("includes")},{includes:function(e){return!!~o(s(this)).indexOf(o(i(e)),arguments.length>1?arguments[1]:void 0)}})},270:(e,t,n)=>{"use strict";var r=n(2370).charAt,i=n(9851),s=n(21),o=n(3392),a="String Iterator",c=s.set,l=s.getterFor(a);o(String,"String",(function(e){c(this,{type:a,string:i(e),index:0})}),(function(){var e,t=l(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},9544:(e,t,n)=>{"use strict";var r=n(4430),i=n(3694),s=n(3536),o=n(68),a=n(6092),c=n(9851),l=n(7105),u=n(3264),h=n(6968),d=n(5731),p=n(7952)("replace"),g=Math.max,f=Math.min,v="$0"==="a".replace(/./,"$0"),_=!!/./[p]&&""===/./[p]("a","$0");r("replace",(function(e,t,n){var r=_?"$":"$0";return[function(e,n){var r=l(this),i=null==e?void 0:e[p];return void 0!==i?i.call(e,r,n):t.call(c(r),e,n)},function(e,i){var l=s(this),p=c(e);if("string"==typeof i&&-1===i.indexOf(r)&&-1===i.indexOf("$<")){var v=n(t,l,p,i);if(v.done)return v.value}var _="function"==typeof i;_||(i=c(i));var m=l.global;if(m){var w=l.unicode;l.lastIndex=0}for(var y=[];;){var b=d(l,p);if(null===b)break;if(y.push(b),!m)break;""===c(b[0])&&(l.lastIndex=u(p,a(l.lastIndex),w))}for(var S,x="",k=0,E=0;E<y.length;E++){b=y[E];for(var T=c(b[0]),R=g(f(o(b.index),p.length),0),I=[],A=1;A<b.length;A++)I.push(void 0===(S=b[A])?S:String(S));var P=b.groups;if(_){var O=[T].concat(I,R,p);void 0!==P&&O.push(P);var U=c(i.apply(void 0,O))}else U=h(T,p,R,I,P,i);R>=k&&(x+=p.slice(k,R)+U,k=R+T.length)}return x+p.slice(k)}]}),!!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!v||_)},7807:(e,t,n)=>{"use strict";var r=n(4430),i=n(385),s=n(3536),o=n(7105),a=n(640),c=n(3264),l=n(6092),u=n(9851),h=n(5731),d=n(9735),p=n(9154),g=n(3694),f=p.UNSUPPORTED_Y,v=[].push,_=Math.min,m=4294967295;r("split",(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=u(o(this)),s=void 0===n?m:n>>>0;if(0===s)return[];if(void 0===e)return[r];if(!i(e))return t.call(r,e,s);for(var a,c,l,h=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,f=new RegExp(e.source,p+"g");(a=d.call(f,r))&&!((c=f.lastIndex)>g&&(h.push(r.slice(g,a.index)),a.length>1&&a.index<r.length&&v.apply(h,a.slice(1)),l=a[0].length,g=c,h.length>=s));)f.lastIndex===a.index&&f.lastIndex++;return g===r.length?!l&&f.test("")||h.push(""):h.push(r.slice(g)),h.length>s?h.slice(0,s):h}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=o(this),s=null==t?void 0:t[e];return void 0!==s?s.call(t,i,n):r.call(u(i),t,n)},function(e,i){var o=s(this),d=u(e),p=n(r,o,d,i,r!==t);if(p.done)return p.value;var g=a(o,RegExp),v=o.unicode,w=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(f?"g":"y"),y=new g(f?"^(?:"+o.source+")":o,w),b=void 0===i?m:i>>>0;if(0===b)return[];if(0===d.length)return null===h(y,d)?[d]:[];for(var S=0,x=0,k=[];x<d.length;){y.lastIndex=f?0:x;var E,T=h(y,f?d.slice(x):d);if(null===T||(E=_(l(y.lastIndex+(f?x:0)),d.length))===S)x=c(d,x,v);else{if(k.push(d.slice(S,x)),k.length===b)return k;for(var R=1;R<=T.length-1;R++)if(k.push(T[R]),k.length===b)return k;x=S=E}}return k.push(d.slice(S)),k}]}),!!g((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),f)},217:(e,t,n)=>{"use strict";var r,i=n(5302),s=n(5027).f,o=n(6092),a=n(9851),c=n(6487),l=n(7105),u=n(937),h=n(7442),d="".startsWith,p=Math.min,g=u("startsWith");i({target:"String",proto:!0,forced:!!(h||g||(r=s(String.prototype,"startsWith"),!r||r.writable))&&!g},{startsWith:function(e){var t=a(l(this));c(e);var n=o(p(arguments.length>1?arguments[1]:void 0,t.length)),r=a(e);return d?d.call(t,r,n):t.slice(n,n+r.length)===r}})},200:(e,t,n)=>{"use strict";var r=n(5302),i=n(7011).trim;r({target:"String",proto:!0,forced:n(511)("trim")},{trim:function(){return i(this)}})},8127:(e,t,n)=>{var r=n(7230),i=n(5941),s=n(4836),o=n(5399),a=n(7952),c=a("iterator"),l=a("toStringTag"),u=s.values;for(var h in i){var d=r[h],p=d&&d.prototype;if(p){if(p[c]!==u)try{o(p,c,u)}catch(f){p[c]=u}if(p[l]||o(p,l,h),i[h])for(var g in s)if(p[g]!==s[g])try{o(p,g,s[g])}catch(f){p[g]=s[g]}}}},5979:(e,t,n)=>{"use strict";n(4836);var r=n(5302),i=n(1223),s=n(4169),o=n(3926),a=n(7777),c=n(5411),l=n(1623),u=n(21),h=n(5209),d=n(322),p=n(1248),g=n(996),f=n(3536),v=n(6913),_=n(9851),m=n(6997),w=n(8828),y=n(9853),b=n(6418),S=n(7952),x=i("fetch"),k=i("Request"),E=k&&k.prototype,T=i("Headers"),R=S("iterator"),I="URLSearchParams",A="URLSearchParamsIterator",P=u.set,O=u.getterFor(I),U=u.getterFor(A),C=/\+/g,j=Array(4),L=function(e){return j[e-1]||(j[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},M=function(e){try{return decodeURIComponent(e)}catch(t){return e}},N=function(e){var t=e.replace(C," "),n=4;try{return decodeURIComponent(t)}catch(r){for(;n;)t=t.replace(L(n--),M);return t}},q=/[!'()~]|%20/g,$={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},H=function(e){return $[e]},B=function(e){return encodeURIComponent(e).replace(q,H)},D=function(e,t){if(t)for(var n,r,i=t.split("&"),s=0;s<i.length;)(n=i[s++]).length&&(r=n.split("="),e.push({key:N(r.shift()),value:N(r.join("="))}))},F=function(e){this.entries.length=0,D(this.entries,e)},W=function(e,t){if(e<t)throw TypeError("Not enough arguments")},z=l((function(e,t){P(this,{type:A,iterator:y(O(e).entries),kind:t})}),"Iterator",(function(){var e=U(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n})),J=function(){h(this,J,I);var e,t,n,r,i,s,o,a,c,l=arguments.length>0?arguments[0]:void 0,u=this,p=[];if(P(u,{type:I,entries:p,updateURL:function(){},updateSearchParams:F}),void 0!==l)if(v(l))if("function"==typeof(e=b(l)))for(n=(t=e.call(l)).next;!(r=n.call(t)).done;){if((o=(s=(i=y(f(r.value))).next).call(i)).done||(a=s.call(i)).done||!s.call(i).done)throw TypeError("Expected sequence with length 2");p.push({key:_(o.value),value:_(a.value)})}else for(c in l)d(l,c)&&p.push({key:c,value:_(l[c])});else D(p,"string"==typeof l?"?"===l.charAt(0)?l.slice(1):l:_(l))},K=J.prototype;if(a(K,{append:function(e,t){W(arguments.length,2);var n=O(this);n.entries.push({key:_(e),value:_(t)}),n.updateURL()},delete:function(e){W(arguments.length,1);for(var t=O(this),n=t.entries,r=_(e),i=0;i<n.length;)n[i].key===r?n.splice(i,1):i++;t.updateURL()},get:function(e){W(arguments.length,1);for(var t=O(this).entries,n=_(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){W(arguments.length,1);for(var t=O(this).entries,n=_(e),r=[],i=0;i<t.length;i++)t[i].key===n&&r.push(t[i].value);return r},has:function(e){W(arguments.length,1);for(var t=O(this).entries,n=_(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){W(arguments.length,1);for(var n,r=O(this),i=r.entries,s=!1,o=_(e),a=_(t),c=0;c<i.length;c++)(n=i[c]).key===o&&(s?i.splice(c--,1):(s=!0,n.value=a));s||i.push({key:o,value:a}),r.updateURL()},sort:function(){var e,t,n,r=O(this),i=r.entries,s=i.slice();for(i.length=0,n=0;n<s.length;n++){for(e=s[n],t=0;t<n;t++)if(i[t].key>e.key){i.splice(t,0,e);break}t===n&&i.push(e)}r.updateURL()},forEach:function(e){for(var t,n=O(this).entries,r=p(e,arguments.length>1?arguments[1]:void 0,3),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new z(this,"keys")},values:function(){return new z(this,"values")},entries:function(){return new z(this,"entries")}},{enumerable:!0}),o(K,R,K.entries),o(K,"toString",(function(){for(var e,t=O(this).entries,n=[],r=0;r<t.length;)e=t[r++],n.push(B(e.key)+"="+B(e.value));return n.join("&")}),{enumerable:!0}),c(J,I),r({global:!0,forced:!s},{URLSearchParams:J}),!s&&"function"==typeof T){var V=function(e){if(v(e)){var t,n=e.body;if(g(n)===I)return(t=e.headers?new T(e.headers):new T).has("content-type")||t.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),m(e,{body:w(0,String(n)),headers:w(0,t)})}return e};if("function"==typeof x&&r({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return x(e,arguments.length>1?V(arguments[1]):{})}}),"function"==typeof k){var G=function(e){return h(this,G,"Request"),new k(e,arguments.length>1?V(arguments[1]):{})};E.constructor=G,G.prototype=E,r({global:!0,forced:!0},{Request:G})}}e.exports={URLSearchParams:J,getState:O}},4049:(e,t,n)=>{"use strict";n(270);var r,i=n(5302),s=n(6079),o=n(4169),a=n(7230),c=n(7673),l=n(3926),u=n(5209),h=n(322),d=n(5016),p=n(8897),g=n(2370).codeAt,f=n(7137),v=n(9851),_=n(5411),m=n(5979),w=n(21),y=a.URL,b=m.URLSearchParams,S=m.getState,x=w.set,k=w.getterFor("URL"),E=Math.floor,T=Math.pow,R="Invalid scheme",I="Invalid host",A="Invalid port",P=/[A-Za-z]/,O=/[\d+-.A-Za-z]/,U=/\d/,C=/^0x/i,j=/^[0-7]+$/,L=/^\d+$/,M=/^[\dA-Fa-f]+$/,N=/[\0\t\n\r #%/:<>?@[\\\]^|]/,q=/[\0\t\n\r #/:<>?@[\\\]^|]/,$=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,H=/[\t\n\r]/g,B=function(e,t){var n,r,i;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return I;if(!(n=F(t.slice(1,-1))))return I;e.host=n}else if(Y(e)){if(t=f(t),N.test(t))return I;if(null===(n=D(t)))return I;e.host=n}else{if(q.test(t))return I;for(n="",r=p(t),i=0;i<r.length;i++)n+=G(r[i],z);e.host=n}},D=function(e){var t,n,r,i,s,o,a,c=e.split(".");if(c.length&&""==c[c.length-1]&&c.pop(),(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=c[r]))return e;if(s=10,i.length>1&&"0"==i.charAt(0)&&(s=C.test(i)?16:8,i=i.slice(8==s?1:2)),""===i)o=0;else{if(!(10==s?L:8==s?j:M).test(i))return e;o=parseInt(i,s)}n.push(o)}for(r=0;r<t;r++)if(o=n[r],r==t-1){if(o>=T(256,5-t))return null}else if(o>255)return null;for(a=n.pop(),r=0;r<n.length;r++)a+=n[r]*T(256,3-r);return a},F=function(e){var t,n,r,i,s,o,a,c=[0,0,0,0,0,0,0,0],l=0,u=null,h=0,d=function(){return e.charAt(h)};if(":"==d()){if(":"!=e.charAt(1))return;h+=2,u=++l}for(;d();){if(8==l)return;if(":"!=d()){for(t=n=0;n<4&&M.test(d());)t=16*t+parseInt(d(),16),h++,n++;if("."==d()){if(0==n)return;if(h-=n,l>6)return;for(r=0;d();){if(i=null,r>0){if(!("."==d()&&r<4))return;h++}if(!U.test(d()))return;for(;U.test(d());){if(s=parseInt(d(),10),null===i)i=s;else{if(0==i)return;i=10*i+s}if(i>255)return;h++}c[l]=256*c[l]+i,2!=++r&&4!=r||l++}if(4!=r)return;break}if(":"==d()){if(h++,!d())return}else if(d())return;c[l++]=t}else{if(null!==u)return;h++,u=++l}}if(null!==u)for(o=l-u,l=7;0!=l&&o>0;)a=c[l],c[l--]=c[u+o-1],c[u+--o]=a;else if(8!=l)return;return c},W=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=E(e/256);return t.join(".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,s=0;s<8;s++)0!==e[s]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=s),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}return e},z={},J=d({},z,{" ":1,'"':1,"<":1,">":1,"`":1}),K=d({},J,{"#":1,"?":1,"{":1,"}":1}),V=d({},K,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),G=function(e,t){var n=g(e,0);return n>32&&n<127&&!h(t,e)?e:encodeURIComponent(e)},Q={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Y=function(e){return h(Q,e.scheme)},X=function(e){return""!=e.username||""!=e.password},Z=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},ee=function(e,t){var n;return 2==e.length&&P.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)},te=function(e){var t;return e.length>1&&ee(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},ne=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&ee(t[0],!0)||t.pop()},re=function(e){return"."===e||"%2e"===e.toLowerCase()},ie={},se={},oe={},ae={},ce={},le={},ue={},he={},de={},pe={},ge={},fe={},ve={},_e={},me={},we={},ye={},be={},Se={},xe={},ke={},Ee=function(e,t,n,i){var s,o,a,c,l,u=n||ie,d=0,g="",f=!1,v=!1,_=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace($,"")),t=t.replace(H,""),s=p(t);d<=s.length;){switch(o=s[d],u){case ie:if(!o||!P.test(o)){if(n)return R;u=oe;continue}g+=o.toLowerCase(),u=se;break;case se:if(o&&(O.test(o)||"+"==o||"-"==o||"."==o))g+=o.toLowerCase();else{if(":"!=o){if(n)return R;g="",u=oe,d=0;continue}if(n&&(Y(e)!=h(Q,g)||"file"==g&&(X(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=g,n)return void(Y(e)&&Q[e.scheme]==e.port&&(e.port=null));g="","file"==e.scheme?u=_e:Y(e)&&i&&i.scheme==e.scheme?u=ae:Y(e)?u=he:"/"==s[d+1]?(u=ce,d++):(e.cannotBeABaseURL=!0,e.path.push(""),u=Se)}break;case oe:if(!i||i.cannotBeABaseURL&&"#"!=o)return R;if(i.cannotBeABaseURL&&"#"==o){e.scheme=i.scheme,e.path=i.path.slice(),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,u=ke;break}u="file"==i.scheme?_e:le;continue;case ae:if("/"!=o||"/"!=s[d+1]){u=le;continue}u=de,d++;break;case ce:if("/"==o){u=pe;break}u=be;continue;case le:if(e.scheme=i.scheme,o==r)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query;else if("/"==o||"\\"==o&&Y(e))u=ue;else if("?"==o)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query="",u=xe;else{if("#"!=o){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.path.pop(),u=be;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=i.path.slice(),e.query=i.query,e.fragment="",u=ke}break;case ue:if(!Y(e)||"/"!=o&&"\\"!=o){if("/"!=o){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,u=be;continue}u=pe}else u=de;break;case he:if(u=de,"/"!=o||"/"!=g.charAt(d+1))continue;d++;break;case de:if("/"!=o&&"\\"!=o){u=pe;continue}break;case pe:if("@"==o){f&&(g="%40"+g),f=!0,a=p(g);for(var m=0;m<a.length;m++){var w=a[m];if(":"!=w||_){var y=G(w,V);_?e.password+=y:e.username+=y}else _=!0}g=""}else if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&Y(e)){if(f&&""==g)return"Invalid authority";d-=p(g).length+1,g="",u=ge}else g+=o;break;case ge:case fe:if(n&&"file"==e.scheme){u=we;continue}if(":"!=o||v){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&Y(e)){if(Y(e)&&""==g)return I;if(n&&""==g&&(X(e)||null!==e.port))return;if(c=B(e,g))return c;if(g="",u=ye,n)return;continue}"["==o?v=!0:"]"==o&&(v=!1),g+=o}else{if(""==g)return I;if(c=B(e,g))return c;if(g="",u=ve,n==fe)return}break;case ve:if(!U.test(o)){if(o==r||"/"==o||"?"==o||"#"==o||"\\"==o&&Y(e)||n){if(""!=g){var b=parseInt(g,10);if(b>65535)return A;e.port=Y(e)&&b===Q[e.scheme]?null:b,g=""}if(n)return;u=ye;continue}return A}g+=o;break;case _e:if(e.scheme="file","/"==o||"\\"==o)u=me;else{if(!i||"file"!=i.scheme){u=be;continue}if(o==r)e.host=i.host,e.path=i.path.slice(),e.query=i.query;else if("?"==o)e.host=i.host,e.path=i.path.slice(),e.query="",u=xe;else{if("#"!=o){te(s.slice(d).join(""))||(e.host=i.host,e.path=i.path.slice(),ne(e)),u=be;continue}e.host=i.host,e.path=i.path.slice(),e.query=i.query,e.fragment="",u=ke}}break;case me:if("/"==o||"\\"==o){u=we;break}i&&"file"==i.scheme&&!te(s.slice(d).join(""))&&(ee(i.path[0],!0)?e.path.push(i.path[0]):e.host=i.host),u=be;continue;case we:if(o==r||"/"==o||"\\"==o||"?"==o||"#"==o){if(!n&&ee(g))u=be;else if(""==g){if(e.host="",n)return;u=ye}else{if(c=B(e,g))return c;if("localhost"==e.host&&(e.host=""),n)return;g="",u=ye}continue}g+=o;break;case ye:if(Y(e)){if(u=be,"/"!=o&&"\\"!=o)continue}else if(n||"?"!=o)if(n||"#"!=o){if(o!=r&&(u=be,"/"!=o))continue}else e.fragment="",u=ke;else e.query="",u=xe;break;case be:if(o==r||"/"==o||"\\"==o&&Y(e)||!n&&("?"==o||"#"==o)){if(".."===(l=(l=g).toLowerCase())||"%2e."===l||".%2e"===l||"%2e%2e"===l?(ne(e),"/"==o||"\\"==o&&Y(e)||e.path.push("")):re(g)?"/"==o||"\\"==o&&Y(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&ee(g)&&(e.host&&(e.host=""),g=g.charAt(0)+":"),e.path.push(g)),g="","file"==e.scheme&&(o==r||"?"==o||"#"==o))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==o?(e.query="",u=xe):"#"==o&&(e.fragment="",u=ke)}else g+=G(o,K);break;case Se:"?"==o?(e.query="",u=xe):"#"==o?(e.fragment="",u=ke):o!=r&&(e.path[0]+=G(o,z));break;case xe:n||"#"!=o?o!=r&&("'"==o&&Y(e)?e.query+="%27":e.query+="#"==o?"%23":G(o,z)):(e.fragment="",u=ke);break;case ke:o!=r&&(e.fragment+=G(o,J))}d++}},Te=function(e){var t,n,r=u(this,Te,"URL"),i=arguments.length>1?arguments[1]:void 0,o=v(e),a=x(r,{type:"URL"});if(void 0!==i)if(i instanceof Te)t=k(i);else if(n=Ee(t={},v(i)))throw TypeError(n);if(n=Ee(a,o,null,t))throw TypeError(n);var c=a.searchParams=new b,l=S(c);l.updateSearchParams(a.query),l.updateURL=function(){a.query=String(c)||null},s||(r.href=Ie.call(r),r.origin=Ae.call(r),r.protocol=Pe.call(r),r.username=Oe.call(r),r.password=Ue.call(r),r.host=Ce.call(r),r.hostname=je.call(r),r.port=Le.call(r),r.pathname=Me.call(r),r.search=Ne.call(r),r.searchParams=qe.call(r),r.hash=$e.call(r))},Re=Te.prototype,Ie=function(){var e=k(this),t=e.scheme,n=e.username,r=e.password,i=e.host,s=e.port,o=e.path,a=e.query,c=e.fragment,l=t+":";return null!==i?(l+="//",X(e)&&(l+=n+(r?":"+r:"")+"@"),l+=W(i),null!==s&&(l+=":"+s)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?o[0]:o.length?"/"+o.join("/"):"",null!==a&&(l+="?"+a),null!==c&&(l+="#"+c),l},Ae=function(){var e=k(this),t=e.scheme,n=e.port;if("blob"==t)try{return new Te(t.path[0]).origin}catch(r){return"null"}return"file"!=t&&Y(e)?t+"://"+W(e.host)+(null!==n?":"+n:""):"null"},Pe=function(){return k(this).scheme+":"},Oe=function(){return k(this).username},Ue=function(){return k(this).password},Ce=function(){var e=k(this),t=e.host,n=e.port;return null===t?"":null===n?W(t):W(t)+":"+n},je=function(){var e=k(this).host;return null===e?"":W(e)},Le=function(){var e=k(this).port;return null===e?"":String(e)},Me=function(){var e=k(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Ne=function(){var e=k(this).query;return e?"?"+e:""},qe=function(){return k(this).searchParams},$e=function(){var e=k(this).fragment;return e?"#"+e:""},He=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(s&&c(Re,{href:He(Ie,(function(e){var t=k(this),n=v(e),r=Ee(t,n);if(r)throw TypeError(r);S(t.searchParams).updateSearchParams(t.query)})),origin:He(Ae),protocol:He(Pe,(function(e){var t=k(this);Ee(t,v(e)+":",ie)})),username:He(Oe,(function(e){var t=k(this),n=p(v(e));if(!Z(t)){t.username="";for(var r=0;r<n.length;r++)t.username+=G(n[r],V)}})),password:He(Ue,(function(e){var t=k(this),n=p(v(e));if(!Z(t)){t.password="";for(var r=0;r<n.length;r++)t.password+=G(n[r],V)}})),host:He(Ce,(function(e){var t=k(this);t.cannotBeABaseURL||Ee(t,v(e),ge)})),hostname:He(je,(function(e){var t=k(this);t.cannotBeABaseURL||Ee(t,v(e),fe)})),port:He(Le,(function(e){var t=k(this);Z(t)||(""==(e=v(e))?t.port=null:Ee(t,e,ve))})),pathname:He(Me,(function(e){var t=k(this);t.cannotBeABaseURL||(t.path=[],Ee(t,v(e),ye))})),search:He(Ne,(function(e){var t=k(this);""==(e=v(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",Ee(t,e,xe)),S(t.searchParams).updateSearchParams(t.query)})),searchParams:He(qe),hash:He($e,(function(e){var t=k(this);""!=(e=v(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",Ee(t,e,ke)):t.fragment=null}))}),l(Re,"toJSON",(function(){return Ie.call(this)}),{enumerable:!0}),l(Re,"toString",(function(){return Ie.call(this)}),{enumerable:!0}),y){var Be=y.createObjectURL,De=y.revokeObjectURL;Be&&l(Te,"createObjectURL",(function(e){return Be.apply(y,arguments)})),De&&l(Te,"revokeObjectURL",(function(e){return De.apply(y,arguments)}))}_(Te,"URL"),i({global:!0,forced:!o,sham:!s},{URL:Te})},1175:function(e,t,n){var r;e.exports=(r=r||function(e,t){var r;if("undefined"!=typeof window&&window.crypto&&(r=window.crypto),"undefined"!=typeof self&&self.crypto&&(r=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(r=globalThis.crypto),!r&&"undefined"!=typeof window&&window.msCrypto&&(r=window.msCrypto),!r&&"undefined"!=typeof global&&global.crypto&&(r=global.crypto),!r)try{r=n(6519)}catch(v){}var i=function(){if(r){if("function"==typeof r.getRandomValues)try{return r.getRandomValues(new Uint32Array(1))[0]}catch(v){}if("function"==typeof r.randomBytes)try{return r.randomBytes(4).readInt32LE()}catch(v){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),o={},a=o.lib={},c=a.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=a.WordArray=c.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var s=0;s<i;s++){var o=n[s>>>2]>>>24-s%4*8&255;t[r+s>>>2]|=o<<24-(r+s)%4*8}else for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(i());return new l.init(t,e)}}),u=o.enc={},h=u.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new l.init(n,t/2)}},d=u.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new l.init(n,t)}},p=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},g=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,i=r.words,s=r.sigBytes,o=this.blockSize,a=s/(4*o),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,u=e.min(4*c,s);if(c){for(var h=0;h<c;h+=o)this._doProcessBlock(i,h);n=i.splice(0,c),r.sigBytes-=u}return new l.init(n,u)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(a.Hasher=g.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),o.algo={});return o}(Math),r)},4924:function(e,t,n){var r;e.exports=(r=n(1175),function(){var e=r,t=e.lib.WordArray;function n(e,n,r){for(var i=[],s=0,o=0;o<n;o++)if(o%4){var a=r[e.charCodeAt(o-1)]<<o%4*2|r[e.charCodeAt(o)]>>>6-o%4*2;i[s>>>2]|=a<<24-s%4*8,s++}return t.create(i,s)}e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],s=0;s<n;s+=3)for(var o=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<n;a++)i.push(r.charAt(o>>>6*(3-a)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,r=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var s=0;s<r.length;s++)i[r.charCodeAt(s)]=s}var o=r.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return n(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),r.enc.Base64)},9602:function(e,t,n){var r;e.exports=(r=n(1175),r.enc.Utf8)},9393:function(e,t,n){var r;e.exports=(r=n(1175),function(e){var t=r,n=t.lib,i=n.WordArray,s=n.Hasher,o=t.algo,a=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)t(r)&&(i<8&&(a[i]=n(e.pow(r,.5))),c[i]=n(e.pow(r,1/3)),i++),r++}();var l=[],u=o.SHA256=s.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],u=n[5],h=n[6],d=n[7],p=0;p<64;p++){if(p<16)l[p]=0|e[t+p];else{var g=l[p-15],f=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,v=l[p-2],_=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;l[p]=f+l[p-7]+_+l[p-16]}var m=r&i^r&s^i&s,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),y=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&h)+c[p]+l[p];d=h,h=u,u=a,a=o+y|0,o=s,s=i,i=r,r=y+(w+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0,n[5]=n[5]+u|0,n[6]=n[6]+h|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(u),t.HmacSHA256=s._createHmacHelper(u)}(Math),r.SHA256)},6519:()=>{}},e=>{var t;t=3435,e(e.s=t)}]);