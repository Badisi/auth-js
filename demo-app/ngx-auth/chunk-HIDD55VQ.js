import{$ as ji,A as Sr,B as Cr,C as Tt,F as Di,G as Rt,H as Pi,I as Mi,J as Vi,M as te,N as re,P as ve,Q as Oi,R as Wa,V as Ui,W as Ni,Y as $a,a as S,aa as je,b as H,c as Ai,d as P,e as u,ea as Er,f as nt,g as kt,h as _r,i as l,j as Te,k as vr,l as de,m as Ha,n as yr,o as wr,p as It,q as G,r as ki,s as ce,t as ue,u as qa,v as Ii,w as Ti,x as Ri,y as br,z as xr}from"./chunk-CSB3ELRG.js";var Fi=nt(()=>{"use strict"});var ot=nt((Dt,Li)=>{"use strict";(function(t,e){typeof Dt=="object"?Li.exports=Dt=e():typeof define=="function"&&define.amd?define([],e):t.CryptoJS=e()})(Dt,function(){var t=t||(function(e,r){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof global<"u"&&global.crypto&&(i=global.crypto),!i&&typeof Ai=="function")try{i=Fi()}catch{}var s=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},n=Object.create||(function(){function h(){}return function(_){var w;return h.prototype=_,w=new h,h.prototype=null,w}})(),o={},a=o.lib={},d=a.Base=(function(){return{extend:function(h){var _=n(this);return h&&_.mixIn(h),(!_.hasOwnProperty("init")||this.init===_.init)&&(_.init=function(){_.$super.init.apply(this,arguments)}),_.init.prototype=_,_.$super=this,_},create:function(){var h=this.extend();return h.init.apply(h,arguments),h},init:function(){},mixIn:function(h){for(var _ in h)h.hasOwnProperty(_)&&(this[_]=h[_]);h.hasOwnProperty("toString")&&(this.toString=h.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),c=a.WordArray=d.extend({init:function(h,_){h=this.words=h||[],_!=r?this.sigBytes=_:this.sigBytes=h.length*4},toString:function(h){return(h||f).stringify(this)},concat:function(h){var _=this.words,w=h.words,v=this.sigBytes,k=h.sigBytes;if(this.clamp(),v%4)for(var C=0;C<k;C++){var b=w[C>>>2]>>>24-C%4*8&255;_[v+C>>>2]|=b<<24-(v+C)%4*8}else for(var E=0;E<k;E+=4)_[v+E>>>2]=w[E>>>2];return this.sigBytes+=k,this},clamp:function(){var h=this.words,_=this.sigBytes;h[_>>>2]&=4294967295<<32-_%4*8,h.length=e.ceil(_/4)},clone:function(){var h=d.clone.call(this);return h.words=this.words.slice(0),h},random:function(h){for(var _=[],w=0;w<h;w+=4)_.push(s());return new c.init(_,h)}}),p=o.enc={},f=p.Hex={stringify:function(h){for(var _=h.words,w=h.sigBytes,v=[],k=0;k<w;k++){var C=_[k>>>2]>>>24-k%4*8&255;v.push((C>>>4).toString(16)),v.push((C&15).toString(16))}return v.join("")},parse:function(h){for(var _=h.length,w=[],v=0;v<_;v+=2)w[v>>>3]|=parseInt(h.substr(v,2),16)<<24-v%8*4;return new c.init(w,_/2)}},m=p.Latin1={stringify:function(h){for(var _=h.words,w=h.sigBytes,v=[],k=0;k<w;k++){var C=_[k>>>2]>>>24-k%4*8&255;v.push(String.fromCharCode(C))}return v.join("")},parse:function(h){for(var _=h.length,w=[],v=0;v<_;v++)w[v>>>2]|=(h.charCodeAt(v)&255)<<24-v%4*8;return new c.init(w,_)}},g=p.Utf8={stringify:function(h){try{return decodeURIComponent(escape(m.stringify(h)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(h){return m.parse(unescape(encodeURIComponent(h)))}},y=a.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(h){typeof h=="string"&&(h=g.parse(h)),this._data.concat(h),this._nDataBytes+=h.sigBytes},_process:function(h){var _,w=this._data,v=w.words,k=w.sigBytes,C=this.blockSize,b=C*4,E=k/b;h?E=e.ceil(E):E=e.max((E|0)-this._minBufferSize,0);var D=E*C,N=e.min(D*4,k);if(D){for(var M=0;M<D;M+=C)this._doProcessBlock(v,M);_=v.splice(0,D),w.sigBytes-=N}return new c.init(_,N)},clone:function(){var h=d.clone.call(this);return h._data=this._data.clone(),h},_minBufferSize:0}),A=a.Hasher=y.extend({cfg:d.extend(),init:function(h){this.cfg=this.cfg.extend(h),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(h){return this._append(h),this._process(),this},finalize:function(h){h&&this._append(h);var _=this._doFinalize();return _},blockSize:512/32,_createHelper:function(h){return function(_,w){return new h.init(w).finalize(_)}},_createHmacHelper:function(h){return function(_,w){return new T.HMAC.init(h,w).finalize(_)}}}),T=o.algo={};return o})(Math);return t})});var Hi=nt((Pt,Bi)=>{"use strict";(function(t,e){typeof Pt=="object"?Bi.exports=Pt=e(ot()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Pt,function(t){return(function(e){var r=t,i=r.lib,s=i.WordArray,n=i.Hasher,o=r.algo,a=[],d=[];(function(){function f(A){for(var T=e.sqrt(A),h=2;h<=T;h++)if(!(A%h))return!1;return!0}function m(A){return(A-(A|0))*4294967296|0}for(var g=2,y=0;y<64;)f(g)&&(y<8&&(a[y]=m(e.pow(g,1/2))),d[y]=m(e.pow(g,1/3)),y++),g++})();var c=[],p=o.SHA256=n.extend({_doReset:function(){this._hash=new s.init(a.slice(0))},_doProcessBlock:function(f,m){for(var g=this._hash.words,y=g[0],A=g[1],T=g[2],h=g[3],_=g[4],w=g[5],v=g[6],k=g[7],C=0;C<64;C++){if(C<16)c[C]=f[m+C]|0;else{var b=c[C-15],E=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,D=c[C-2],N=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;c[C]=E+c[C-7]+N+c[C-16]}var M=_&w^~_&v,B=y&A^y&T^A&T,Ie=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),st=(_<<26|_>>>6)^(_<<21|_>>>11)^(_<<7|_>>>25),ge=k+st+M+d[C]+c[C],Ne=Ie+B;k=v,v=w,w=_,_=h+ge|0,h=T,T=A,A=y,y=ge+Ne|0}g[0]=g[0]+y|0,g[1]=g[1]+A|0,g[2]=g[2]+T|0,g[3]=g[3]+h|0,g[4]=g[4]+_|0,g[5]=g[5]+w|0,g[6]=g[6]+v|0,g[7]=g[7]+k|0},_doFinalize:function(){var f=this._data,m=f.words,g=this._nDataBytes*8,y=f.sigBytes*8;return m[y>>>5]|=128<<24-y%32,m[(y+64>>>9<<4)+14]=e.floor(g/4294967296),m[(y+64>>>9<<4)+15]=g,f.sigBytes=m.length*4,this._process(),this._hash},clone:function(){var f=n.clone.call(this);return f._hash=this._hash.clone(),f}});r.SHA256=n._createHelper(p),r.HmacSHA256=n._createHmacHelper(p)})(Math),t.SHA256})});var Wi=nt((Mt,qi)=>{"use strict";(function(t,e){typeof Mt=="object"?qi.exports=Mt=e(ot()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Mt,function(t){return(function(){var e=t,r=e.lib,i=r.WordArray,s=e.enc,n=s.Base64={stringify:function(a){var d=a.words,c=a.sigBytes,p=this._map;a.clamp();for(var f=[],m=0;m<c;m+=3)for(var g=d[m>>>2]>>>24-m%4*8&255,y=d[m+1>>>2]>>>24-(m+1)%4*8&255,A=d[m+2>>>2]>>>24-(m+2)%4*8&255,T=g<<16|y<<8|A,h=0;h<4&&m+h*.75<c;h++)f.push(p.charAt(T>>>6*(3-h)&63));var _=p.charAt(64);if(_)for(;f.length%4;)f.push(_);return f.join("")},parse:function(a){var d=a.length,c=this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var f=0;f<c.length;f++)p[c.charCodeAt(f)]=f}var m=c.charAt(64);if(m){var g=a.indexOf(m);g!==-1&&(d=g)}return o(a,d,p)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(a,d,c){for(var p=[],f=0,m=0;m<d;m++)if(m%4){var g=c[a.charCodeAt(m-1)]<<m%4*2,y=c[a.charCodeAt(m)]>>>6-m%4*2,A=g|y;p[f>>>2]|=A<<24-f%4*8,f++}return i.create(p,f)}})(),t.enc.Base64})});var Gi=nt((Vt,$i)=>{"use strict";(function(t,e){typeof Vt=="object"?$i.exports=Vt=e(ot()):typeof define=="function"&&define.amd?define(["./core"],e):e(t.CryptoJS)})(Vt,function(t){return t.enc.Utf8})});function Ar(t){this.message=t}function Ga(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return(function(r){return decodeURIComponent(zi(r).replace(/(.)/g,function(i,s){var n=s.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))})(e)}catch{return zi(e)}}function Ot(t){this.message=t}function za(t,e){if(typeof t!="string")throw new Ot("Invalid token specified");var r=(e=e||{}).header===!0?0:1;try{return JSON.parse(Ga(t.split(".")[r]))}catch(i){throw new Ot("Invalid token specified: "+i.message)}}var zi,Ut,kr=u(()=>{"use strict";Ar.prototype=new Error,Ar.prototype.name="InvalidCharacterError";zi=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Ar("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,s=0,n=0,o="";i=e.charAt(n++);~i&&(r=s%4?64*r+i:i,s++%4)?o+=String.fromCharCode(255&r>>(-2*s&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return o};Ot.prototype=new Error,Ot.prototype.name="InvalidTokenError";Ut=za});var Qi,Yi,Tr,Zi,Ja,ie,se,Re,x,Ka,ne,ye,Rr,Ji,z,Dr,Pr,De,Or,Xa,Qa,jt,Ur,Ya,Ft,Za,el,tl,rl,il,sl,Mr,nl,es,ol,Fe,Nr,al,ll,Ir,dl,cl,ul,hl,pl,fl,gl,Nt,Ki,ts,rs,is,ml,_l,ss,vl,Vr,yl,wl,bl,Xi,xl,Sl,Cl,El,Al,ns,Lt=u(()=>{"use strict";Qi=kt(ot(),1),Yi=kt(Hi(),1),Tr=kt(Wi(),1),Zi=kt(Gi(),1);kr();Ja={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},Re=(t=>(t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t))(Re||{});(t=>{function e(){ie=3,se=Ja}t.reset=e;function r(s){if(!(0<=s&&s<=4))throw new Error("Invalid log level");ie=s}t.setLevel=r;function i(s){se=s}t.setLogger=i})(Re||(Re={}));x=class{constructor(t){this._name=t}debug(...t){ie>=4&&se.debug(x._format(this._name,this._method),...t)}info(...t){ie>=3&&se.info(x._format(this._name,this._method),...t)}warn(...t){ie>=2&&se.warn(x._format(this._name,this._method),...t)}error(...t){ie>=1&&se.error(x._format(this._name,this._method),...t)}throw(t){throw this.error(t),t}create(t){let e=Object.create(this);return e._method=t,e.debug("begin"),e}static createStatic(t,e){let r=new x(`${t}.${e}`);return r.debug("begin"),r}static _format(t,e){let r=`[${t}]`;return e?`${r} ${e}:`:r}static debug(t,...e){ie>=4&&se.debug(x._format(t),...e)}static info(t,...e){ie>=3&&se.info(x._format(t),...e)}static warn(t,...e){ie>=2&&se.warn(x._format(t),...e)}static error(t,...e){ie>=1&&se.error(x._format(t),...e)}};Re.reset();Ka="10000000-1000-4000-8000-100000000000",ne=class{static _randomWord(){return Qi.default.lib.WordArray.random(1).words[0]}static generateUUIDv4(){return Ka.replace(/[018]/g,e=>(+e^ne._randomWord()&15>>+e/4).toString(16)).replace(/-/g,"")}static generateCodeVerifier(){return ne.generateUUIDv4()+ne.generateUUIDv4()+ne.generateUUIDv4()}static generateCodeChallenge(t){try{let e=(0,Yi.default)(t);return Tr.default.stringify(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(e){throw x.error("CryptoUtils.generateCodeChallenge",e),e}}static generateBasicAuth(t,e){let r=Zi.default.parse([t,e].join(":"));return Tr.default.stringify(r)}},ye=class{constructor(t){this._name=t,this._logger=new x(`Event('${this._name}')`),this._callbacks=[]}addHandler(t){return this._callbacks.push(t),()=>this.removeHandler(t)}removeHandler(t){let e=this._callbacks.lastIndexOf(t);e>=0&&this._callbacks.splice(e,1)}raise(...t){this._logger.debug("raise:",...t);for(let e of this._callbacks)e(...t)}},Rr=class{static decode(t){try{return Ut(t)}catch(e){throw x.error("JwtUtils.decode",e),e}}},Ji=class{static center(e){var t=P(e,[]);var r,i,s;return t.width==null&&(t.width=(r=[800,720,600,480].find(n=>n<=window.outerWidth/1.618))!=null?r:360),(i=t.left)!=null||(t.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-t.width)/2))),t.height!=null&&((s=t.top)!=null||(t.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-t.height)/2)))),t}static serialize(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e}=${typeof r!="boolean"?r:r?"yes":"no"}`).join(",")}},z=class extends ye{constructor(){super(...arguments),this._logger=new x(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{let t=this._expiration-z.getEpochTime();this._logger.debug("timer completes in",t),this._expiration<=z.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(t){let e=this._logger.create("init");t=Math.max(Math.floor(t),1);let r=z.getEpochTime()+t;if(this.expiration===r&&this._timerHandle){e.debug("skipping since already initialized for expiration at",this.expiration);return}this.cancel(),e.debug("using duration",t),this._expiration=r;let i=Math.min(t,5);this._timerHandle=setInterval(this._callback,i*1e3)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},Dr=class{static readParams(t,e="query"){if(!t)throw new TypeError("Invalid URL");let i=new URL(t,"http://127.0.0.1")[e==="fragment"?"hash":"search"];return new URLSearchParams(i.slice(1))}},Pr=";",De=class extends Error{constructor(t,e){var r,i,s;if(super(t.error_description||t.error||""),this.form=e,this.name="ErrorResponse",!t.error)throw x.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=t.error,this.error_description=(r=t.error_description)!=null?r:null,this.error_uri=(i=t.error_uri)!=null?i:null,this.state=t.userState,this.session_state=(s=t.session_state)!=null?s:null,this.url_state=t.url_state}},Or=class extends Error{constructor(t){super(t),this.name="ErrorTimeout"}},Xa=class{constructor(t){this._logger=new x("AccessTokenEvents"),this._expiringTimer=new z("Access token expiring"),this._expiredTimer=new z("Access token expired"),this._expiringNotificationTimeInSeconds=t.expiringNotificationTimeInSeconds}load(t){let e=this._logger.create("load");if(t.access_token&&t.expires_in!==void 0){let r=t.expires_in;if(e.debug("access token present, remaining duration:",r),r>0){let s=r-this._expiringNotificationTimeInSeconds;s<=0&&(s=1),e.debug("registering expiring timer, raising in",s,"seconds"),this._expiringTimer.init(s)}else e.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();let i=r+1;e.debug("registering expired timer, raising in",i,"seconds"),this._expiredTimer.init(i)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(t){return this._expiringTimer.addHandler(t)}removeAccessTokenExpiring(t){this._expiringTimer.removeHandler(t)}addAccessTokenExpired(t){return this._expiredTimer.addHandler(t)}removeAccessTokenExpired(t){this._expiredTimer.removeHandler(t)}},Qa=class{constructor(t,e,r,i,s){this._callback=t,this._client_id=e,this._intervalInSeconds=i,this._stopOnError=s,this._logger=new x("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=o=>{o.origin===this._frame_origin&&o.source===this._frame.contentWindow&&(o.data==="error"?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):o.data==="changed"?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(o.data+" message from check session op iframe"))};let n=new URL(r);this._frame_origin=n.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=n.href}load(){return new Promise(t=>{this._frame.onload=()=>{t()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)})}start(t){if(this._session_state===t)return;this._logger.create("start"),this.stop(),this._session_state=t;let e=()=>{!this._frame.contentWindow||!this._session_state||this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};e(),this._timer=setInterval(e,this._intervalInSeconds*1e3)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},jt=class{constructor(){this._logger=new x("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(t){return this._logger.create(`getItem('${t}')`),this._data[t]}setItem(t,e){this._logger.create(`setItem('${t}')`),this._data[t]=e}removeItem(t){this._logger.create(`removeItem('${t}')`),delete this._data[t]}get length(){return Object.getOwnPropertyNames(this._data).length}key(t){return Object.getOwnPropertyNames(this._data)[t]}},Ur=class{constructor(t=[],e=null,r={}){this._jwtHandler=e,this._extraHeaders=r,this._logger=new x("JsonService"),this._contentTypes=[],this._contentTypes.push(...t,"application/json"),e&&this._contentTypes.push("application/jwt")}fetchWithTimeout(r){return l(this,arguments,function*(t,e={}){let a=e,{timeoutInSeconds:i}=a,s=P(a,["timeoutInSeconds"]);if(!i)return yield fetch(t,s);let n=new AbortController,o=setTimeout(()=>n.abort(),i*1e3);try{return yield fetch(t,H(S({},e),{signal:n.signal}))}catch(d){throw d instanceof DOMException&&d.name==="AbortError"?new Or("Network timed out"):d}finally{clearTimeout(o)}})}getJson(i){return l(this,arguments,function*(t,{token:e,credentials:r}={}){let s=this._logger.create("getJson"),n={Accept:this._contentTypes.join(", ")};e&&(s.debug("token passed, setting Authorization header"),n.Authorization="Bearer "+e),this.appendExtraHeaders(n);let o;try{s.debug("url:",t),o=yield this.fetchWithTimeout(t,{method:"GET",headers:n,credentials:r})}catch(c){throw s.error("Network Error"),c}s.debug("HTTP response received, status",o.status);let a=o.headers.get("Content-Type");if(a&&!this._contentTypes.find(c=>a.startsWith(c))&&s.throw(new Error(`Invalid response Content-Type: ${a??"undefined"}, from URL: ${t}`)),o.ok&&this._jwtHandler&&a?.startsWith("application/jwt"))return yield this._jwtHandler(yield o.text());let d;try{d=yield o.json()}catch(c){throw s.error("Error parsing JSON response",c),o.ok?c:new Error(`${o.statusText} (${o.status})`)}if(!o.ok)throw s.error("Error from server:",d),d.error?new De(d):new Error(`${o.statusText} (${o.status}): ${JSON.stringify(d)}`);return d})}postForm(n,o){return l(this,arguments,function*(t,{body:e,basicAuth:r,timeoutInSeconds:i,initCredentials:s}){let a=this._logger.create("postForm"),d={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};r!==void 0&&(d.Authorization="Basic "+r),this.appendExtraHeaders(d);let c;try{a.debug("url:",t),c=yield this.fetchWithTimeout(t,{method:"POST",headers:d,body:e,timeoutInSeconds:i,credentials:s})}catch(g){throw a.error("Network error"),g}a.debug("HTTP response received, status",c.status);let p=c.headers.get("Content-Type");if(p&&!this._contentTypes.find(g=>p.startsWith(g)))throw new Error(`Invalid response Content-Type: ${p??"undefined"}, from URL: ${t}`);let f=yield c.text(),m={};if(f)try{m=JSON.parse(f)}catch(g){throw a.error("Error parsing JSON response",g),c.ok?g:new Error(`${c.statusText} (${c.status})`)}if(!c.ok)throw a.error("Error from server:",m),m.error?new De(m,e):new Error(`${c.statusText} (${c.status}): ${JSON.stringify(m)}`);return m})}appendExtraHeaders(t){let e=this._logger.create("appendExtraHeaders"),r=Object.keys(this._extraHeaders),i=["authorization","accept","content-type"];r.length!==0&&r.forEach(s=>{if(i.includes(s.toLocaleLowerCase())){e.warn("Protected header could not be overridden",s,i);return}let n=typeof this._extraHeaders[s]=="function"?this._extraHeaders[s]():this._extraHeaders[s];n&&n!==""&&(t[s]=n)})}},Ya=class{constructor(t){this._settings=t,this._logger=new x("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new Ur(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}getMetadata(){return l(this,null,function*(){let t=this._logger.create("getMetadata");if(this._metadata)return t.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw t.throw(new Error("No authority or metadataUrl configured on settings")),null;t.debug("getting metadata from",this._metadataUrl);let e=yield this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return t.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,e),this._metadata})}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(t=!0){return this._getMetadataProperty("token_endpoint",t)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(t=!0){return this._getMetadataProperty("revocation_endpoint",t)}getKeysEndpoint(t=!0){return this._getMetadataProperty("jwks_uri",t)}_getMetadataProperty(t,e=!1){return l(this,null,function*(){let r=this._logger.create(`_getMetadataProperty('${t}')`),i=yield this.getMetadata();if(r.debug("resolved"),i[t]===void 0){if(e===!0){r.warn("Metadata does not contain optional property");return}r.throw(new Error("Metadata does not contain property "+t))}return i[t]})}getSigningKeys(){return l(this,null,function*(){let t=this._logger.create("getSigningKeys");if(this._signingKeys)return t.debug("returning signingKeys from cache"),this._signingKeys;let e=yield this.getKeysEndpoint(!1);t.debug("got jwks_uri",e);let r=yield this._jsonService.getJson(e);if(t.debug("got key set",r),!Array.isArray(r.keys))throw t.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys})}},Ft=class{constructor({prefix:t="oidc.",store:e=localStorage}={}){this._logger=new x("WebStorageStateStore"),this._store=e,this._prefix=t}set(t,e){return l(this,null,function*(){this._logger.create(`set('${t}')`),t=this._prefix+t,yield this._store.setItem(t,e)})}get(t){return l(this,null,function*(){return this._logger.create(`get('${t}')`),t=this._prefix+t,yield this._store.getItem(t)})}remove(t){return l(this,null,function*(){this._logger.create(`remove('${t}')`),t=this._prefix+t;let e=yield this._store.getItem(t);return yield this._store.removeItem(t),e})}getAllKeys(){return l(this,null,function*(){this._logger.create("getAllKeys");let t=yield this._store.length,e=[];for(let r=0;r<t;r++){let i=yield this._store.key(r);i&&i.indexOf(this._prefix)===0&&e.push(i.substr(this._prefix.length))}return e})}},Za="code",el="openid",tl="client_secret_post",rl="query",il=900,sl=300,Mr=class{constructor({authority:t,metadataUrl:e,metadata:r,signingKeys:i,metadataSeed:s,client_id:n,client_secret:o,response_type:a=Za,scope:d=el,redirect_uri:c,post_logout_redirect_uri:p,client_authentication:f=tl,prompt:m,display:g,max_age:y,ui_locales:A,acr_values:T,resource:h,response_mode:_=rl,filterProtocolClaims:w=!0,loadUserInfo:v=!1,staleStateAgeInSeconds:k=il,clockSkewInSeconds:C=sl,userInfoJwtIssuer:b="OP",mergeClaims:E=!1,disablePKCE:D=!1,stateStore:N,refreshTokenCredentials:M,revokeTokenAdditionalContentTypes:B,fetchRequestCredentials:Ie,refreshTokenAllowedScope:st,extraQueryParams:ge={},extraTokenParams:Ne={},extraHeaders:Ct={}}){if(this.authority=t,e?this.metadataUrl=e:(this.metadataUrl=t,t&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=s,this.signingKeys=i,this.client_id=n,this.client_secret=o,this.response_type=a,this.scope=d,this.redirect_uri=c,this.post_logout_redirect_uri=p,this.client_authentication=f,this.prompt=m,this.display=g,this.max_age=y,this.ui_locales=A,this.acr_values=T,this.resource=h,this.response_mode=_,this.filterProtocolClaims=w??!0,this.loadUserInfo=!!v,this.staleStateAgeInSeconds=k,this.clockSkewInSeconds=C,this.userInfoJwtIssuer=b,this.mergeClaims=!!E,this.disablePKCE=!!D,this.revokeTokenAdditionalContentTypes=B,Ie&&M&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=Ie||M||"same-origin",N)this.stateStore=N;else{let gr=typeof window<"u"?window.localStorage:new jt;this.stateStore=new Ft({store:gr})}this.refreshTokenAllowedScope=st,this.extraQueryParams=ge,this.extraTokenParams=Ne,this.extraHeaders=Ct}},nl=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new x("UserInfoService"),this._getClaimsFromJwt=r=>l(this,null,function*(){let i=this._logger.create("_getClaimsFromJwt");try{let s=Rr.decode(r);return i.debug("JWT decoding successful"),s}catch(s){throw i.error("Error parsing JWT response"),s}}),this._jsonService=new Ur(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}getClaims(t){return l(this,null,function*(){let e=this._logger.create("getClaims");t||this._logger.throw(new Error("No token passed"));let r=yield this._metadataService.getUserInfoEndpoint();e.debug("got userinfo url",r);let i=yield this._jsonService.getJson(r,{token:t,credentials:this._settings.fetchRequestCredentials});return e.debug("got claims",i),i})}},es=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new x("TokenClient"),this._jsonService=new Ur(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}exchangeCode(n){return l(this,null,function*(){var o=n,{grant_type:t="authorization_code",redirect_uri:e=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:i=this._settings.client_secret}=o,s=P(o,["grant_type","redirect_uri","client_id","client_secret"]);let a=this._logger.create("exchangeCode");r||a.throw(new Error("A client_id is required")),e||a.throw(new Error("A redirect_uri is required")),s.code||a.throw(new Error("A code is required"));let d=new URLSearchParams({grant_type:t,redirect_uri:e});for(let[m,g]of Object.entries(s))g!=null&&d.set(m,g);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!i)throw a.throw(new Error("A client_secret is required")),null;c=ne.generateBasicAuth(r,i);break;case"client_secret_post":d.append("client_id",r),i&&d.append("client_secret",i);break}let p=yield this._metadataService.getTokenEndpoint(!1);a.debug("got token endpoint");let f=yield this._jsonService.postForm(p,{body:d,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return a.debug("got response"),f})}exchangeCredentials(n){return l(this,null,function*(){var o=n,{grant_type:t="password",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:i=this._settings.scope}=o,s=P(o,["grant_type","client_id","client_secret","scope"]);let a=this._logger.create("exchangeCredentials");e||a.throw(new Error("A client_id is required"));let d=new URLSearchParams({grant_type:t,scope:i});for(let[m,g]of Object.entries(s))g!=null&&d.set(m,g);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw a.throw(new Error("A client_secret is required")),null;c=ne.generateBasicAuth(e,r);break;case"client_secret_post":d.append("client_id",e),r&&d.append("client_secret",r);break}let p=yield this._metadataService.getTokenEndpoint(!1);a.debug("got token endpoint");let f=yield this._jsonService.postForm(p,{body:d,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return a.debug("got response"),f})}exchangeRefreshToken(n){return l(this,null,function*(){var o=n,{grant_type:t="refresh_token",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:i}=o,s=P(o,["grant_type","client_id","client_secret","timeoutInSeconds"]);let a=this._logger.create("exchangeRefreshToken");e||a.throw(new Error("A client_id is required")),s.refresh_token||a.throw(new Error("A refresh_token is required"));let d=new URLSearchParams({grant_type:t});for(let[m,g]of Object.entries(s))Array.isArray(g)?g.forEach(y=>d.append(m,y)):g!=null&&d.set(m,g);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw a.throw(new Error("A client_secret is required")),null;c=ne.generateBasicAuth(e,r);break;case"client_secret_post":d.append("client_id",e),r&&d.append("client_secret",r);break}let p=yield this._metadataService.getTokenEndpoint(!1);a.debug("got token endpoint");let f=yield this._jsonService.postForm(p,{body:d,basicAuth:c,timeoutInSeconds:i,initCredentials:this._settings.fetchRequestCredentials});return a.debug("got response"),f})}revoke(t){return l(this,null,function*(){var e;let r=this._logger.create("revoke");t.token||r.throw(new Error("A token is required"));let i=yield this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${(e=t.token_type_hint)!=null?e:"default token type"}`);let s=new URLSearchParams;for(let[n,o]of Object.entries(t))o!=null&&s.set(n,o);s.set("client_id",this._settings.client_id),this._settings.client_secret&&s.set("client_secret",this._settings.client_secret),yield this._jsonService.postForm(i,{body:s}),r.debug("got response")})}},ol=class{constructor(t,e,r){this._settings=t,this._metadataService=e,this._claimsService=r,this._logger=new x("ResponseValidator"),this._userInfoService=new nl(this._settings,this._metadataService),this._tokenClient=new es(this._settings,this._metadataService)}validateSigninResponse(t,e){return l(this,null,function*(){let r=this._logger.create("validateSigninResponse");this._processSigninState(t,e),r.debug("state processed"),yield this._processCode(t,e),r.debug("code processed"),t.isOpenId&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),yield this._processClaims(t,e?.skipUserInfo,t.isOpenId),r.debug("claims processed")})}validateCredentialsResponse(t,e){return l(this,null,function*(){let r=this._logger.create("validateCredentialsResponse");t.isOpenId&&t.id_token&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),yield this._processClaims(t,e,t.isOpenId),r.debug("claims processed")})}validateRefreshResponse(t,e){return l(this,null,function*(){var r,i;let s=this._logger.create("validateRefreshResponse");t.userState=e.data,(r=t.session_state)!=null||(t.session_state=e.session_state),(i=t.scope)!=null||(t.scope=e.scope),t.isOpenId&&t.id_token&&(this._validateIdTokenAttributes(t,e.id_token),s.debug("ID Token validated")),t.id_token||(t.id_token=e.id_token,t.profile=e.profile);let n=t.isOpenId&&!!t.id_token;yield this._processClaims(t,!1,n),s.debug("claims processed")})}validateSignoutResponse(t,e){let r=this._logger.create("validateSignoutResponse");if(e.id!==t.state&&r.throw(new Error("State does not match")),r.debug("state validated"),t.userState=e.data,t.error)throw r.warn("Response was error",t.error),new De(t)}_processSigninState(t,e){var r;let i=this._logger.create("_processSigninState");if(e.id!==t.state&&i.throw(new Error("State does not match")),e.client_id||i.throw(new Error("No client_id on state")),e.authority||i.throw(new Error("No authority on state")),this._settings.authority!==e.authority&&i.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==e.client_id&&i.throw(new Error("client_id mismatch on settings vs. signin state")),i.debug("state validated"),t.userState=e.data,t.url_state=e.url_state,(r=t.scope)!=null||(t.scope=e.scope),t.error)throw i.warn("Response was error",t.error),new De(t);e.code_verifier&&!t.code&&i.throw(new Error("Expected code in response"))}_processClaims(t,e=!1,r=!0){return l(this,null,function*(){let i=this._logger.create("_processClaims");if(t.profile=this._claimsService.filterProtocolClaims(t.profile),e||!this._settings.loadUserInfo||!t.access_token){i.debug("not loading user info");return}i.debug("loading user info");let s=yield this._userInfoService.getClaims(t.access_token);i.debug("user info claims received from user info endpoint"),r&&s.sub!==t.profile.sub&&i.throw(new Error("subject from UserInfo response does not match subject in ID Token")),t.profile=this._claimsService.mergeClaims(t.profile,this._claimsService.filterProtocolClaims(s)),i.debug("user info claims received, updated profile:",t.profile)})}_processCode(t,e){return l(this,null,function*(){let r=this._logger.create("_processCode");if(t.code){r.debug("Validating code");let i=yield this._tokenClient.exchangeCode(S({client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier},e.extraTokenParams));Object.assign(t,i)}else r.debug("No code to process")})}_validateIdTokenAttributes(t,e){var r;let i=this._logger.create("_validateIdTokenAttributes");i.debug("decoding ID Token JWT");let s=Rr.decode((r=t.id_token)!=null?r:"");if(s.sub||i.throw(new Error("ID Token is missing a subject claim")),e){let n=Rr.decode(e);s.sub!==n.sub&&i.throw(new Error("sub in id_token does not match current sub")),s.auth_time&&s.auth_time!==n.auth_time&&i.throw(new Error("auth_time in id_token does not match original auth_time")),s.azp&&s.azp!==n.azp&&i.throw(new Error("azp in id_token does not match original azp")),!s.azp&&n.azp&&i.throw(new Error("azp not in id_token, but present in original id_token"))}t.profile=s}},Fe=class{constructor(t){this.id=t.id||ne.generateUUIDv4(),this.data=t.data,t.created&&t.created>0?this.created=t.created:this.created=z.getEpochTime(),this.request_type=t.request_type,this.url_state=t.url_state}toStorageString(){return new x("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(t){return x.createStatic("State","fromStorageString"),new Fe(JSON.parse(t))}static clearStaleState(t,e){return l(this,null,function*(){let r=x.createStatic("State","clearStaleState"),i=z.getEpochTime()-e,s=yield t.getAllKeys();r.debug("got keys",s);for(let n=0;n<s.length;n++){let o=s[n],a=yield t.get(o),d=!1;if(a)try{let c=Fe.fromStorageString(a);r.debug("got item from key:",o,c.created),c.created<=i&&(d=!0)}catch(c){r.error("Error parsing state for key:",o,c),d=!0}else r.debug("no item in storage for key:",o),d=!0;d&&(r.debug("removed item for key:",o),t.remove(o))}})}},Nr=class extends Fe{constructor(t){super(t),t.code_verifier===!0?this.code_verifier=ne.generateCodeVerifier():t.code_verifier&&(this.code_verifier=t.code_verifier),this.code_verifier&&(this.code_challenge=ne.generateCodeChallenge(this.code_verifier)),this.authority=t.authority,this.client_id=t.client_id,this.redirect_uri=t.redirect_uri,this.scope=t.scope,this.client_secret=t.client_secret,this.extraTokenParams=t.extraTokenParams,this.response_mode=t.response_mode,this.skipUserInfo=t.skipUserInfo}toStorageString(){return new x("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(t){x.createStatic("SigninState","fromStorageString");let e=JSON.parse(t);return new Nr(e)}},al=class{constructor(_){var w=_,{url:t,authority:e,client_id:r,redirect_uri:i,response_type:s,scope:n,state_data:o,response_mode:a,request_type:d,client_secret:c,nonce:p,url_state:f,resource:m,skipUserInfo:g,extraQueryParams:y,extraTokenParams:A,disablePKCE:T}=w,h=P(w,["url","authority","client_id","redirect_uri","response_type","scope","state_data","response_mode","request_type","client_secret","nonce","url_state","resource","skipUserInfo","extraQueryParams","extraTokenParams","disablePKCE"]);if(this._logger=new x("SigninRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!i)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!s)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!n)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!e)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new Nr({data:o,request_type:d,url_state:f,code_verifier:!T,client_id:r,authority:e,redirect_uri:i,response_mode:a,client_secret:c,scope:n,extraTokenParams:A,skipUserInfo:g});let v=new URL(t);v.searchParams.append("client_id",r),v.searchParams.append("redirect_uri",i),v.searchParams.append("response_type",s),v.searchParams.append("scope",n),p&&v.searchParams.append("nonce",p);let k=this.state.id;f&&(k=`${k}${Pr}${f}`),v.searchParams.append("state",k),this.state.code_challenge&&(v.searchParams.append("code_challenge",this.state.code_challenge),v.searchParams.append("code_challenge_method","S256")),m&&(Array.isArray(m)?m:[m]).forEach(b=>v.searchParams.append("resource",b));for(let[C,b]of Object.entries(S(S({response_mode:a},h),y)))b!=null&&v.searchParams.append(C,b.toString());this.url=v.href}},ll="openid",Ir=class{constructor(t){if(this.access_token="",this.token_type="",this.profile={},this.state=t.get("state"),this.session_state=t.get("session_state"),this.state){let e=decodeURIComponent(this.state).split(Pr);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(Pr))}this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri"),this.code=t.get("code")}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-z.getEpochTime()}set expires_in(t){typeof t=="string"&&(t=Number(t)),t!==void 0&&t>=0&&(this.expires_at=Math.floor(t)+z.getEpochTime())}get isOpenId(){var t;return((t=this.scope)==null?void 0:t.split(" ").includes(ll))||!!this.id_token}},dl=class{constructor({url:t,state_data:e,id_token_hint:r,post_logout_redirect_uri:i,extraQueryParams:s,request_type:n,client_id:o}){if(this._logger=new x("SignoutRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");let a=new URL(t);r&&a.searchParams.append("id_token_hint",r),o&&a.searchParams.append("client_id",o),i&&(a.searchParams.append("post_logout_redirect_uri",i),e&&(this.state=new Fe({data:e,request_type:n}),a.searchParams.append("state",this.state.id)));for(let[d,c]of Object.entries(S({},s)))c!=null&&a.searchParams.append(d,c.toString());this.url=a.href}},cl=class{constructor(t){this.state=t.get("state"),this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri")}},ul=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],hl=["sub","iss","aud","exp","iat"],pl=class{constructor(t){this._settings=t,this._logger=new x("ClaimsService")}filterProtocolClaims(t){let e=S({},t);if(this._settings.filterProtocolClaims){let r;Array.isArray(this._settings.filterProtocolClaims)?r=this._settings.filterProtocolClaims:r=ul;for(let i of r)hl.includes(i)||delete e[i]}return e}mergeClaims(t,e){let r=S({},t);for(let[i,s]of Object.entries(e))for(let n of Array.isArray(s)?s:[s]){let o=r[i];o===void 0?r[i]=n:Array.isArray(o)?o.includes(n)||o.push(n):r[i]!==n&&(typeof n=="object"&&this._settings.mergeClaims?r[i]=this.mergeClaims(o,n):r[i]=[o,n])}return r}},fl=class{constructor(t,e){this._logger=new x("OidcClient"),this.settings=t instanceof Mr?t:new Mr(t),this.metadataService=e??new Ya(this.settings),this._claimsService=new pl(this.settings),this._validator=new ol(this.settings,this.metadataService,this._claimsService),this._tokenClient=new es(this.settings,this.metadataService)}createSigninRequest(k){return l(this,arguments,function*({state:t,request:e,request_uri:r,request_type:i,id_token_hint:s,login_hint:n,skipUserInfo:o,nonce:a,url_state:d,response_type:c=this.settings.response_type,scope:p=this.settings.scope,redirect_uri:f=this.settings.redirect_uri,prompt:m=this.settings.prompt,display:g=this.settings.display,max_age:y=this.settings.max_age,ui_locales:A=this.settings.ui_locales,acr_values:T=this.settings.acr_values,resource:h=this.settings.resource,response_mode:_=this.settings.response_mode,extraQueryParams:w=this.settings.extraQueryParams,extraTokenParams:v=this.settings.extraTokenParams}){let C=this._logger.create("createSigninRequest");if(c!=="code")throw new Error("Only the Authorization Code flow (with PKCE) is supported");let b=yield this.metadataService.getAuthorizationEndpoint();C.debug("Received authorization endpoint",b);let E=new al({url:b,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:f,response_type:c,scope:p,state_data:t,url_state:d,prompt:m,display:g,max_age:y,ui_locales:A,id_token_hint:s,login_hint:n,acr_values:T,resource:h,request:e,request_uri:r,extraQueryParams:w,extraTokenParams:v,request_type:i,response_mode:_,client_secret:this.settings.client_secret,skipUserInfo:o,nonce:a,disablePKCE:this.settings.disablePKCE});yield this.clearStaleState();let D=E.state;return yield this.settings.stateStore.set(D.id,D.toStorageString()),E})}readSigninResponseState(t,e=!1){return l(this,null,function*(){let r=this._logger.create("readSigninResponseState"),i=new Ir(Dr.readParams(t,this.settings.response_mode));if(!i.state)throw r.throw(new Error("No state in response")),null;let s=yield this.settings.stateStore[e?"remove":"get"](i.state);if(!s)throw r.throw(new Error("No matching state found in storage")),null;return{state:Nr.fromStorageString(s),response:i}})}processSigninResponse(t){return l(this,null,function*(){let e=this._logger.create("processSigninResponse"),{state:r,response:i}=yield this.readSigninResponseState(t,!0);return e.debug("received state from storage; validating response"),yield this._validator.validateSigninResponse(i,r),i})}processResourceOwnerPasswordCredentials(s){return l(this,arguments,function*({username:t,password:e,skipUserInfo:r=!1,extraTokenParams:i={}}){let n=yield this._tokenClient.exchangeCredentials(S({username:t,password:e},i)),o=new Ir(new URLSearchParams);return Object.assign(o,n),yield this._validator.validateCredentialsResponse(o,r),o})}useRefreshToken(r){return l(this,arguments,function*({state:t,timeoutInSeconds:e}){var i;let s=this._logger.create("useRefreshToken"),n;if(this.settings.refreshTokenAllowedScope===void 0)n=t.scope;else{let d=this.settings.refreshTokenAllowedScope.split(" ");n=(((i=t.scope)==null?void 0:i.split(" "))||[]).filter(p=>d.includes(p)).join(" ")}let o=yield this._tokenClient.exchangeRefreshToken({refresh_token:t.refresh_token,resource:t.resource,scope:n,timeoutInSeconds:e}),a=new Ir(new URLSearchParams);return Object.assign(a,o),s.debug("validating response",a),yield this._validator.validateRefreshResponse(a,H(S({},t),{scope:n})),a})}createSignoutRequest(){return l(this,arguments,function*({state:t,id_token_hint:e,client_id:r,request_type:i,post_logout_redirect_uri:s=this.settings.post_logout_redirect_uri,extraQueryParams:n=this.settings.extraQueryParams}={}){let o=this._logger.create("createSignoutRequest"),a=yield this.metadataService.getEndSessionEndpoint();if(!a)throw o.throw(new Error("No end session endpoint")),null;o.debug("Received end session endpoint",a),!r&&s&&!e&&(r=this.settings.client_id);let d=new dl({url:a,id_token_hint:e,client_id:r,post_logout_redirect_uri:s,state_data:t,extraQueryParams:n,request_type:i});yield this.clearStaleState();let c=d.state;return c&&(o.debug("Signout request has state to persist"),yield this.settings.stateStore.set(c.id,c.toStorageString())),d})}readSignoutResponseState(t,e=!1){return l(this,null,function*(){let r=this._logger.create("readSignoutResponseState"),i=new cl(Dr.readParams(t,this.settings.response_mode));if(!i.state){if(r.debug("No state in response"),i.error)throw r.warn("Response was error:",i.error),new De(i);return{state:void 0,response:i}}let s=yield this.settings.stateStore[e?"remove":"get"](i.state);if(!s)throw r.throw(new Error("No matching state found in storage")),null;return{state:Fe.fromStorageString(s),response:i}})}processSignoutResponse(t){return l(this,null,function*(){let e=this._logger.create("processSignoutResponse"),{state:r,response:i}=yield this.readSignoutResponseState(t,!0);return r?(e.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(i,r)):e.debug("No state from storage; skipping response validation"),i})}clearStaleState(){return this._logger.create("clearStaleState"),Fe.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}revokeToken(t,e){return l(this,null,function*(){return this._logger.create("revokeToken"),yield this._tokenClient.revoke({token:t,token_type_hint:e})})}},gl=class{constructor(t){this._userManager=t,this._logger=new x("SessionMonitor"),this._start=e=>l(this,null,function*(){let r=e.session_state;if(!r)return;let i=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,i.debug("session_state",r,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,i.debug("session_state",r,", anonymous user")),this._checkSessionIFrame){this._checkSessionIFrame.start(r);return}try{let s=yield this._userManager.metadataService.getCheckSessionIframe();if(s){i.debug("initializing check session iframe");let n=this._userManager.settings.client_id,o=this._userManager.settings.checkSessionIntervalInSeconds,a=this._userManager.settings.stopCheckSessionOnError,d=new Qa(this._callback,n,s,o,a);yield d.load(),this._checkSessionIFrame=d,d.start(r)}else i.warn("no check session iframe found in the metadata")}catch(s){i.error("Error from getCheckSessionIframe:",s instanceof Error?s.message:s)}}),this._stop=()=>{let e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){let r=setInterval(()=>l(this,null,function*(){clearInterval(r);try{let i=yield this._userManager.querySessionStatus();if(i){let s={session_state:i.session_state,profile:i.sub&&i.sid?{sub:i.sub,sid:i.sid}:null};this._start(s)}}catch(i){e.error("error from querySessionStatus",i instanceof Error?i.message:i)}}),1e3)}},this._callback=()=>l(this,null,function*(){let e=this._logger.create("_callback");try{let r=yield this._userManager.querySessionStatus(),i=!0;r&&this._checkSessionIFrame?r.sub===this._sub?(i=!1,this._checkSessionIFrame.start(r.session_state),r.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",r.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",r.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",r.sub):e.debug("subject no longer signed into OP"),i?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(r){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",r),this._userManager.events._raiseUserSignedOut())}}),t||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch(e=>{this._logger.error(e)})}_init(){return l(this,null,function*(){this._logger.create("_init");let t=yield this._userManager.getUser();if(t)this._start(t);else if(this._userManager.settings.monitorAnonymousSession){let e=yield this._userManager.querySessionStatus();if(e){let r={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(r)}}})}},Nt=class{constructor(t){var e;this.id_token=t.id_token,this.session_state=(e=t.session_state)!=null?e:null,this.access_token=t.access_token,this.refresh_token=t.refresh_token,this.token_type=t.token_type,this.scope=t.scope,this.profile=t.profile,this.expires_at=t.expires_at,this.state=t.userState,this.url_state=t.url_state}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-z.getEpochTime()}set expires_in(t){t!==void 0&&(this.expires_at=Math.floor(t)+z.getEpochTime())}get expired(){let t=this.expires_in;if(t!==void 0)return t<=0}get scopes(){var t,e;return(e=(t=this.scope)==null?void 0:t.split(" "))!=null?e:[]}toStorageString(){return new x("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(t){return x.createStatic("User","fromStorageString"),new Nt(JSON.parse(t))}},Ki="oidc-client",ts=class{constructor(){this._abort=new ye("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}navigate(t){return l(this,null,function*(){let e=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");e.debug("setting URL in window"),this._window.location.replace(t.url);let{url:r,keepOpen:i}=yield new Promise((s,n)=>{let o=a=>{var d;let c=a.data,p=(d=t.scriptOrigin)!=null?d:window.location.origin;if(!(a.origin!==p||c?.source!==Ki)){try{let f=Dr.readParams(c.url,t.response_mode).get("state");if(f||e.warn("no state found in response url"),a.source!==this._window&&f!==t.state)return}catch{this._dispose(),n(new Error("Invalid response from window"))}s(c)}};window.addEventListener("message",o,!1),this._disposeHandlers.add(()=>window.removeEventListener("message",o,!1)),this._disposeHandlers.add(this._abort.addHandler(a=>{this._dispose(),n(a)}))});return e.debug("got response from window"),this._dispose(),i||this.close(),{url:r}})}_dispose(){this._logger.create("_dispose");for(let t of this._disposeHandlers)t();this._disposeHandlers.clear()}static _notifyParent(t,e,r=!1,i=window.location.origin){t.postMessage({source:Ki,url:e,keepOpen:r},i)}},rs={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},is="_blank",ml=60,_l=2,ss=10,vl=class extends Mr{constructor(t){let{popup_redirect_uri:e=t.redirect_uri,popup_post_logout_redirect_uri:r=t.post_logout_redirect_uri,popupWindowFeatures:i=rs,popupWindowTarget:s=is,redirectMethod:n="assign",redirectTarget:o="self",iframeNotifyParentOrigin:a=t.iframeNotifyParentOrigin,iframeScriptOrigin:d=t.iframeScriptOrigin,silent_redirect_uri:c=t.redirect_uri,silentRequestTimeoutInSeconds:p=ss,automaticSilentRenew:f=!0,validateSubOnSilentRenew:m=!0,includeIdTokenInSilentRenew:g=!1,monitorSession:y=!1,monitorAnonymousSession:A=!1,checkSessionIntervalInSeconds:T=_l,query_status_response_type:h="code",stopCheckSessionOnError:_=!0,revokeTokenTypes:w=["access_token","refresh_token"],revokeTokensOnSignout:v=!1,includeIdTokenInSilentSignout:k=!1,accessTokenExpiringNotificationTimeInSeconds:C=ml,userStore:b}=t;if(super(t),this.popup_redirect_uri=e,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=i,this.popupWindowTarget=s,this.redirectMethod=n,this.redirectTarget=o,this.iframeNotifyParentOrigin=a,this.iframeScriptOrigin=d,this.silent_redirect_uri=c,this.silentRequestTimeoutInSeconds=p,this.automaticSilentRenew=f,this.validateSubOnSilentRenew=m,this.includeIdTokenInSilentRenew=g,this.monitorSession=y,this.monitorAnonymousSession=A,this.checkSessionIntervalInSeconds=T,this.stopCheckSessionOnError=_,this.query_status_response_type=h,this.revokeTokenTypes=w,this.revokeTokensOnSignout=v,this.includeIdTokenInSilentSignout=k,this.accessTokenExpiringNotificationTimeInSeconds=C,b)this.userStore=b;else{let E=typeof window<"u"?window.sessionStorage:new jt;this.userStore=new Ft({store:E})}}},Vr=class t extends ts{constructor({silentRequestTimeoutInSeconds:e=ss}){super(),this._logger=new x("IFrameWindow"),this._timeoutInSeconds=e,this._frame=Vr.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){let e=window.document.createElement("iframe");return e.style.visibility="hidden",e.style.position="fixed",e.style.left="-1000px",e.style.top="0",e.width="0",e.height="0",window.document.body.appendChild(e),e}navigate(e){return l(this,null,function*(){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);let r=setTimeout(()=>this._abort.raise(new Or("IFrame timed out without a response")),this._timeoutInSeconds*1e3);return this._disposeHandlers.add(()=>clearTimeout(r)),yield _r(t.prototype,this,"navigate").call(this,e)})}close(){var e;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",r=>{var i;let s=r.target;(i=s.parentNode)==null||i.removeChild(s),this._abort.raise(new Error("IFrame removed from DOM"))},!0),(e=this._frame.contentWindow)==null||e.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(e,r){return super._notifyParent(window.parent,e,!1,r)}},yl=class{constructor(t){this._settings=t,this._logger=new x("IFrameNavigator")}prepare(e){return l(this,arguments,function*({silentRequestTimeoutInSeconds:t=this._settings.silentRequestTimeoutInSeconds}){return new Vr({silentRequestTimeoutInSeconds:t})})}callback(t){return l(this,null,function*(){this._logger.create("callback"),Vr.notifyParent(t,this._settings.iframeNotifyParentOrigin)})}},wl=500,bl=1e3,Xi=class t extends ts{constructor({popupWindowTarget:e=is,popupWindowFeatures:r={}}){super(),this._logger=new x("PopupWindow");let i=Ji.center(S(S({},rs),r));this._window=window.open(void 0,e,Ji.serialize(i)),r.closePopupWindowAfterInSeconds&&r.closePopupWindowAfterInSeconds>0&&setTimeout(()=>{if(!this._window||typeof this._window.closed!="boolean"||this._window.closed){this._abort.raise(new Error("Popup blocked by user"));return}this.close()},r.closePopupWindowAfterInSeconds*bl)}navigate(e){return l(this,null,function*(){var r;(r=this._window)==null||r.focus();let i=setInterval(()=>{(!this._window||this._window.closed)&&this._abort.raise(new Error("Popup closed by user"))},wl);return this._disposeHandlers.add(()=>clearInterval(i)),yield _r(t.prototype,this,"navigate").call(this,e)})}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(e,r){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,e,r)}},xl=class{constructor(t){this._settings=t,this._logger=new x("PopupNavigator")}prepare(r){return l(this,arguments,function*({popupWindowFeatures:t=this._settings.popupWindowFeatures,popupWindowTarget:e=this._settings.popupWindowTarget}){return new Xi({popupWindowFeatures:t,popupWindowTarget:e})})}callback(r,i){return l(this,arguments,function*(t,{keepOpen:e=!1}){this._logger.create("callback"),Xi.notifyOpener(t,e)})}},Sl=class{constructor(t){this._settings=t,this._logger=new x("RedirectNavigator")}prepare(r){return l(this,arguments,function*({redirectMethod:t=this._settings.redirectMethod,redirectTarget:e=this._settings.redirectTarget}){var i;this._logger.create("prepare");let s=window.self;e==="top"&&(s=(i=window.top)!=null?i:window.self);let n=s.location[t].bind(s.location),o;return{navigate:a=>l(this,null,function*(){this._logger.create("navigate");let d=new Promise((c,p)=>{o=p});return n(a.url),yield d}),close:()=>{this._logger.create("close"),o?.(new Error("Redirect aborted")),s.stop()}}})}callback(){return l(this,null,function*(){})}},Cl=class extends Xa{constructor(t){super({expiringNotificationTimeInSeconds:t.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new x("UserManagerEvents"),this._userLoaded=new ye("User loaded"),this._userUnloaded=new ye("User unloaded"),this._silentRenewError=new ye("Silent renew error"),this._userSignedIn=new ye("User signed in"),this._userSignedOut=new ye("User signed out"),this._userSessionChanged=new ye("User session changed")}load(t,e=!0){super.load(t),e&&this._userLoaded.raise(t)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(t){return this._userLoaded.addHandler(t)}removeUserLoaded(t){return this._userLoaded.removeHandler(t)}addUserUnloaded(t){return this._userUnloaded.addHandler(t)}removeUserUnloaded(t){return this._userUnloaded.removeHandler(t)}addSilentRenewError(t){return this._silentRenewError.addHandler(t)}removeSilentRenewError(t){return this._silentRenewError.removeHandler(t)}_raiseSilentRenewError(t){this._silentRenewError.raise(t)}addUserSignedIn(t){return this._userSignedIn.addHandler(t)}removeUserSignedIn(t){this._userSignedIn.removeHandler(t)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(t){return this._userSignedOut.addHandler(t)}removeUserSignedOut(t){this._userSignedOut.removeHandler(t)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(t){return this._userSessionChanged.addHandler(t)}removeUserSessionChanged(t){this._userSessionChanged.removeHandler(t)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}},El=class{constructor(t){this._userManager=t,this._logger=new x("SilentRenewService"),this._isStarted=!1,this._retryTimer=new z("Retry Silent Renew"),this._tokenExpiring=()=>l(this,null,function*(){let e=this._logger.create("_tokenExpiring");try{yield this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(r){if(r instanceof Or){e.warn("ErrorTimeout from signinSilent:",r,"retry in 5s"),this._retryTimer.init(5);return}e.error("Error from signinSilent:",r),this._userManager.events._raiseSilentRenewError(r)}})}start(){return l(this,null,function*(){let t=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{yield this._userManager.getUser()}catch(e){t.error("getUser error",e)}}})}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}},Al=class{constructor(t,e){this.refresh_token=t.refresh_token,this.id_token=t.id_token,this.session_state=t.session_state,this.scope=t.scope,this.profile=t.profile,this.resource=e,this.data=t.state}},ns=class{constructor(t,e,r,i){this._logger=new x("UserManager"),this.settings=new vl(t),this._client=new fl(t),this._redirectNavigator=e??new Sl(this.settings),this._popupNavigator=r??new xl(this.settings),this._iframeNavigator=i??new yl(this.settings),this._events=new Cl(this.settings),this._silentRenewService=new El(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new gl(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}getUser(){return l(this,null,function*(){let t=this._logger.create("getUser"),e=yield this._loadUser();return e?(t.info("user loaded"),this._events.load(e,!1),e):(t.info("user not found in storage"),null)})}removeUser(){return l(this,null,function*(){let t=this._logger.create("removeUser");yield this.storeUser(null),t.info("user removed from storage"),this._events.unload()})}signinRedirect(){return l(this,arguments,function*(t={}){this._logger.create("signinRedirect");let s=t,{redirectMethod:e}=s,r=P(s,["redirectMethod"]),i=yield this._redirectNavigator.prepare({redirectMethod:e});yield this._signinStart(S({request_type:"si:r"},r),i)})}signinRedirectCallback(){return l(this,arguments,function*(t=window.location.href){let e=this._logger.create("signinRedirectCallback"),r=yield this._signinEnd(t);return r.profile&&r.profile.sub?e.info("success, signed in subject",r.profile.sub):e.info("no subject"),r})}signinResourceOwnerCredentials(i){return l(this,arguments,function*({username:t,password:e,skipUserInfo:r=!1}){let s=this._logger.create("signinResourceOwnerCredential"),n=yield this._client.processResourceOwnerPasswordCredentials({username:t,password:e,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});s.debug("got signin response");let o=yield this._buildUser(n);return o.profile&&o.profile.sub?s.info("success, signed in subject",o.profile.sub):s.info("no subject"),o})}signinPopup(){return l(this,arguments,function*(t={}){let e=this._logger.create("signinPopup"),d=t,{popupWindowFeatures:r,popupWindowTarget:i}=d,s=P(d,["popupWindowFeatures","popupWindowTarget"]),n=this.settings.popup_redirect_uri;n||e.throw(new Error("No popup_redirect_uri configured"));let o=yield this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:i}),a=yield this._signin(S({request_type:"si:p",redirect_uri:n,display:"popup"},s),o);return a&&(a.profile&&a.profile.sub?e.info("success, signed in subject",a.profile.sub):e.info("no subject")),a})}signinPopupCallback(){return l(this,arguments,function*(t=window.location.href,e=!1){let r=this._logger.create("signinPopupCallback");yield this._popupNavigator.callback(t,{keepOpen:e}),r.info("success")})}signinSilent(){return l(this,arguments,function*(t={}){var e;let r=this._logger.create("signinSilent"),p=t,{silentRequestTimeoutInSeconds:i,resource:s}=p,n=P(p,["silentRequestTimeoutInSeconds","resource"]),o=yield this._loadUser();if(o?.refresh_token){r.debug("using refresh token");let f=new Al(o,s);return yield this._useRefreshToken(f)}let a=this.settings.silent_redirect_uri;a||r.throw(new Error("No silent_redirect_uri configured"));let d;o&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",o.profile.sub),d=o.profile.sub);let c=yield this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:i});return o=yield this._signin(S({request_type:"si:s",redirect_uri:a,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?o?.id_token:void 0},n),c,d),o&&((e=o.profile)!=null&&e.sub?r.info("success, signed in subject",o.profile.sub):r.info("no subject")),o})}_useRefreshToken(t){return l(this,null,function*(){let e=yield this._client.useRefreshToken({state:t,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new Nt(S(S({},t),e));return yield this.storeUser(r),this._events.load(r),r})}signinSilentCallback(){return l(this,arguments,function*(t=window.location.href){let e=this._logger.create("signinSilentCallback");yield this._iframeNavigator.callback(t),e.info("success")})}signinCallback(){return l(this,arguments,function*(t=window.location.href){let{state:e}=yield this._client.readSigninResponseState(t);switch(e.request_type){case"si:r":return yield this.signinRedirectCallback(t);case"si:p":return yield this.signinPopupCallback(t);case"si:s":return yield this.signinSilentCallback(t);default:throw new Error("invalid response_type in state")}})}signoutCallback(){return l(this,arguments,function*(t=window.location.href,e=!1){let{state:r}=yield this._client.readSignoutResponseState(t);if(r)switch(r.request_type){case"so:r":yield this.signoutRedirectCallback(t);break;case"so:p":yield this.signoutPopupCallback(t,e);break;case"so:s":yield this.signoutSilentCallback(t);break;default:throw new Error("invalid response_type in state")}})}querySessionStatus(){return l(this,arguments,function*(t={}){let e=this._logger.create("querySessionStatus"),d=t,{silentRequestTimeoutInSeconds:r}=d,i=P(d,["silentRequestTimeoutInSeconds"]),s=this.settings.silent_redirect_uri;s||e.throw(new Error("No silent_redirect_uri configured"));let n=yield this._loadUser(),o=yield this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),a=yield this._signinStart(S({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?n?.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0},i),o);try{let c=yield this._client.processSigninResponse(a.url);return e.debug("got signin response"),c.session_state&&c.profile.sub?(e.info("success for subject",c.profile.sub),{session_state:c.session_state,sub:c.profile.sub,sid:c.profile.sid}):(e.info("success, user not authenticated"),null)}catch(c){if(this.settings.monitorAnonymousSession&&c instanceof De)switch(c.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return e.info("success for anonymous user"),{session_state:c.session_state}}throw c}})}_signin(t,e,r){return l(this,null,function*(){let i=yield this._signinStart(t,e);return yield this._signinEnd(i.url,r)})}_signinStart(t,e){return l(this,null,function*(){let r=this._logger.create("_signinStart");try{let i=yield this._client.createSigninRequest(t);return r.debug("got signin request"),yield e.navigate({url:i.url,state:i.state.id,response_mode:i.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(i){throw r.debug("error after preparing navigator, closing navigator window"),e.close(),i}})}_signinEnd(t,e){return l(this,null,function*(){let r=this._logger.create("_signinEnd"),i=yield this._client.processSigninResponse(t);return r.debug("got signin response"),yield this._buildUser(i,e)})}_buildUser(t,e){return l(this,null,function*(){let r=this._logger.create("_buildUser"),i=new Nt(t);if(e){if(e!==i.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",i.profile.sub),new De(H(S({},t),{error:"login_required"}));r.debug("current user matches user returned from signin")}return yield this.storeUser(i),r.debug("user stored"),this._events.load(i),i})}signoutRedirect(){return l(this,arguments,function*(t={}){let e=this._logger.create("signoutRedirect"),n=t,{redirectMethod:r}=n,i=P(n,["redirectMethod"]),s=yield this._redirectNavigator.prepare({redirectMethod:r});yield this._signoutStart(S({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},i),s),e.info("success")})}signoutRedirectCallback(){return l(this,arguments,function*(t=window.location.href){let e=this._logger.create("signoutRedirectCallback"),r=yield this._signoutEnd(t);return e.info("success"),r})}signoutPopup(){return l(this,arguments,function*(t={}){let e=this._logger.create("signoutPopup"),a=t,{popupWindowFeatures:r,popupWindowTarget:i}=a,s=P(a,["popupWindowFeatures","popupWindowTarget"]),n=this.settings.popup_post_logout_redirect_uri,o=yield this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:i});yield this._signout(S({request_type:"so:p",post_logout_redirect_uri:n,state:n==null?void 0:{}},s),o),e.info("success")})}signoutPopupCallback(){return l(this,arguments,function*(t=window.location.href,e=!1){let r=this._logger.create("signoutPopupCallback");yield this._popupNavigator.callback(t,{keepOpen:e}),r.info("success")})}_signout(t,e){return l(this,null,function*(){let r=yield this._signoutStart(t,e);return yield this._signoutEnd(r.url)})}_signoutStart(){return l(this,arguments,function*(t={},e){var r;let i=this._logger.create("_signoutStart");try{let s=yield this._loadUser();i.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&(yield this._revokeInternal(s));let n=t.id_token_hint||s&&s.id_token;n&&(i.debug("setting id_token_hint in signout request"),t.id_token_hint=n),yield this.removeUser(),i.debug("user removed, creating signout request");let o=yield this._client.createSignoutRequest(t);return i.debug("got signout request"),yield e.navigate({url:o.url,state:(r=o.state)==null?void 0:r.id,scriptOrigin:this.settings.iframeScriptOrigin})}catch(s){throw i.debug("error after preparing navigator, closing navigator window"),e.close(),s}})}_signoutEnd(t){return l(this,null,function*(){let e=this._logger.create("_signoutEnd"),r=yield this._client.processSignoutResponse(t);return e.debug("got signout response"),r})}signoutSilent(){return l(this,arguments,function*(t={}){var e;let r=this._logger.create("signoutSilent"),d=t,{silentRequestTimeoutInSeconds:i}=d,s=P(d,["silentRequestTimeoutInSeconds"]),n=this.settings.includeIdTokenInSilentSignout?(e=yield this._loadUser())==null?void 0:e.id_token:void 0,o=this.settings.popup_post_logout_redirect_uri,a=yield this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:i});yield this._signout(S({request_type:"so:s",post_logout_redirect_uri:o,id_token_hint:n},s),a),r.info("success")})}signoutSilentCallback(){return l(this,arguments,function*(t=window.location.href){let e=this._logger.create("signoutSilentCallback");yield this._iframeNavigator.callback(t),e.info("success")})}revokeTokens(t){return l(this,null,function*(){let e=yield this._loadUser();yield this._revokeInternal(e,t)})}_revokeInternal(r){return l(this,arguments,function*(t,e=this.settings.revokeTokenTypes){let i=this._logger.create("_revokeInternal");if(!t)return;let s=e.filter(n=>typeof t[n]=="string");if(!s.length){i.debug("no need to revoke due to no token(s)");return}for(let n of s)yield this._client.revokeToken(t[n],n),i.info(`${n} revoked successfully`),n!=="access_token"&&(t[n]=null);yield this.storeUser(t),i.debug("user stored"),this._events.load(t)})}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}_loadUser(){return l(this,null,function*(){let t=this._logger.create("_loadUser"),e=yield this.settings.userStore.get(this._userStoreKey);return e?(t.debug("user storageString loaded"),Nt.fromStorageString(e)):(t.debug("no user storageString"),null)})}storeUser(t){return l(this,null,function*(){let e=this._logger.create("storeUser");if(t){e.debug("storing user");let r=t.toStorageString();yield this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),yield this.settings.userStore.remove(this._userStoreKey)})}clearStaleState(){return l(this,null,function*(){yield this._client.clearStaleState()})}}});var q,O,R,jr=u(()=>{"use strict";Lt();O=(function(t){return t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t})(O||{}),R=class{static#e;static#t;static#r;#n=[];constructor(e){e&&this.#n.push(e)}static init(e,r=O.ERROR,i=console){this.setLibName(e),this.setLogLevel(r),this.setLogger(i)}static setLibName(e){this.#e=e}static setLogLevel(e){this.#t=e,Re.setLevel(e)}static setLogger(e){this.#r=e,Re.setLogger(e)}createChild(e){let r=new q;return r.#n.push(...this.#n,e),r}debug(...e){q.#t>=O.DEBUG&&q.#r.debug(this.#i(),...e)}info(...e){q.#t>=O.INFO&&q.#r.info(this.#i(),...e)}warn(...e){q.#t>=O.WARN&&q.#r.warn(this.#i(),...e)}error(...e){q.#t>=O.ERROR&&q.#r.error(this.#i(),...e)}getError(e,r=!1){return q.#r.error(this.#i(r),e),new Error(e)}notif(...e){q.#r.warn(this.#i(!1),...e)}#i(e=!0){let r=`[${q.#e}]`;return e&&(r+=`[${this.#n.join(".")}]`),r}};q=R});var Le,os=u(()=>{"use strict";Le=class{}});var J,as=u(()=>{"use strict";J=class{#e=[];#t;add(e,r){let i={subscriber:e,options:r};return this.#e.push(i),this.#t&&(e(this.#t),r?.once&&this.unsubscribe(e)),{unsubscribe:()=>{this.unsubscribe(e)}}}notify(e){this.#t=e,this.#e.forEach(r=>{r.subscriber(e),r.options?.once&&this.unsubscribe(r.subscriber)})}unsubscribe(e){if(e){let r=this.#e.findIndex(i=>i.subscriber===e);r!==-1&&this.#e.splice(r,1)}else this.#e=[]}}});var kl,Be,He,qe,we,be,Pe,Bt,ls=u(()=>{"use strict";kr();jr();kl=new R("AuthUtils"),Be=()=>typeof window.cordova<"u"||typeof window.phonegap<"u"||typeof window.PhoneGap<"u",He=()=>!!window.Capacitor?.isNativePlatform(),qe=()=>He()||Be(),we=t=>{try{return t&&Ut(t)}catch{return kl.createChild("decodeJwt").warn("Token was not decoded as it is not a valid JWT."),t}},be=(t,e)=>{if(e!==void 0){let r=new URL(t,"http://test"),i=new URL(e,"http://test");if(i.pathname!==""&&i.pathname!=="/"&&!r.pathname.includes(i.pathname)||i.origin!=="http://test"&&(r.protocol!==i.protocol||r.origin!==i.origin||!`${r.origin}${r.pathname}}`.includes(`${i.origin}${i.pathname}`)))return!1;let s=!0;return i.searchParams.forEach((n,o)=>{r.searchParams.getAll(o).includes(n)||(s=!1)}),s}return!1},Pe=()=>{let t=document.querySelector("base")?.href??window.location.origin,e=new URL(t);return t=`${e.origin}${e.pathname}`,t.endsWith("/")?t:`${t}/`},Bt=t=>{try{return new URL(t)}catch{let e=t.startsWith("/")?t.substring(1,t.length):t;return new URL(`${Pe()}${e}`)}}});var Fr,ds=u(()=>{"use strict";Fr=(t,e)=>l(null,null,function*(){let r=new e;return yield r.init(t),r})});var K=u(()=>{"use strict";jr();os();as();ls();ds();});var Il,Ht,Lr=u(()=>{"use strict";Il=typeof global=="object"&&global&&global.Object===Object&&global,Ht=Il});var Tl,Rl,X,Me=u(()=>{"use strict";Lr();Tl=typeof self=="object"&&self&&self.Object===Object&&self,Rl=Ht||Tl||Function("return this")(),X=Rl});var Dl,We,Br=u(()=>{"use strict";Me();Dl=X.Symbol,We=Dl});function Vl(t){var e=Pl.call(t,at),r=t[at];try{t[at]=void 0;var i=!0}catch{}var s=Ml.call(t);return i&&(e?t[at]=r:delete t[at]),s}var cs,Pl,Ml,at,us,hs=u(()=>{"use strict";Br();cs=Object.prototype,Pl=cs.hasOwnProperty,Ml=cs.toString,at=We?We.toStringTag:void 0;us=Vl});function Nl(t){return Ul.call(t)}var Ol,Ul,ps,fs=u(()=>{"use strict";Ol=Object.prototype,Ul=Ol.toString;ps=Nl});function Ll(t){return t==null?t===void 0?Fl:jl:gs&&gs in Object(t)?us(t):ps(t)}var jl,Fl,gs,xe,lt=u(()=>{"use strict";Br();hs();fs();jl="[object Null]",Fl="[object Undefined]",gs=We?We.toStringTag:void 0;xe=Ll});function Bl(t){return t!=null&&typeof t=="object"}var oe,$e=u(()=>{"use strict";oe=Bl});var Hl,dt,Hr=u(()=>{"use strict";Hl=Array.isArray,dt=Hl});function ql(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var F,Se=u(()=>{"use strict";F=ql});function Wl(t){return t}var qt,qr=u(()=>{"use strict";qt=Wl});function Kl(t){if(!F(t))return!1;var e=xe(t);return e==Gl||e==zl||e==$l||e==Jl}var $l,Gl,zl,Jl,Ge,Wt=u(()=>{"use strict";lt();Se();$l="[object AsyncFunction]",Gl="[object Function]",zl="[object GeneratorFunction]",Jl="[object Proxy]";Ge=Kl});var Xl,$t,ms=u(()=>{"use strict";Me();Xl=X["__core-js_shared__"],$t=Xl});function Ql(t){return!!_s&&_s in t}var _s,vs,ys=u(()=>{"use strict";ms();_s=(function(){var t=/[^.]+$/.exec($t&&$t.keys&&$t.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();vs=Ql});function ed(t){if(t!=null){try{return Zl.call(t)}catch{}try{return t+""}catch{}}return""}var Yl,Zl,ws,bs=u(()=>{"use strict";Yl=Function.prototype,Zl=Yl.toString;ws=ed});function ld(t){if(!F(t)||vs(t))return!1;var e=Ge(t)?ad:rd;return e.test(ws(t))}var td,rd,id,sd,nd,od,ad,xs,Ss=u(()=>{"use strict";Wt();ys();Se();bs();td=/[\\^$.*+?()[\]{}|]/g,rd=/^\[object .+?Constructor\]$/,id=Function.prototype,sd=Object.prototype,nd=id.toString,od=sd.hasOwnProperty,ad=RegExp("^"+nd.call(od).replace(td,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");xs=ld});function dd(t,e){return t?.[e]}var Cs,Es=u(()=>{"use strict";Cs=dd});function cd(t,e){var r=Cs(t,e);return xs(r)?r:void 0}var ze,Gt=u(()=>{"use strict";Ss();Es();ze=cd});var As,ud,ks,Is=u(()=>{"use strict";Se();As=Object.create,ud=(function(){function t(){}return function(e){if(!F(e))return{};if(As)return As(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})(),ks=ud});function hd(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var Ts,Rs=u(()=>{"use strict";Ts=hd});function pd(t,e){var r=-1,i=t.length;for(e||(e=Array(i));++r<i;)e[r]=t[r];return e}var Ds,Ps=u(()=>{"use strict";Ds=pd});function _d(t){var e=0,r=0;return function(){var i=md(),s=gd-(i-r);if(r=i,s>0){if(++e>=fd)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var fd,gd,md,Ms,Vs=u(()=>{"use strict";fd=800,gd=16,md=Date.now;Ms=_d});function vd(t){return function(){return t}}var Os,Us=u(()=>{"use strict";Os=vd});var yd,Je,Wr=u(()=>{"use strict";Gt();yd=(function(){try{var t=ze(Object,"defineProperty");return t({},"",{}),t}catch{}})(),Je=yd});var wd,Ns,js=u(()=>{"use strict";Us();Wr();qr();wd=Je?function(t,e){return Je(t,"toString",{configurable:!0,enumerable:!1,value:Os(e),writable:!0})}:qt,Ns=wd});var bd,Fs,Ls=u(()=>{"use strict";js();Vs();bd=Ms(Ns),Fs=bd});function Cd(t,e){var r=typeof t;return e=e??xd,!!e&&(r=="number"||r!="symbol"&&Sd.test(t))&&t>-1&&t%1==0&&t<e}var xd,Sd,zt,$r=u(()=>{"use strict";xd=9007199254740991,Sd=/^(?:0|[1-9]\d*)$/;zt=Cd});function Ed(t,e,r){e=="__proto__"&&Je?Je(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Ke,Jt=u(()=>{"use strict";Wr();Ke=Ed});function Ad(t,e){return t===e||t!==t&&e!==e}var Ce,ct=u(()=>{"use strict";Ce=Ad});function Td(t,e,r){var i=t[e];(!(Id.call(t,e)&&Ce(i,r))||r===void 0&&!(e in t))&&Ke(t,e,r)}var kd,Id,Bs,Hs=u(()=>{"use strict";Jt();ct();kd=Object.prototype,Id=kd.hasOwnProperty;Bs=Td});function Rd(t,e,r,i){var s=!r;r||(r={});for(var n=-1,o=e.length;++n<o;){var a=e[n],d=i?i(r[a],t[a],a,r,t):void 0;d===void 0&&(d=t[a]),s?Ke(r,a,d):Bs(r,a,d)}return r}var qs,Ws=u(()=>{"use strict";Hs();Jt();qs=Rd});function Dd(t,e,r){return e=$s(e===void 0?t.length-1:e,0),function(){for(var i=arguments,s=-1,n=$s(i.length-e,0),o=Array(n);++s<n;)o[s]=i[e+s];s=-1;for(var a=Array(e+1);++s<e;)a[s]=i[s];return a[e]=r(o),Ts(t,this,a)}}var $s,Gs,zs=u(()=>{"use strict";Rs();$s=Math.max;Gs=Dd});function Pd(t,e){return Fs(Gs(t,e,qt),t+"")}var Js,Ks=u(()=>{"use strict";qr();zs();Ls();Js=Pd});function Vd(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Md}var Md,Kt,Gr=u(()=>{"use strict";Md=9007199254740991;Kt=Vd});function Od(t){return t!=null&&Kt(t.length)&&!Ge(t)}var Xe,Xt=u(()=>{"use strict";Wt();Gr();Xe=Od});function Ud(t,e,r){if(!F(r))return!1;var i=typeof e;return(i=="number"?Xe(r)&&zt(e,r.length):i=="string"&&e in r)?Ce(r[e],t):!1}var Xs,Qs=u(()=>{"use strict";ct();Xt();$r();Se();Xs=Ud});function Nd(t){return Js(function(e,r){var i=-1,s=r.length,n=s>1?r[s-1]:void 0,o=s>2?r[2]:void 0;for(n=t.length>3&&typeof n=="function"?(s--,n):void 0,o&&Xs(r[0],r[1],o)&&(n=s<3?void 0:n,s=1),e=Object(e);++i<s;){var a=r[i];a&&t(e,a,i,n)}return e})}var Ys,Zs=u(()=>{"use strict";Ks();Qs();Ys=Nd});function Fd(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||jd;return t===r}var jd,Qt,zr=u(()=>{"use strict";jd=Object.prototype;Qt=Fd});function Ld(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}var en,tn=u(()=>{"use strict";en=Ld});function Hd(t){return oe(t)&&xe(t)==Bd}var Bd,Jr,rn=u(()=>{"use strict";lt();$e();Bd="[object Arguments]";Jr=Hd});var sn,qd,Wd,$d,ut,Kr=u(()=>{"use strict";rn();$e();sn=Object.prototype,qd=sn.hasOwnProperty,Wd=sn.propertyIsEnumerable,$d=Jr((function(){return arguments})())?Jr:function(t){return oe(t)&&qd.call(t,"callee")&&!Wd.call(t,"callee")},ut=$d});function Gd(){return!1}var nn,on=u(()=>{"use strict";nn=Gd});var dn,an,zd,ln,Jd,Kd,Yt,Xr=u(()=>{"use strict";Me();on();dn=typeof exports=="object"&&exports&&!exports.nodeType&&exports,an=dn&&typeof module=="object"&&module&&!module.nodeType&&module,zd=an&&an.exports===dn,ln=zd?X.Buffer:void 0,Jd=ln?ln.isBuffer:void 0,Kd=Jd||nn,Yt=Kd});function wc(t){return oe(t)&&Kt(t.length)&&!!I[xe(t)]}var Xd,Qd,Yd,Zd,ec,tc,rc,ic,sc,nc,oc,ac,lc,dc,cc,uc,hc,pc,fc,gc,mc,_c,vc,yc,I,cn,un=u(()=>{"use strict";lt();Gr();$e();Xd="[object Arguments]",Qd="[object Array]",Yd="[object Boolean]",Zd="[object Date]",ec="[object Error]",tc="[object Function]",rc="[object Map]",ic="[object Number]",sc="[object Object]",nc="[object RegExp]",oc="[object Set]",ac="[object String]",lc="[object WeakMap]",dc="[object ArrayBuffer]",cc="[object DataView]",uc="[object Float32Array]",hc="[object Float64Array]",pc="[object Int8Array]",fc="[object Int16Array]",gc="[object Int32Array]",mc="[object Uint8Array]",_c="[object Uint8ClampedArray]",vc="[object Uint16Array]",yc="[object Uint32Array]",I={};I[uc]=I[hc]=I[pc]=I[fc]=I[gc]=I[mc]=I[_c]=I[vc]=I[yc]=!0;I[Xd]=I[Qd]=I[dc]=I[Yd]=I[cc]=I[Zd]=I[ec]=I[tc]=I[rc]=I[ic]=I[sc]=I[nc]=I[oc]=I[ac]=I[lc]=!1;cn=wc});function bc(t){return function(e){return t(e)}}var hn,pn=u(()=>{"use strict";hn=bc});var fn,ht,xc,Qr,Sc,Yr,gn=u(()=>{"use strict";Lr();fn=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ht=fn&&typeof module=="object"&&module&&!module.nodeType&&module,xc=ht&&ht.exports===fn,Qr=xc&&Ht.process,Sc=(function(){try{var t=ht&&ht.require&&ht.require("util").types;return t||Qr&&Qr.binding&&Qr.binding("util")}catch{}})(),Yr=Sc});var mn,Cc,Zt,Zr=u(()=>{"use strict";un();pn();gn();mn=Yr&&Yr.isTypedArray,Cc=mn?hn(mn):cn,Zt=Cc});function kc(t,e){var r=dt(t),i=!r&&ut(t),s=!r&&!i&&Yt(t),n=!r&&!i&&!s&&Zt(t),o=r||i||s||n,a=o?en(t.length,String):[],d=a.length;for(var c in t)(e||Ac.call(t,c))&&!(o&&(c=="length"||s&&(c=="offset"||c=="parent")||n&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||zt(c,d)))&&a.push(c);return a}var Ec,Ac,_n,vn=u(()=>{"use strict";tn();Kr();Hr();Xr();$r();Zr();Ec=Object.prototype,Ac=Ec.hasOwnProperty;_n=kc});function Ic(t,e){return function(r){return t(e(r))}}var yn,wn=u(()=>{"use strict";yn=Ic});function Tc(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var bn,xn=u(()=>{"use strict";bn=Tc});function Pc(t){if(!F(t))return bn(t);var e=Qt(t),r=[];for(var i in t)i=="constructor"&&(e||!Dc.call(t,i))||r.push(i);return r}var Rc,Dc,Sn,Cn=u(()=>{"use strict";Se();zr();xn();Rc=Object.prototype,Dc=Rc.hasOwnProperty;Sn=Pc});function Mc(t){return Xe(t)?_n(t,!0):Sn(t)}var er,ei=u(()=>{"use strict";vn();Cn();Xt();er=Mc});var Vc,he,pt=u(()=>{"use strict";Gt();Vc=ze(Object,"create"),he=Vc});function Oc(){this.__data__=he?he(null):{},this.size=0}var En,An=u(()=>{"use strict";pt();En=Oc});function Uc(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var kn,In=u(()=>{"use strict";kn=Uc});function Lc(t){var e=this.__data__;if(he){var r=e[t];return r===Nc?void 0:r}return Fc.call(e,t)?e[t]:void 0}var Nc,jc,Fc,Tn,Rn=u(()=>{"use strict";pt();Nc="__lodash_hash_undefined__",jc=Object.prototype,Fc=jc.hasOwnProperty;Tn=Lc});function qc(t){var e=this.__data__;return he?e[t]!==void 0:Hc.call(e,t)}var Bc,Hc,Dn,Pn=u(()=>{"use strict";pt();Bc=Object.prototype,Hc=Bc.hasOwnProperty;Dn=qc});function $c(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=he&&e===void 0?Wc:e,this}var Wc,Mn,Vn=u(()=>{"use strict";pt();Wc="__lodash_hash_undefined__";Mn=$c});function Qe(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}var ti,On=u(()=>{"use strict";An();In();Rn();Pn();Vn();Qe.prototype.clear=En;Qe.prototype.delete=kn;Qe.prototype.get=Tn;Qe.prototype.has=Dn;Qe.prototype.set=Mn;ti=Qe});function Gc(){this.__data__=[],this.size=0}var Un,Nn=u(()=>{"use strict";Un=Gc});function zc(t,e){for(var r=t.length;r--;)if(Ce(t[r][0],e))return r;return-1}var Ee,ft=u(()=>{"use strict";ct();Ee=zc});function Xc(t){var e=this.__data__,r=Ee(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():Kc.call(e,r,1),--this.size,!0}var Jc,Kc,jn,Fn=u(()=>{"use strict";ft();Jc=Array.prototype,Kc=Jc.splice;jn=Xc});function Qc(t){var e=this.__data__,r=Ee(e,t);return r<0?void 0:e[r][1]}var Ln,Bn=u(()=>{"use strict";ft();Ln=Qc});function Yc(t){return Ee(this.__data__,t)>-1}var Hn,qn=u(()=>{"use strict";ft();Hn=Yc});function Zc(t,e){var r=this.__data__,i=Ee(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}var Wn,$n=u(()=>{"use strict";ft();Wn=Zc});function Ye(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}var Ae,gt=u(()=>{"use strict";Nn();Fn();Bn();qn();$n();Ye.prototype.clear=Un;Ye.prototype.delete=jn;Ye.prototype.get=Ln;Ye.prototype.has=Hn;Ye.prototype.set=Wn;Ae=Ye});var eu,tr,ri=u(()=>{"use strict";Gt();Me();eu=ze(X,"Map"),tr=eu});function tu(){this.size=0,this.__data__={hash:new ti,map:new(tr||Ae),string:new ti}}var Gn,zn=u(()=>{"use strict";On();gt();ri();Gn=tu});function ru(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Jn,Kn=u(()=>{"use strict";Jn=ru});function iu(t,e){var r=t.__data__;return Jn(e)?r[typeof e=="string"?"string":"hash"]:r.map}var ke,mt=u(()=>{"use strict";Kn();ke=iu});function su(t){var e=ke(this,t).delete(t);return this.size-=e?1:0,e}var Xn,Qn=u(()=>{"use strict";mt();Xn=su});function nu(t){return ke(this,t).get(t)}var Yn,Zn=u(()=>{"use strict";mt();Yn=nu});function ou(t){return ke(this,t).has(t)}var eo,to=u(()=>{"use strict";mt();eo=ou});function au(t,e){var r=ke(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}var ro,io=u(()=>{"use strict";mt();ro=au});function Ze(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}var so,no=u(()=>{"use strict";zn();Qn();Zn();to();io();Ze.prototype.clear=Gn;Ze.prototype.delete=Xn;Ze.prototype.get=Yn;Ze.prototype.has=eo;Ze.prototype.set=ro;so=Ze});var lu,rr,ii=u(()=>{"use strict";wn();lu=yn(Object.getPrototypeOf,Object),rr=lu});function fu(t){if(!oe(t)||xe(t)!=du)return!1;var e=rr(t);if(e===null)return!0;var r=hu.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&oo.call(r)==pu}var du,cu,uu,oo,hu,pu,ao,lo=u(()=>{"use strict";lt();ii();$e();du="[object Object]",cu=Function.prototype,uu=Object.prototype,oo=cu.toString,hu=uu.hasOwnProperty,pu=oo.call(Object);ao=fu});function gu(){this.__data__=new Ae,this.size=0}var co,uo=u(()=>{"use strict";gt();co=gu});function mu(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var ho,po=u(()=>{"use strict";ho=mu});function _u(t){return this.__data__.get(t)}var fo,go=u(()=>{"use strict";fo=_u});function vu(t){return this.__data__.has(t)}var mo,_o=u(()=>{"use strict";mo=vu});function wu(t,e){var r=this.__data__;if(r instanceof Ae){var i=r.__data__;if(!tr||i.length<yu-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new so(i)}return r.set(t,e),this.size=r.size,this}var yu,vo,yo=u(()=>{"use strict";gt();ri();no();yu=200;vo=wu});function et(t){var e=this.__data__=new Ae(t);this.size=e.size}var wo,bo=u(()=>{"use strict";gt();uo();po();go();_o();yo();et.prototype.clear=co;et.prototype.delete=ho;et.prototype.get=fo;et.prototype.has=mo;et.prototype.set=vo;wo=et});function xu(t,e){if(e)return t.slice();var r=t.length,i=Co?Co(r):new t.constructor(r);return t.copy(i),i}var Eo,xo,bu,So,Co,Ao,ko=u(()=>{"use strict";Me();Eo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xo=Eo&&typeof module=="object"&&module&&!module.nodeType&&module,bu=xo&&xo.exports===Eo,So=bu?X.Buffer:void 0,Co=So?So.allocUnsafe:void 0;Ao=xu});var Su,si,Io=u(()=>{"use strict";Me();Su=X.Uint8Array,si=Su});function Cu(t){var e=new t.constructor(t.byteLength);return new si(e).set(new si(t)),e}var To,Ro=u(()=>{"use strict";Io();To=Cu});function Eu(t,e){var r=e?To(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Do,Po=u(()=>{"use strict";Ro();Do=Eu});function Au(t){return typeof t.constructor=="function"&&!Qt(t)?ks(rr(t)):{}}var Mo,Vo=u(()=>{"use strict";Is();ii();zr();Mo=Au});function ku(t){return function(e,r,i){for(var s=-1,n=Object(e),o=i(e),a=o.length;a--;){var d=o[t?a:++s];if(r(n[d],d,n)===!1)break}return e}}var Oo,Uo=u(()=>{"use strict";Oo=ku});var Iu,No,jo=u(()=>{"use strict";Uo();Iu=Oo(),No=Iu});function Tu(t,e,r){(r!==void 0&&!Ce(t[e],r)||r===void 0&&!(e in t))&&Ke(t,e,r)}var _t,ni=u(()=>{"use strict";Jt();ct();_t=Tu});function Ru(t){return oe(t)&&Xe(t)}var Fo,Lo=u(()=>{"use strict";Xt();$e();Fo=Ru});function Du(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var vt,oi=u(()=>{"use strict";vt=Du});function Pu(t){return qs(t,er(t))}var Bo,Ho=u(()=>{"use strict";Ws();ei();Bo=Pu});function Mu(t,e,r,i,s,n,o){var a=vt(t,r),d=vt(e,r),c=o.get(d);if(c){_t(t,r,c);return}var p=n?n(a,d,r+"",t,e,o):void 0,f=p===void 0;if(f){var m=dt(d),g=!m&&Yt(d),y=!m&&!g&&Zt(d);p=d,m||g||y?dt(a)?p=a:Fo(a)?p=Ds(a):g?(f=!1,p=Ao(d,!0)):y?(f=!1,p=Do(d,!0)):p=[]:ao(d)||ut(d)?(p=a,ut(a)?p=Bo(a):(!F(a)||Ge(a))&&(p=Mo(d))):f=!1}f&&(o.set(d,p),s(p,d,i,n,o),o.delete(d)),_t(t,r,p)}var qo,Wo=u(()=>{"use strict";ni();ko();Po();Ps();Vo();Kr();Hr();Lo();Xr();Wt();Se();lo();Zr();oi();Ho();qo=Mu});function $o(t,e,r,i,s){t!==e&&No(e,function(n,o){if(s||(s=new wo),F(n))qo(t,e,o,r,$o,i,s);else{var a=i?i(vt(t,o),n,o+"",t,e,s):void 0;a===void 0&&(a=n),_t(t,o,a)}},er)}var Go,zo=u(()=>{"use strict";bo();ni();jo();Wo();Se();ei();oi();Go=$o});var Vu,ai,Jo=u(()=>{"use strict";zo();Zs();Vu=Ys(function(t,e,r){Go(t,e,r)}),ai=Vu});var Ko=u(()=>{"use strict";Jo();});var Q,ir=u(()=>{"use strict";Q=(function(t){return t.REDIRECT="REDIRECT",t.POPUP="POPUP",t})(Q||{})});var Ve,Z,li=u(()=>{"use strict";K();ir();Ve="auth-js:oidc_manager:redirect_url",Z={loginRequired:!1,loadUserInfo:!1,retrieveUserSession:!0,automaticSilentRenew:!0,automaticLoginOn401:!0,automaticInjectToken:{headerName:"Authorization",include:t=>{let e=new URL(t,"http://default-base");return e.hostname.startsWith("api")||e.pathname.startsWith("/api")||!1}},scope:"openid profile email phone",desktopNavigationType:Q.REDIRECT,logLevel:O.NONE,internal:{response_type:"code",redirect_uri:"?oidc-callback=login",post_logout_redirect_uri:"?oidc-callback=logout",popup_redirect_uri:"oidc/callback/popup_redirect.html",popup_post_logout_redirect_uri:"oidc/callback/popup_redirect.html",silent_redirect_uri:"oidc/callback/silent_redirect.html",mobileWindowPresentationStyle:"popover"}}});var pe,tt,W,$,L,sr,Xo=u(()=>{"use strict";K();pe=new R("MobileStorage"),tt=window.localStorage,W=window.Capacitor?.Plugins.Storage,$=window.Capacitor?.Plugins.Preferences,L=window.Capacitor?.Plugins.SecureStoragePlugin,sr=class{constructor(){if(!L){let e=`[@badisi/auth-js] This application is currently using an unsafe storage.

`;e+="\u24D8 Please follow the recommended guide and use `capacitor-secure-storage-plugin` instead.",pe.notif(e)}L?pe.debug("Using `capacitor-secure-storage-plugin` implementation"):$?pe.debug("Using `@capacitor/preferences` implementation"):W?pe.debug("Using `@capacitor/storage` implementation"):pe.debug("Using `localStorage` implementation")}get length(){return l(null,null,function*(){return L?(yield L.keys()).value.length:$?(yield $.keys()).keys.length:W?(yield W.keys()).keys.length:tt.length})}key(e){return l(this,null,function*(){return L?(yield L.keys()).value[e]:$?(yield $.keys()).keys[e]:W?(yield W.keys()).keys[e]:tt.key(e)})}clear(){return l(this,null,function*(){pe.debug("clear"),L?yield L.clear():$?yield $.clear():W?yield W.clear():tt.clear()})}getItem(e){return l(this,null,function*(){if(pe.debug(`getItem('${e}')`),L)try{return(yield L.get({key:e})).value}catch{return null}else return $?(yield $.get({key:e})).value:W?(yield W.get({key:e})).value:tt.getItem(e)})}setItem(e,r){return l(this,null,function*(){pe.debug(`setItem('${e}')`),L?yield L.set({key:e,value:r}):$?yield $.set({key:e,value:r}):W?yield W.set({key:e,value:r}):tt.setItem(e,r)})}removeItem(e){return l(this,null,function*(){if(pe.debug(`removeItem('${e}')`),L)try{yield L.remove({key:e})}catch{}else $?yield $.remove({key:e}):W?yield W.remove({key:e}):tt.removeItem(e)})}}});var Ou,nr,Qo=u(()=>{"use strict";K();Ou=new R("OIDCAuthGuard"),nr=class{#e;constructor(e){this.#e=e}validate(e,r){return l(this,null,function*(){let i=r?.fallbackUrl??this.#e.getSettings().authGuardFallbackUrl;if(i=i?.trim()!==""?i:void 0,yield this.#e.isAuthenticated()){let n=yield this.#t(r?.validator);return!n&&i?i:n}else return i??(yield this.#e.login({redirectUrl:e}))})}#t(e){return l(this,null,function*(){if(typeof e=="function"){let r=yield this.#e.getUserProfile(),i=yield this.#e.getAccessTokenDecoded();return yield Promise.resolve(e(r,i))}else if(e)return Ou.error("`authGuardValidator` must be a function"),!1;return!0})}}});var U,or,Yo=u(()=>{"use strict";K();U=new R("OIDCAuthInterceptor"),or=class{#e;#t;#r=window.fetch;#n=XMLHttpRequest.prototype.open;#i=XMLHttpRequest.prototype.send;constructor(e,r){U.debug("init"),this.#e=e,this.#t=r,this.#h(),this.#p()}#c(e){try{return new URL(e).href}catch{return new URL(`${location.origin}${e.startsWith("/")?"":"/"}${e}`).href}}#l(e,r){let i=this.#c(e);if(typeof r=="function")return r(i);if(typeof r=="string"){let s=r.replace(/\//g,"\\/").replace(/\./g,"\\.").replace(/\*\*/g,"*").replace(/\*/g,".*");return new RegExp(s).exec(i)!==null}else return r.exec(i)!==null}#o(e,r){let i=typeof r=="boolean"?r:!1;if(i){let s=this.#t.metadataService._metadata;if(!s&&e.includes(this.#e.getSettings().authorityUrl))U.debug("matching authority domain but no metadata available yet"),i=!1;else if(s&&this.#e.isRenewing())U.debug("matching authority domain but no token available yet"),i=!1;else if(s){let n=[s.authorization_endpoint,s.token_endpoint].find(o=>o&&e.includes(o));n&&(U.debug("matching blacklisted authority url:",n),i=!1)}}if(typeof r=="object"){let{include:s,exclude:n}=r;if(Array.isArray(s)){let o=s.find(a=>this.#l(e,a));o&&(U.debug("matching include pattern:",o),i=!0)}else s&&(i=this.#l(e,s),i&&U.debug("matching include pattern:",s));if(Array.isArray(n)){let o=n.some(a=>this.#l(e,a));o&&(U.debug("matching exclude pattern:",o),i=!1)}else n&&this.#l(e,n)&&(U.debug("matching exclude pattern:",n),i=!1)}return U.debug(i?"allowed":"not allowed"),i}#d(e){let r=this.#e.getSettings().automaticInjectToken??!1;return r!==!1&&this.#o(e,r)}#u(){let e=this.#e.getSettings().automaticInjectToken;return typeof e!="boolean"&&e?.headerName?e.headerName:"Authorization"}#h(e=!0){let r=U.createChild("monkeyPathFetch");r.debug(e?"enabling..":"disabling.."),window.fetch&&(e?window.fetch=(i,s)=>l(this,null,function*(){let n=i instanceof Request?i.url:i.toString();if(U.debug("received FETCH url:",n),this.#d(n)){let a=yield this.#e.getAccessToken();if(s&&a){let d=this.#u();U.debug(`adding "${d}" bearer to header request`),Array.isArray(s.headers)?s.headers.push([d,`Bearer ${a}`]):s.headers instanceof Headers?s.headers.append(d,`Bearer ${a}`):s.headers=H(S({},s.headers),{[d]:`Bearer ${a}`})}}let o=yield this.#r.apply(window,[i,s]);return o.status===401&&(this.#e.getSettings().automaticLoginOn401??!1)&&((yield this.#e.isAuthenticated())||(yield this.#e.login())),o}):window.fetch=this.#r,r.debug("done"))}#p(e=!0){let r=U.createChild("monkeyPatchXmlHttpRequest");if(r.debug(e?"enabling..":"disabling.."),XMLHttpRequest.prototype.open&&XMLHttpRequest.prototype.send){if(e){let i=this;XMLHttpRequest.prototype.open=function(s,n,...o){this.url=n,i.#n.apply(this,[s,n,...o])},XMLHttpRequest.prototype.send=function(s){let n=typeof this.url=="string"?this.url:this.url?.href;U.debug("received XHR url:",n);let o=this.onreadystatechange;this.onreadystatechange=d=>{o?.apply(this,[d]),this.readyState===XMLHttpRequest.DONE&&this.status===401&&(i.#e.getSettings().automaticLoginOn401??!1)&&i.#e.isAuthenticated().then(p=>{p||i.#e.login()})};let a=n?i.#d(n):!1;this.readyState===XMLHttpRequest.OPENED&&a?i.#e.getAccessToken().then(d=>{if(d){let c=i.#u();U.debug(`adding "${c}" bearer to header request`),this.setRequestHeader(c,`Bearer ${d}`)}}).catch(d=>{U.error(d)}).finally(()=>{i.#i.apply(this,[s])}):i.#i.apply(this,[s])}}else XMLHttpRequest.prototype.open=this.#n,XMLHttpRequest.prototype.send=this.#i;r.debug("done")}}}});var Uu,Nu,rt,di,ae,ci,ar,Zo=u(()=>{"use strict";K();Uu=10*1e3,Nu=window.Capacitor?.Plugins.App,rt=window.Capacitor?.Plugins.Browser,di=void 0,ae=new R("MobileWindow"),ci=ae.createChild("navigate"),ar=class{redirectUrl;params;#e;#t;#r=window.handleOpenURL;#n;#i;#c;#l=!0;#o=!1;constructor(e,r){if(this.redirectUrl=e,this.params=r,!He()&&!Be())throw ae.notif("\u24D8 Please follow the installation guide and install either `Capacitor` or `Cordova` dependency."),ae.getError("Required core dependency `Capacitor` or `Cordova` not found");if(!di&&!rt)throw ae.notif("\u24D8 Please follow the installation guide and install `@capacitor/browser` plugin."),ae.getError("Required browser plugin not found");di?ae.debug("Using `@badisi/capacitor-browsertab` implementation"):rt&&ae.debug("Using `@capacitor/browser` implementation")}navigate(e){return l(this,null,function*(){return ci.debug(e.url),this.#l=!1,this.#o=!1,new Promise((r,i)=>{this.#i=r,this.#c=i,this.#m().then(()=>{di?this.#g(e):rt&&this.#p(e)})})})}close(){return l(this,null,function*(){let e=ae.createChild("cleanup");e.debug("begin"),this.#l||(yield rt?.close().catch(r=>{e.error(r)})),e.debug("success")})}#d(){return l(this,null,function*(){let e=ae.createChild("cleanup");e.debug("begin"),window.handleOpenURL=this.#r,yield this.#t?.remove(),yield this.#e?.remove(),clearTimeout(this.#n),e.debug("success")})}#u(e){return l(this,null,function*(){ci.error("error response:",e),yield this.close(),yield this.#d(),this.#c?.(new Error(e)),this.#o=!0})}#h(e){return l(this,null,function*(){ci.debug("successful response:",e),yield this.close(),yield this.#d(),this.#i?.({url:e}),this.#o=!0})}#p(e){return l(this,null,function*(){this.#t=yield rt?.addListener("browserFinished",()=>{this.#l=!0,setTimeout(()=>{this.#o||(this.#d(),this.#c?.("Capacitor browser closed by user"))},1e3)}),yield rt?.open({url:e.url,toolbarColor:this.params.mobileWindowToolbarColor,presentationStyle:this.params.mobileWindowPresentationStyle,width:this.params.mobileWindowWidth,height:this.params.mobileWindowWidth})})}#g(e){return l(this,null,function*(){})}#m(){return l(this,null,function*(){let e=ae.createChild("installCustomUrlSchemeHandler");this.#n=setTimeout(()=>void this.#u("Installing custom url scheme handler, timed out without a response"),Uu),yield this.#d(),He()?(e.debug("listening to Capacitor `appUrlOpen` event"),this.#e=yield Nu?.addListener?.("appUrlOpen",({url:r})=>{be(r,this.redirectUrl)&&this.#h(r)})):Be()&&(e.debug("waiting for Cordova `handleOpenURL` callback"),window.handleOpenURL=r=>{this.#r?.(r),be(r,this.redirectUrl)&&this.#h(r)}),e.debug("success")})}}});var ju,lr,ea=u(()=>{"use strict";K();Zo();ju=new R("MobileNavigator"),lr=class{prepare(e,r){return ju.debug("prepare"),new ar(e,r)}}});var dr,ta=u(()=>{"use strict";Lt();ea();dr=class extends ns{libSettings;#e;constructor(e){super(S({authority:e.authorityUrl,client_id:e.clientId,scope:e.scope,loadUserInfo:e.loadUserInfo,automaticSilentRenew:e.automaticSilentRenew},e.internal)),this.libSettings=e,this.#e=new lr}signoutMobile(){return l(this,arguments,function*(e={}){let r=this._logger.create("signout"),p=e,{mobileWindowToolbarColor:i,mobileWindowPresentationStyle:s,mobileWindowWidth:n,mobileWindowHeight:o}=p,a=P(p,["mobileWindowToolbarColor","mobileWindowPresentationStyle","mobileWindowWidth","mobileWindowHeight"]),d={mobileWindowToolbarColor:i??this.libSettings.internal?.mobileWindowToolbarColor,mobileWindowPresentationStyle:s??this.libSettings.internal?.mobileWindowPresentationStyle,mobileWindowWidth:n??this.libSettings.internal?.mobileWindowWidth,mobileWindowHeight:o??this.libSettings.internal?.mobileWindowHeight},c=this.#e.prepare(this.settings.post_logout_redirect_uri,d);yield this._signout(S({request_type:"so:m",post_logout_redirect_uri:this.settings.post_logout_redirect_uri},a),c),r.info("success")})}signinMobile(){return l(this,arguments,function*(e={}){let r=this._logger.create("signin"),f=e,{mobileWindowToolbarColor:i,mobileWindowPresentationStyle:s,mobileWindowWidth:n,mobileWindowHeight:o}=f,a=P(f,["mobileWindowToolbarColor","mobileWindowPresentationStyle","mobileWindowWidth","mobileWindowHeight"]),d={mobileWindowToolbarColor:i??this.libSettings.internal?.mobileWindowToolbarColor,mobileWindowPresentationStyle:s??this.libSettings.internal?.mobileWindowPresentationStyle,mobileWindowWidth:n??this.libSettings.internal?.mobileWindowWidth,mobileWindowHeight:o??this.libSettings.internal?.mobileWindowHeight},c=this.#e.prepare(this.settings.redirect_uri,d),p=yield this._signin(S({request_type:"si:m",redirect_uri:this.settings.redirect_uri},a),c);p.profile.sub?r.info("success, signed in subject",p.profile.sub):r.info("no subject")})}}});var fe,cr,ra=u(()=>{"use strict";Ko();Lt();K();li();Xo();ir();Qo();Yo();ta();fe=new R("OIDCAuthManager"),cr=class extends Le{#e=new J;#t=new J;#r=new J;#n=new J;#i=new J;#c=new J;#l=new J;#o=[];#d;#u;#h;#p;#g=!1;#m=!1;#a;#s=Z;#w;set user(e){this.#w!==e&&(this.#w=e,this.#d=e?e.id_token:void 0,this.#u=e?e.access_token:void 0,this.#h=e?.profile??void 0,this.#p=e?{expired:e.expired,expires_in:e.expires_in,expires_at:e.expires_at,token_type:e.token_type,scope:e.scope,scopes:e.scopes,session_state:e.session_state}:void 0,this.#g=!!(e&&!e.expired),this.#e.notify(this.#d),this.#t.notify(this.#u),this.#r.notify(this.#h),this.#n.notify(this.#p),this.#i.notify(this.#g))}init(e){return l(this,null,function*(){R.setLogLevel(e.logLevel??Z.logLevel);let r=qe();if(r&&!e.mobileScheme)throw fe.getError("Parameter `mobileScheme` is required for mobile platform");let i=r?`${e.mobileScheme}://localhost/`:Pe();if(this.#s=ai({},Z,{internal:{userStore:new Ft({store:r?new sr:new jt}),redirect_uri:`${i}${Z.internal.redirect_uri}`,post_logout_redirect_uri:`${i}${Z.internal.post_logout_redirect_uri}`,popup_redirect_uri:`${i}${Z.internal.popup_redirect_uri}`,popup_post_logout_redirect_uri:`${i}${Z.internal.popup_post_logout_redirect_uri}`,silent_redirect_uri:`${i}${Z.internal.silent_redirect_uri}`}},e),this.#E(),this.#a=new dr(this.#s),(this.#s.automaticLoginOn401||this.#s.automaticInjectToken)&&new or(this,this.#a),this.#o.push(this.#a.events.addUserLoaded(s=>{this.user=s}),this.#a.events.addUserUnloaded(()=>{this.#w&&(this.user=null,this.#s.loginRequired&&location.reload())}),this.#a.events.addSilentRenewError(()=>l(this,null,function*(){yield this.#y()}))),be(location.href,this.#s.internal?.redirect_uri))yield this.#b(()=>l(this,null,function*(){let s=sessionStorage.getItem(Ve);yield this.#x(()=>this.#a.signinRedirectCallback(location.href),s),sessionStorage.removeItem(Ve)}));else if(be(location.href,this.#s.internal?.post_logout_redirect_uri))yield this.#b(()=>l(this,null,function*(){let s=sessionStorage.getItem(Ve);yield this.#S(()=>this.#a.signoutRedirectCallback(location.href),s),sessionStorage.removeItem(Ve)}));else if(this.#s.retrieveUserSession||this.#s.loginRequired){let s=yield this.#a.getUser();!s||s.expired?!r&&this.#s.retrieveUserSession?yield this.#b(()=>this.#C().catch(n=>l(this,null,function*(){let{error:o,message:a}=n;if(this.#s.loginRequired&&(o?.includes("_required")||a.includes("_required")))yield this.login();else if(fe.warn("User's session cannot be retrieved:",a),this.#i.notify(!1),this.#s.loginRequired)throw n}))):this.#s.loginRequired?yield this.login():this.user=null:this.user=s}else this.user=null})}logout(e){return l(this,null,function*(){let r=e?.redirectUrl??location.href;if(qe())yield this.#S(()=>this.#a.signoutMobile(e),r);else switch(e?.desktopNavigationType??this.#s.desktopNavigationType){case Q.POPUP:yield this.#S(()=>this.#a.signoutPopup(e),r);break;case Q.REDIRECT:default:sessionStorage.setItem(Ve,r),yield this.#a?.signoutRedirect(e);break}})}login(e){return l(this,null,function*(){let r=e?.redirectUrl??location.href;if(qe())yield this.#x(()=>this.#a.signinMobile(e),r);else switch(e?.desktopNavigationType??this.#s.desktopNavigationType){case Q.POPUP:yield this.#x(()=>this.#a.signinPopup(e),r);break;case Q.REDIRECT:default:sessionStorage.setItem(Ve,r),yield this.#a?.signinRedirect(e);break}return this.#g})}renew(e){return l(this,null,function*(){return this.#C(e).catch(r=>{fe.error(r)})})}getSettings(){return this.#s}isRenewing(){return this.#m}isAuthenticated(){return l(this,null,function*(){return yield this.#f("isAuthenticated()"),this.#g})}runGuard(e,r){return l(this,null,function*(){return new nr(this).validate(e,r)})}getUserProfile(){return l(this,null,function*(){return yield this.#f("getUserProfile()"),this.#h})}getUserSession(){return l(this,null,function*(){return yield this.#f("getUserSession()"),this.#p})}getIdToken(){return l(this,null,function*(){return yield this.#f("getIdToken()"),this.#d})}getIdTokenDecoded(){return l(this,null,function*(){return yield this.#f("getIdTokenDecoded()"),we(this.#d)})}getAccessToken(){return l(this,null,function*(){return yield this.#f("getAccessToken()"),this.#u})}getAccessTokenDecoded(){return l(this,null,function*(){return yield this.#f("getAccessTokenDecoded()"),we(this.#u)})}destroy(){this.#e.unsubscribe(),this.#t.unsubscribe(),this.#r.unsubscribe(),this.#n.unsubscribe(),this.#i.unsubscribe(),this.#c.unsubscribe(),this.#l.unsubscribe(),this.#o.forEach(e=>{e()})}onIdTokenChanged(e,r){return this.#e.add(e,r)}onAccessTokenChanged(e,r){return this.#t.add(e,r)}onUserProfileChanged(e,r){return this.#r.add(e,r)}onUserSessionChanged(e,r){return this.#n.add(e,r)}onAuthenticatedChanged(e,r){return this.#i.add(e,r)}onRenewingChanged(e,r){return this.#c.add(e,r)}onRedirect(e,r){return this.#l.add(e,r)}#E(){[this.#s.internal?.silent_redirect_uri,this.#s.internal?.popup_redirect_uri].forEach(e=>{let r=new RegExp(/^.*\/(.*).html$/gm).exec(e??"")?.[1],i=new Error(`${e??"redirect uri"} was not found.`);if(i.stack=void 0,be(location.href,e))throw fe.notif("\u24D8 Encountered an error that usually means you forgot to include the redirect html files in your application assets."),i;if(r&&location.href.includes(`/${r}.html`))throw fe.notif("\u24D8 Encountered an error that usually means your redirect urls are misconfigured."),i})}#f(e){return l(this,null,function*(){let r=Date.now();for(;this.#m;){if(Date.now()>r+5e3){fe.error(`\`${e}\``,"timed out waiting for renew to finish.");break}yield new Promise(i=>setTimeout(i,100))}})}#A(e){let r=Bt(e??"/");this.#s.loginRequired&&location.origin===r.origin&&location.reload()}#_(e){this.#m=e,this.#c.notify(e)}#b(e){return l(this,null,function*(){this.#s.loginRequired?yield e():e()})}#v(e,r){return l(this,null,function*(){r&&(fe.error(r),yield this.#y());let i=Bt(e??"/");location.origin===i.origin?(history.replaceState(history.state,"",i.href),this.#l.notify(i)):location.href=i.href})}#y(){return l(this,null,function*(){this.user=null,yield Promise.all([this.#a?.clearStaleState(),this.#a?.removeUser()])})}#C(e){return l(this,null,function*(){this.#_(!0);try{yield this.#a?.signinSilent(e)}catch(r){throw yield this.#y(),r}finally{this.#_(!1)}})}#x(e,r){return l(this,null,function*(){try{this.#_(!0),yield e().catch(i=>{let s=i;throw s.message==="Attempted to navigate on a disposed window"&&(fe.notif("\u24D8 Encountered an error that may be due to an ad blocker."),s.stack=void 0),s}),yield this.#v(r)}catch(i){throw yield this.#v("/",i),i}finally{this.#_(!1)}})}#S(e,r){return l(this,null,function*(){try{yield e().catch(i=>{let s=i;throw s.message==="Attempted to navigate on a disposed window"&&(fe.notif("\u24D8 Encountered an error that may be due to an ad blocker."),s.stack=void 0),s}),yield this.#v(r),yield this.#y()}catch(i){throw r="/",yield this.#v(r,i),i}finally{this.#A(r)}})}}});var ui,ia=u(()=>{"use strict";K();ra();ui=t=>l(null,null,function*(){return yield Fr(t,cr)})});var yt,sa=u(()=>{"use strict";yt=class{manager;constructor(e){this.manager=e}login(e){return l(this,null,function*(){return this.manager.login(e)})}logout(e){return l(this,null,function*(){return this.manager.logout(e)})}renew(e){return l(this,null,function*(){return this.manager.renew(e)})}isRenewing(){return this.manager.isRenewing()}isAuthenticated(){return l(this,null,function*(){return this.manager.isAuthenticated()})}getSettings(){return this.manager.getSettings()}getUserProfile(){return l(this,null,function*(){return this.manager.getUserProfile()})}getUserSession(){return l(this,null,function*(){return this.manager.getUserSession()})}getIdToken(){return l(this,null,function*(){return this.manager.getIdToken()})}getIdTokenDecoded(){return l(this,null,function*(){return this.manager.getIdTokenDecoded()})}getAccessToken(){return l(this,null,function*(){return this.manager.getAccessToken()})}getAccessTokenDecoded(){return l(this,null,function*(){return this.manager.getAccessTokenDecoded()})}runGuard(e,r){return l(this,null,function*(){return this.manager.runGuard(e,r)})}}});var ur=u(()=>{"use strict";K();K();ia();ir();sa();R.init("@badisi/auth-js")});var hi,Fu,Lu,pi=u(()=>{"use strict";ve();ur();hi=new It("AUTH_MANAGER"),Fu=t=>l(null,null,function*(){return{provide:hi,useValue:yield ui(t),multi:!1}}),Lu=t=>ki([t])});var wt,fi=u(()=>{"use strict";ve();Er();ur();Ha();qa();pi();ve();wt=(()=>{class t extends yt{#e=[];#t=new Te(1);#r=new Te(1);#n=new Te(1);#i=new Te(1);#c=new Te(1);#l=new Te(1);#o=G(Ti);#d=G(je);constructor(){super(G(hi)),this.#u()}ngOnDestroy(){this.#e.forEach(r=>{r.unsubscribe()})}isRenewing$=this.#l.asObservable().pipe(de());isAuthenticated$=this.#c.asObservable().pipe(de());userProfile$=this.#n.asObservable().pipe(de());userSession$=this.#i.asObservable().pipe(de());idToken$=this.#t.asObservable().pipe(de());idTokenDecoded$=this.#t.asObservable().pipe(de(),vr(r=>we(r)));accessToken$=this.#r.asObservable().pipe(de());accessTokenDecoded$=this.#r.asObservable().pipe(de(),vr(r=>we(r)));#u(){this.#e.push(this.manager.onIdTokenChanged(r=>{this.#o.run(()=>{this.#t.next(r)})}),this.manager.onAccessTokenChanged(r=>{this.#o.run(()=>{this.#r.next(r)})}),this.manager.onUserProfileChanged(r=>{this.#o.run(()=>{this.#n.next(r)})}),this.manager.onUserSessionChanged(r=>{this.#o.run(()=>{this.#i.next(r)})}),this.manager.onAuthenticatedChanged(r=>{this.#o.run(()=>{this.#c.next(r)})}),this.manager.onRenewingChanged(r=>{this.#o.run(()=>{this.#l.next(r)})}),this.manager.onRedirect(r=>{this.#d.getCurrentNavigation()||this.#o.run(()=>{let i=r.href.replace(Pe(),"");i.startsWith("#")&&(i=i.slice(1)),this.#d.navigateByUrl(i)})}))}static \u0275fac=function(i){return new(i||t)};static \u0275prov=yr({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()});var it,oa=u(()=>{"use strict";ve();Er();fi();it=t=>(e,r)=>l(null,null,function*(){let i=G(wt),s=G(je),n=Array.isArray(r)?s.getCurrentNavigation()?.extractedUrl.toString():r.url,o=yield i.runGuard(n??location.href,t);return typeof o=="string"?s.parseUrl(o):o})});var aa=u(()=>{"use strict";K();oa();pi();fi();R.init("@badisi/ngx-auth")});var gi=u(()=>{"use strict";aa();});var da,la=u(()=>{da={name:"@badisi/auth-js",version:"1.1.6",description:"Authentication and authorization support for web based desktop and mobile applications.",homepage:"https://github.com/Badisi/auth-js/tree/main/libs/auth-js",license:"GPL-3.0-only",author:"Badisi",repository:{type:"git",url:"https://github.com/Badisi/auth-js"},keywords:["ionic","capacitor","cordova","hybrid","authentication","authorization","oidc","openidconnect","openid","security","identity","oauth2","oauth","auth","authn","web","mobile"],sideEffects:!1,scripts:{lint:"nx run auth-js:lint",test:"nx run auth-js:test","test:ci":"nx run auth-js:test",build:"nx run auth-js:build","build:nx":"npm run build",release:"node ../../scripts/release.mjs --projects=auth-js --verbose","release:dry-run":"npm run release -- --dry-run"},dependencies:{"jwt-decode":"^3.1.2","lodash-es":"^4.17.21","oidc-client-ts":"2.4.0"},devDependencies:{"@types/lodash-es":"^4.17.12","@types/cordova":"^11.0.3"},publishConfig:{access:"public"},exports:{".":{types:"./core/index.d.ts",import:"./esm/core/index.js",require:"./cjs/core/index.js",browser:"./browser/core/index.min.js",default:"./esm/core/index.js"},"./oidc":{types:"./oidc/index.d.ts",import:"./esm/oidc/index.js",require:"./cjs/oidc/index.js",browser:"./browser/oidc/index.min.js",default:"./esm/oidc/index.js"},"./package.json":"./package.json"}}});var ua,ca=u(()=>{ua={name:"@badisi/auth-vue",version:"1.0.7",description:"Authentication and authorization support for Vue.js based desktop and mobile applications.",homepage:"https://github.com/Badisi/auth-js/tree/main/libs/auth-vue",license:"GPL-3.0-only",author:"Badisi",repository:{type:"git",url:"https://github.com/Badisi/auth-js"},keywords:["vue","vue.js","ionic","capacitor","cordova","hybrid","authentication","authorization","oidc","openidconnect","openid","security","identity","oauth2","oauth","auth","authn","web","mobile"],scripts:{lint:"nx run auth-vue:lint",test:"","test:ci":"",build:"nx run auth-vue:build","build:nx":"npm run build",release:"node ../../scripts/release.mjs --projects=auth-vue --verbose","release:dry-run":"npm run release -- --dry-run"},dependencies:{"@badisi/auth-js":"1.1.6"},peerDependencies:{vue:">= 3","vue-router":">= 4"},publishConfig:{access:"public"},exports:{".":{types:"./core/index.d.ts",import:"./esm/core/index.js",require:"./cjs/core/index.js",browser:"./browser/core/index.min.js",default:"./esm/core/index.js"},"./package.json":"./package.json"}}});var pa,ha=u(()=>{pa={name:"@badisi/ngx-auth",version:"4.0.7",description:"Authentication and authorization support for Angular based desktop and mobile applications.",homepage:"https://github.com/Badisi/auth-js/tree/main/libs/ngx-auth",license:"GPL-3.0-only",author:"Badisi",repository:{type:"git",url:"https://github.com/Badisi/auth-js"},keywords:["angular","ionic","capacitor","cordova","hybrid","authentication","authorization","oidc","openidconnect","openid","security","identity","oauth2","oauth","auth","authn","web","mobile"],scripts:{lint:"nx run ngx-auth:lint",test:"nx run ngx-auth:test","test:ci":"nx run ngx-auth:test",build:"nx run ngx-auth:build-lib","build:nx":"npm run build",release:"node ../../scripts/release.mjs --projects=ngx-auth --verbose","release:dry-run":"npm run release -- --dry-run"},dependencies:{"@hug/ngx-schematics-utilities":"^12.0.1","@badisi/auth-js":"1.1.6",tslib:"^2.8.1"},peerDependencies:{"@angular/common":">= 15","@angular/core":">= 15","@angular/router":">= 15",rxjs:"^6.5.3 || ^7.4.0"},publishConfig:{access:"public"},schematics:"./schematics/collection.json","ng-add":{save:"dependencies"}}});var fa,bt,Wu,$u,Gu,ga,hr=u(()=>{"use strict";la();ca();ha();li();fa=[{label:"VanillaJS",demoUrl:"https://badisi.github.io/auth-js/demo-app/auth-js",version:da.version},{label:"Angular",demoUrl:"https://badisi.github.io/auth-js/demo-app/ngx-auth",version:pa.version},{label:"Vue.js",demoUrl:"https://badisi.github.io/auth-js/demo-app/auth-vue",version:ua.version}],bt=H(S({},Z),{automaticInjectToken:{headerName:"Authorization",include:["/api"]}}),Wu={name:"Auth0",otherSettings:{apiUrl:"https://dev-fijd1e9x.us.auth0.com/api/v2/users/auth0|631b171682c639d40cb84d5c",apiHeaders:"",roles:"view-profile"},librarySettings:H(S({},bt),{authorityUrl:"https://dev-fijd1e9x.us.auth0.com",clientId:"kRVVEnAWKMpxxpcodl0TqLXfIHgQvmmt",mobileScheme:"demo-app",loadUserInfo:!0,scope:"openid profile email phone offline_access read:current_user",internal:{extraQueryParams:{audience:"https://dev-fijd1e9x.us.auth0.com/api/v2/"}}})},$u={name:"Zitadel",otherSettings:{apiUrl:"http://localhost:8080/api/my-api",apiHeaders:"",roles:"view-profile"},librarySettings:H(S({},bt),{authorityUrl:"https://auth-js-0pdipf.zitadel.cloud",clientId:"178200751804317953@demo-app",mobileScheme:"demo-app",loadUserInfo:!0,scope:"openid profile email phone offline_access",internal:{extraQueryParams:{login_hint:"demo"}}})},Gu={name:"Keycloak (local)",otherSettings:{apiUrl:"http://localhost:8080/api/my-api",apiHeaders:"",roles:"view-profile"},librarySettings:H(S({},bt),{authorityUrl:"http://localhost:8080/auth/realms/demo",clientId:"demo-app",mobileScheme:"demo-app",loadUserInfo:!0})},ga=(t=!1)=>[Wu,$u,...t?[Gu]:[]]});var ma,mi=u(()=>{"use strict";ur();ma=[{name:"authorityUrl",label:"Authority url",type:"string",required:!0},{name:"clientId",label:"Client id",type:"string",required:!0},{name:"mobileScheme",label:"Custom mobile scheme name",type:"string"},{name:"scope",label:"Scope",type:"string",placeholder:"ex: openid profile email phone offline_access"},{name:"internal.extraQueryParams",label:"Extra query params",type:"json",placeholder:'ex: {"audience":"value"}'},{name:"authGuardFallbackUrl",label:"AuthGuard fallback url",type:"string",placeholder:"ex: forbidden"},{name:"desktopNavigationType",label:"Desktop navigation type",type:"list",values:[{label:"REDIRECT",value:Q.REDIRECT},{label:"POPUP",value:Q.POPUP}]},{name:"logLevel",label:"Log level",type:"list",values:[{label:"NONE",value:O.NONE},{label:"ERROR",value:O.ERROR},{label:"WARN",value:O.WARN},{label:"INFO",value:O.INFO},{label:"DEBUG",value:O.DEBUG}]},{name:"loginRequired",label:"Login required",type:"boolean"},{name:"retrieveUserSession",label:"Retrieve user's session",type:"boolean"},{name:"loadUserInfo",label:"Load user's info",type:"boolean"},{name:"automaticSilentRenew",label:"Automatic silent renew",type:"boolean"},{name:"automaticInjectToken",label:"Automatic inject token",type:"boolean"},{name:"automaticInjectToken.headerName",label:"Header name",type:"string"},{name:"automaticInjectToken.include",label:"Include url(s)",type:"string",placeholder:"ex: http://localhost, /pathname"},{name:"automaticInjectToken.exclude",label:"Exclude url(s)",type:"string",placeholder:"ex: http://localhost, /pathname"},{name:"automaticLoginOn401",label:"Automatic login on 401",type:"boolean"}]});var _a,va=u(()=>{"use strict";hr();mi();_a=class{#e="auth-js:playground:settings";#t=ma;#r;constructor(e){this.#t.forEach((r,i)=>{r._sortIndex=i}),this.#r={currentTabIndex:0,currentSettingsIndex:0,settings:ga(e)}}getLibrarySettingsDefinition(){return this.#t}getLibraryImplementations(){return fa}getSettings(){return this.get().settings}addOrUpdateSettings(e,r=void 0){let i=this.get(),s=r;return r!==void 0?i.settings[r]=e:(i.settings.push(e),s=i.settings.sort((o,a)=>o.name.localeCompare(a.name)).indexOf(e)),this.saveDemoAppSettings(i),s}deleteCurrentSettings(){let e=this.get(),r=e.currentSettingsIndex;r>=0&&r<e.settings.length&&(e.settings.splice(r,1),this.saveDemoAppSettings(e))}setCurrentTabIndex(e){let r=this.get();r.currentTabIndex=e,this.saveDemoAppSettings(r)}setCurrentSettingsIndex(e){let r=this.get();r.currentSettingsIndex=e,this.saveDemoAppSettings(r)}getCurrentSettings(){let e=this.get(),r=e.currentSettingsIndex;return r>=0&&r<e.settings.length?e.settings[r]:e.settings[0]}get(){let e=sessionStorage.getItem(this.#e);if(e){let r=S(S({},this.#r),JSON.parse(e));return this.#r.settings.forEach(i=>{r.settings.find(s=>s.name===i.name)||r.settings.push(i)}),r.settings=r.settings.sort((i,s)=>i.name.localeCompare(s.name)),r}return S({},this.#r)}saveDemoAppSettings(e){delete e.librarySettingsDefinition,sessionStorage.setItem(this.#e,JSON.stringify(e))}}});var zu,Ju,ba,Ey,Ay,St,xt,Ku,Xu,Qu,pr,xa,ky,fr,ya,wa,_i,Iy,Yu,Zu,eh,th,vi,Ty,Sa=u(()=>{"use strict";zu=t=>{let e=new Map;e.set("web",{name:"web"});let r=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},i=(n,o)=>{r.platforms.set(n,o)},s=n=>{r.platforms.has(n)&&(r.currentPlatform=r.platforms.get(n))};return r.addPlatform=i,r.setPlatform=s,r},Ju=t=>t.CapacitorPlatforms=zu(t),ba=Ju(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Ey=ba.addPlatform,Ay=ba.setPlatform,St=(function(t){return t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE",t})(St||{}),xt=class extends Error{constructor(e,r,i){super(e),this.message=e,this.code=r,this.data=i}},Ku=t=>{var e,r;return t?.androidBridge?"android":!((r=(e=t?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},Xu=t=>{var e,r,i,s,n;let o=t.CapacitorCustomPlatform||null,a=t.Capacitor||{},d=a.Plugins=a.Plugins||{},c=t.CapacitorPlatforms,p=()=>o!==null?o.name:Ku(t),f=((e=c?.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||p,m=()=>f()!=="web",g=((r=c?.currentPlatform)===null||r===void 0?void 0:r.isNativePlatform)||m,y=b=>{let E=v.get(b);return!!(E?.platforms.has(f())||h(b))},A=((i=c?.currentPlatform)===null||i===void 0?void 0:i.isPluginAvailable)||y,T=b=>{var E;return(E=a.PluginHeaders)===null||E===void 0?void 0:E.find(D=>D.name===b)},h=((s=c?.currentPlatform)===null||s===void 0?void 0:s.getPluginHeader)||T,_=b=>t.console.error(b),w=(b,E,D)=>Promise.reject(`${D} does not have an implementation of "${E}".`),v=new Map,k=(b,E={})=>{let D=v.get(b);if(D)return console.warn(`Capacitor plugin "${b}" already registered. Cannot register plugins twice.`),D.proxy;let N=f(),M=h(b),B,Ie=()=>l(null,null,function*(){return!B&&N in E?B=typeof E[N]=="function"?B=yield E[N]():B=E[N]:o!==null&&!B&&"web"in E&&(B=typeof E.web=="function"?B=yield E.web():B=E.web),B}),st=(V,j)=>{var ee,me;if(M){let _e=M?.methods.find(Y=>j===Y.name);if(_e)return _e.rtype==="promise"?Y=>a.nativePromise(b,j.toString(),Y):(Y,Et)=>a.nativeCallback(b,j.toString(),Y,Et);if(V)return(ee=V[j])===null||ee===void 0?void 0:ee.bind(V)}else{if(V)return(me=V[j])===null||me===void 0?void 0:me.bind(V);throw new xt(`"${b}" plugin is not implemented on ${N}`,St.Unimplemented)}},ge=V=>{let j,ee=(...me)=>{let _e=Ie().then(Y=>{let Et=st(Y,V);if(Et){let At=Et(...me);return j=At?.remove,At}else throw new xt(`"${b}.${V}()" is not implemented on ${N}`,St.Unimplemented)});return V==="addListener"&&(_e.remove=()=>l(null,null,function*(){return j()})),_e};return ee.toString=()=>`${V.toString()}() { [capacitor code] }`,Object.defineProperty(ee,"name",{value:V,writable:!1,configurable:!1}),ee},Ne=ge("addListener"),Ct=ge("removeListener"),gr=(V,j)=>{let ee=Ne({eventName:V},j),me=()=>l(null,null,function*(){let Y=yield ee;Ct({eventName:V,callbackId:Y},j)}),_e=new Promise(Y=>ee.then(()=>Y({remove:me})));return _e.remove=()=>l(null,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield me()}),_e},mr=new Proxy({},{get(V,j){switch(j){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return M?gr:Ne;case"removeListener":return Ct;default:return ge(j)}}});return d[b]=mr,v.set(b,{name:b,proxy:mr,platforms:new Set([...Object.keys(E),...M?[N]:[]])}),mr},C=((n=c?.currentPlatform)===null||n===void 0?void 0:n.registerPlugin)||k;return a.convertFileSrc||(a.convertFileSrc=b=>b),a.getPlatform=f,a.handleError=_,a.isNativePlatform=g,a.isPluginAvailable=A,a.pluginMethodNoop=w,a.registerPlugin=C,a.Exception=xt,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},Qu=t=>t.Capacitor=Xu(t),pr=Qu(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),xa=pr.registerPlugin,ky=pr.Plugins,fr=class{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,r){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(r);let s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s);let n=()=>l(this,null,function*(){return this.removeListener(e,r)}),o=Promise.resolve({remove:n});return Object.defineProperty(o,"remove",{value:()=>l(this,null,function*(){console.warn("Using addListener() without 'await' is deprecated."),yield n()})}),o}removeAllListeners(){return l(this,null,function*(){this.listeners={};for(let e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}})}notifyListeners(e,r){let i=this.listeners[e];i&&i.forEach(s=>s(r))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,r){this.windowListeners[r]={registered:!1,windowEventName:e,pluginEventName:r,handler:i=>{this.notifyListeners(r,i)}}}unimplemented(e="not implemented"){return new pr.Exception(e,St.Unimplemented)}unavailable(e="not available"){return new pr.Exception(e,St.Unavailable)}removeListener(e,r){return l(this,null,function*(){let i=this.listeners[e];if(!i)return;let s=i.indexOf(r);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])})}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}},ya=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),wa=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent),_i=class extends fr{getCookies(){return l(this,null,function*(){let e=document.cookie,r={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[s,n]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=wa(s).trim(),n=wa(n).trim(),r[s]=n}),r})}setCookie(e){return l(this,null,function*(){try{let r=ya(e.key),i=ya(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${r}=${i||""}${s}; path=${n}; ${o};`}catch(r){return Promise.reject(r)}})}deleteCookie(e){return l(this,null,function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}})}clearCookies(){return l(this,null,function*(){try{let e=document.cookie.split(";")||[];for(let r of e)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})}clearAllCookies(){return l(this,null,function*(){try{yield this.clearCookies()}catch(e){return Promise.reject(e)}})}},Iy=xa("CapacitorCookies",{web:()=>new _i}),Yu=t=>l(null,null,function*(){return new Promise((e,r)=>{let i=new FileReader;i.onload=()=>{let s=i.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},i.onerror=s=>r(s),i.readAsDataURL(t)})}),Zu=(t={})=>{let e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,n,o)=>(s[n]=t[e[o]],s),{})},eh=(t,e=!0)=>t?Object.entries(t).reduce((i,s)=>{let[n,o]=s,a,d;return Array.isArray(o)?(d="",o.forEach(c=>{a=e?encodeURIComponent(c):c,d+=`${n}=${a}&`}),d.slice(0,-1)):(a=e?encodeURIComponent(o):o,d=`${n}=${a}`),`${i}&${d}`},"").substr(1):null,th=(t,e={})=>{let r=Object.assign({method:t.method||"GET",headers:t.headers},e),s=Zu(t.headers)["content-type"]||"";if(typeof t.data=="string")r.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){let n=new URLSearchParams;for(let[o,a]of Object.entries(t.data||{}))n.set(o,a);r.body=n.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){let n=new FormData;if(t.data instanceof FormData)t.data.forEach((a,d)=>{n.append(d,a)});else for(let a of Object.keys(t.data))n.append(a,t.data[a]);r.body=n;let o=new Headers(r.headers);o.delete("content-type"),r.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(r.body=JSON.stringify(t.data));return r},vi=class extends fr{request(e){return l(this,null,function*(){let r=th(e,e.webFetchExtra),i=eh(e.params,e.shouldEncodeUrlParams),s=i?`${e.url}?${i}`:e.url,n=yield fetch(s,r),o=n.headers.get("content-type")||"",{responseType:a="text"}=n.ok?e:{};o.includes("application/json")&&(a="json");let d,c;switch(a){case"arraybuffer":case"blob":c=yield n.blob(),d=yield Yu(c);break;case"json":d=yield n.json();break;case"document":case"text":default:d=yield n.text()}let p={};return n.headers.forEach((f,m)=>{p[m]=f}),{data:d,headers:p,status:n.status,url:n.url}})}get(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))})}post(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))})}put(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))})}patch(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})}delete(e){return l(this,null,function*(){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})}},Ty=xa("CapacitorHttp",{web:()=>new vi})});var Oe,Ca,le,Ue=u(()=>{"use strict";Sa();Oe=(t,e=[])=>{let r=/^( *)("[\w-]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/mg,i=(s,n,o,a,d)=>{let c=n||"",p=o?o.replace(/[": ]/g,""):void 0;if(p&&(c+=`<span class="json-key">${p}</span>: `),a&&(c+=`<span class="${a.startsWith('"')?"json-string":"json-value"}">${a}</span>`,p&&e.includes(p))){let f=new Date(Number(a)*1e3),m=`${f.toDateString()}, ${f.toLocaleTimeString()}`;m&&(c+=` <span class="json-date">(${m})</span>`)}return c+(d||"")};return t?JSON.stringify(t,null,2).replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(r,i):""},Ca=()=>(t,e)=>{let{otherSettings:r,librarySettings:i}=window.appSettings.getCurrentSettings(),s=r?(r.roles??"").split(","):[],n;if(i.authorityUrl.includes("auth0"))n=e["http://ngx-auth.com/roles"];else if(i.authorityUrl.includes("zitadel")){let a=e["urn:zitadel:iam:org:project:roles"];n=Object.keys(a??{})}else n=e?.resource_access?.account?.roles;return s.every(a=>(n??[]).includes(a))?!0:"forbidden"},le=`
    .flex {
        flex: 1;
    }

    .hidden {
        display: none !important;
    }

    .row {
        display: flex;
        flex-direction: row;
    }

    .column {
        display: flex;
        flex-direction: column;
    }

    .card {
        border: 1px solid rgba(0, 0, 0, 0.12);
        border-radius: 4px;
        background-color: white;
        margin: 12px 6px;
    }

    .card .card-status {
        display: block;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-left: 8px;
        background-color: #f2f2f2;
    }
    .card .card-status.error {
        background-color: #ef5350;
    }
    .card .card-status.success {
        background-color: #66bb6a;
    }

    .card .card-title {
        padding: 16px;
        font-size: 20px;
        font-weight: 500;
        color: rgba(0, 0, 0, 0.87);
        align-items: center;
    }

    .card .box {
        height: 200px;
        border-top: 1px solid lightgray;
        word-break: break-all;
        overflow: auto;
        background-color: #f2f2f2;
        padding: 12px;
    }
    .card .box pre {
        margin: 0;
    }

    .card .card-actions {
        padding: 0 14px 8px 14px;
        min-height: 50px;
    }
    .card .card-actions .input {
        display: flex;
        align-items: center;
    }
    .card .card-actions .input:not(:last-child) {
        margin-bottom: 8px;
    }
    .card .card-actions .input label {
        width: 125px;
        text-align: right;
        margin-right: 14px;
    }
    .card .card-actions .input input {
        padding: 4px;
    }

    .json-key {
        color: rgb(124, 77, 255);
    }

    .json-value {
        color: rgb(67, 122, 237);
    }

    .json-string {
        color: rgb(83, 160, 83);
    }

    .json-date {
        color: rgb(200, 56, 198);
    }

    input {
        color: #5e35b1;
        padding: 10px;
        border: 1px solid #0000001f;
        border-radius: 4px;
        font-size: 14px;
    }

    input:invalid {
        border-color: #f44336;
    }

    input[type="checkbox"] {
        margin-right: 10px;
    }

    select {
        color: #5e35b1;
        padding: 8px 6px;
        border: 1px solid #0000001f;
        border-radius: 4px;
    }

    button {
        cursor: pointer;
    }

    @media only screen and (max-width: 600px) {
        :host {
            padding: 0 !important;
            padding-bottom: 24px !important;
        }

        :host .card {
            border-left: 0;
            border-right: 0;
            border-radius: 0;
            margin: 0;
            margin-bottom: 6px;
        }
    }
`});var Ea,yi,Aa=u(()=>{"use strict";Ue();Ea=document.createElement("template");Ea.innerHTML=`
    <style>
        ${le}

        :host {
            display: flex;
            flex: 1;
            flex-direction: column;
            padding: 20px 28px;
        }

        :host .info {
            margin: 16px;
        }

        :host .info .title {
            min-width: 130px;
        }

        :host .info .value {
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        :host .info code {
            width: 100%;
        }
    </style>

    <div class="card">
        <div class="info column">
            <div class="title">Authenticated</div>
            <code>
                <pre id="isAuthenticated" class="value json-value"></pre>
            </code>
        </div>

        <div class="info column">
            <div class="title">User session</div>
            <code>
                <pre id="userSession" class="value"></pre>
            </code>
        </div>

        <div class="info column">
            <div class="title">User profile</div>
            <code>
                <pre id="userProfile" class="value"></pre>
            </code>
        </div>

        <div class="info column">
            <div class="title">Access token</div>
            <code>
                <pre id="accessToken" class="value json-value"></pre>
                <pre id="accessTokenDecoded" class="value"></pre>
            </code>
        </div>

        <div class="info column">
            <div class="title">Id token</div>
            <code>
                <pre id="idToken" class="value json-value"></pre>
                <pre id="idTokenDecoded" class="value"></pre>
            </code>
        </div>
    </div>
`;yi=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot?.appendChild(document.importNode(Ea.content,!0)),this.isAuthenticated=!1,this.userSession=void 0,this.accessToken=void 0,this.accessTokenDecoded=void 0,this.idToken=void 0,this.idTokenDecoded=void 0,this.userProfile=void 0}set isAuthenticated(e){e!==null&&this.update("#isAuthenticated",typeof e=="boolean"?String(e):e)}set userSession(e){this.update("#userSession",Oe(e,["expires_at"]))}set accessToken(e){this.update("#accessToken",e)}set accessTokenDecoded(e){let r=typeof e!="string"?Oe(e,["exp","iat","auth_time"]):"(no decoded info as it is not a JWT token)";this.update("#accessTokenDecoded",r)}set idToken(e){this.update("#idToken",e)}set idTokenDecoded(e){this.update("#idTokenDecoded",Oe(e,["exp","iat","auth_time"]))}set userProfile(e){this.update("#userProfile",Oe(e))}connectedCallback(){}disconnectedCallback(){}update(e,r){let i=this.shadowRoot?.querySelector(e);i&&(r==null||r===""?i.closest(".info")?.classList.add("hidden"):(i.closest(".info")?.classList.remove("hidden"),i.innerHTML=r))}};window.customElements.define("demo-app-debug",yi)});var ka,wi,Ia=u(()=>{"use strict";Ue();ka=document.createElement("template");ka.innerHTML=`
    <style>
        ${le}

        :host header {
            z-index: 1;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: calc(8px + var(--safe-area-inset-top)) 16px 30px 16px;
            align-items: center;
            justify-content: space-between;
            height: 142px;
            color: white;
            background: rgb(103, 58, 183);
            background: linear-gradient(180deg, rgba(103, 58, 183, 1) 0%, rgba(94, 53, 177, 1) 100%);
        }

        :host header .row {
            align-items: center;
        }

        :host header .row.top {
            width: 100%;
            gap: 14px;
        }

        :host header .row.select {
            font-size: 1.4em;
            color: #ede7f6;
            padding-bottom: 4px;
        }

        :host header h1 {
            font-size: 18px;
            font-weight: 200;
            letter-spacing: 1px;
            color: #ede7f6;
            margin: 0;
            text-transform: uppercase;
        }

        :host header a.doc {
            padding: 4px 16px;
            font-size: 16px;
            color: white;
            text-decoration: none;
        }

        :host header a.github-icon {
            right: 34px;
            width: 26px;
            height: 26px;
            color: white;
            text-decoration: none;
        }

        @keyframes statusLoadingAnimation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        :host header .status.loading {
            background: none !important;
        }

        :host header .status.loading:after {
            display: block;
            content: " ";
            width: 11px;
            height: 11px;
            border-radius: 50%;
            border: 2px solid #fff;
            border-color: #fff transparent #fff transparent;
            animation: statusLoadingAnimation 1.2s linear infinite;
        }

        :host header .status.not-authenticated {
            background-color: #EC407A;
        }

        :host header .status.authenticated {
            background-color: #7CB342;
        }

        :host header .status {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-top: 1px;
            margin-right: 8px;
        }

        :host header .title {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }

        :host header .title .icon {
            font-size: 22px;
            margin-right: 0.5rem;
        }

        :host header select {
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            color: #ede7f6;
            background: rgba(0, 0, 0, 0.01);  /** fix for Safari Mobile so that select's icon is visible */
            border: none;
            outline: none;
            padding: 0;
            margin: 0;
        }

        :host header button {
            margin-top: 2px;
        }

        :host header button:not(:last-child) {
            margin-right: 10px;
        }

        :host header .content {
            align-items: center;
            gap: 10px;
        }

        @media only screen and (max-width: 1000px) {
            :host header {
                padding-bottom: 24px;
                height: 148px;
            }

            :host header .row.select {
                font-size: 1.1em;
            }

            :host header a.doc {
                padding-right: 6px;
            }

            :host header .content {
                gap: 2px;
            }
        }
    </style>

    <header class="column">
        <div class="row top" style="height: 44px;">
            <a class="title"
                href="https://badisi.github.io/auth-js/"
                target="_self">
                <span class="icon">\u{1F6E1}\uFE0F</span>Auth-js
            </a>

            <div class="status loading"></div>

            <span style="flex: 1"></span>

            <a class="doc"
                href="https://badisi.github.io/auth-js/getting-started/playground"
                target="_self">
                <span>
                    Documentation
                    <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path>
                    </svg>
                </span>
            </a>

            <a class="github-icon"
                href="https://github.com/Badisi/auth-js"
                target="_self"
                title="View it on GitHub"
                aria-label="GitHub repository">
                <span>
                    <svg viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill="currentColor"
                            d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12">
                        </path>
                    </svg>
                </span>
            </a>
        </div>

        <div class="column content">
            <h1>Playground</h1>

            <div class="row select">
                <span>&#123;&nbsp;<select id="implementation-select"></select>&nbsp;&#125;</span>
                &nbsp;&nbsp;
                <span>&#123;&nbsp;<select id="setting-select"></select>&nbsp;&#125;</span>
            </div>

            <div class="row">
                <button id="login-button">LOGIN</button>
                <button id="logout-button">LOGOUT</button>
                <button id="silent-renew-button">SILENT RENEW</button>
            </div>
        </div>
    </header>
`;wi=class extends HTMLElement{listeners=[];implSelectEl;settingsSelectEl;statusEl;loginButtonEl;logoutButtonEl;silentRenewButtonEl;constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot?.appendChild(document.importNode(ka.content,!0)),this.implSelectEl=this.shadowRoot?.querySelector("#implementation-select"),this.settingsSelectEl=this.shadowRoot?.querySelector("#setting-select"),this.statusEl=this.shadowRoot?.querySelector(".status"),this.loginButtonEl=this.shadowRoot?.querySelector("#login-button"),this.logoutButtonEl=this.shadowRoot?.querySelector("#logout-button"),this.silentRenewButtonEl=this.shadowRoot?.querySelector("#silent-renew-button")}set isRenewing(e){this.statusEl&&this.statusEl.classList[e?"add":"remove"]("loading")}set isAuthenticated(e){this.statusEl&&e!==null&&e!==void 0&&(this.statusEl.classList.remove("loading"),this.statusEl.title=e?"Authenticated":"Not authenticated",this.statusEl.classList[e?"add":"remove"]("authenticated"),this.statusEl.classList[e?"remove":"add"]("not-authenticated"))}connectedCallback(){if(window.location.href.includes(":4200")){let r=document.createElement("option");r.textContent="localhost",this.implSelectEl?.appendChild(r)}else{window.appSettings.getLibraryImplementations().forEach(i=>{let s=document.createElement("option");s.value=i.label,s.textContent=i.label,this.implSelectEl?.appendChild(s)});let r=()=>{let i=this.implSelectEl?.selectedIndex;i!==void 0&&(window.location.href=window.appSettings.getLibraryImplementations()[i].demoUrl)};this.implSelectEl?.addEventListener("change",r),this.listeners.push(()=>{this.implSelectEl?.removeEventListener("change",r)})}window.appSettings.getSettings().forEach(r=>{let i=document.createElement("option");i.value=r.name,i.textContent=r.name,this.settingsSelectEl?.appendChild(i)}),this.refreshImplementation(),this.refreshSettings(),this.addEventListeners();let e=r=>{let i=r.options[r.selectedIndex].text||"",s=document.createElement("span");s.textContent=i;let n=window.getComputedStyle(r);s.style.font=n.font,s.style.fontSize=n.fontSize,s.style.fontFamily=n.fontFamily,s.style.fontWeight=n.fontWeight,s.style.letterSpacing=n.letterSpacing,s.style.whiteSpace="nowrap",s.style.position="absolute",s.style.visibility="hidden",s.style.top="-9999px",document.body.appendChild(s);let o=s.offsetWidth;s.remove();let a=/iP(hone|ad|od)/.test(navigator.userAgent)&&!!/WebKit/.exec(navigator.userAgent)&&!/CriOS|FxiOS/.exec(navigator.userAgent)?40:navigator.userAgent.includes("Chrome")?25:35,d=Math.ceil(o+a);r.style.width=`${d}px`};window.requestAnimationFrame(()=>{this.implSelectEl&&e(this.implSelectEl),this.settingsSelectEl&&e(this.settingsSelectEl)})}disconnectedCallback(){this.listeners.forEach(e=>{e()})}addEventListeners(){let e=()=>{this.settingsSelectEl&&(window.appSettings.setCurrentSettingsIndex(this.settingsSelectEl.selectedIndex),location.reload())};this.settingsSelectEl?.addEventListener("change",e);let r=()=>this.dispatchEvent(new Event("login",{bubbles:!0,composed:!0}));this.loginButtonEl?.addEventListener("click",r);let i=()=>this.dispatchEvent(new Event("logout",{bubbles:!0,composed:!0}));this.logoutButtonEl?.addEventListener("click",i);let s=()=>this.dispatchEvent(new Event("silentRenew",{bubbles:!0,composed:!0}));this.silentRenewButtonEl?.addEventListener("click",s),this.listeners.push(()=>{this.settingsSelectEl?.removeEventListener("change",e)},()=>{this.loginButtonEl?.removeEventListener("click",r)},()=>{this.logoutButtonEl?.removeEventListener("click",i)},()=>{this.silentRenewButtonEl?.removeEventListener("click",s)})}refreshImplementation(){let e=window.appSettings.getLibraryImplementations();if(window.location.href.includes(":4200"))this.implSelectEl&&(this.implSelectEl.selectedIndex=0);else{let r=e.findIndex(i=>window.location.href.includes(i.demoUrl));this.implSelectEl&&(this.implSelectEl.selectedIndex=r!==-1?r:0)}}refreshSettings(){this.settingsSelectEl&&(this.settingsSelectEl.selectedIndex=window.appSettings.get().currentSettingsIndex)}};window.customElements.define("demo-app-header",wi)});var Ta,bi,Ra=u(()=>{"use strict";Ue();Ta=document.createElement("template");Ta.innerHTML=`
    <style>
        ${le}

        :host .tabs {
            position: fixed;
            top: calc(180px + var(--safe-area-inset-top));
            left: 0;
            right: 0;
            z-index: 1;
            align-self: normal;
            padding: 10px 0;
            padding-left: 36px;
            background-color: #7043bf;
            box-shadow: 0 3px 5px -1px #0003, 0 6px 10px #00000024, 0 1px 18px #0000001f;
        }

        :host .tabs a {
            cursor: pointer;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 150ms cubic-bezier(0.35, 0, 0.25, 1);
        }

        :host .tabs a.selected {
            background-color: #512da8;
        }

        :host .tabs a:hover {
            background-color: #4527a0;
        }

        :host .tabs a:not(:last-child) {
            margin-right: 10px;
        }

        :host .tabs-content {
            position: fixed;
            top: calc(180px + 55px + var(--safe-area-inset-top));
            left: 0;
            right: 0;
            bottom: calc(0px + var(--safe-area-inset-bottom));
            overflow: auto;
        }

        @media only screen and (max-width: 600px) {
            :host .tabs {
                padding-left: 0;
                justify-content: center;
            }
        }
    </style>

    <demo-app-header></demo-app-header>
    <nav id="tabs" class="tabs row"></nav>
    <div class="tabs-content">
        <slot id="views"></slot>
    </div>
`;bi=class extends HTMLElement{listeners=[];tabsContentEl;demoAppHeaderEl;tabs=[];views=[];currentTabIndex=-1;constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot?.appendChild(document.importNode(Ta.content,!0)),this.tabsContentEl=this.shadowRoot?.querySelector(".tabs-content"),this.demoAppHeaderEl=this.shadowRoot?.querySelector("demo-app-header")}set isRenewing(e){this.demoAppHeaderEl&&(this.demoAppHeaderEl.isRenewing=e)}set isAuthenticated(e){this.demoAppHeaderEl&&(this.demoAppHeaderEl.isAuthenticated=e)}connectedCallback(){this.drawTabs(),this.showView(window.appSettings.get().currentTabIndex)}disconnectedCallback(){this.listeners.forEach(e=>{e()})}drawTabs(){let e=this.shadowRoot?.querySelector("#views"),r=this.shadowRoot?.querySelector("#tabs");e&&r&&(this.views=e.assignedElements(),this.views.forEach((i,s)=>{i.style.display="none";let n=document.createElement("a");n.id=`${(i.getAttribute("tabLabel")??"?").toLowerCase()}-button`,n.textContent=i.getAttribute("tabLabel")??"?";let o=()=>{this.showView(s)};n.addEventListener("click",o),this.listeners.push(()=>{n.removeEventListener("click",o)}),r.appendChild(n),this.tabs.push(n)}))}showView(e){this.currentTabIndex!==e&&(this.currentTabIndex=e,this.tabs.forEach((r,i)=>{r.classList[i!==e?"remove":"add"]("selected")}),this.views.forEach((r,i)=>{r.style.display=i!==e?"none":"flex"}),this.tabsContentEl?.scrollTo(0,0),window.appSettings.setCurrentTabIndex(e))}};window.customElements.define("demo-app-main",bi)});var Da,xi,Pa=u(()=>{"use strict";Ue();Da=document.createElement("template");Da.innerHTML=`
    <style>
        ${le}

        :host {
            display: flex;
            flex: 1;
            flex-direction: column;
            padding: 20px 28px;
        }

        :host .card.apis input {
            width: 100%; /* fix for android-chrome */
        }

        :host .card.apis .card-actions {
            padding-bottom: 16px;
        }

        :host .card.apis .card-actions button {
            margin-left: 14px;
        }

        :host .card.routes {
            margin-top: 20px;
        }

        :host .card.routes .route {
            display: flex;
            align-items: center;
        }

        :host .card.routes .route.query-params {
            margin: 0 0 10px 10px;
        }

        :host .card.routes .route.query-params .info {
            display: flex;
            flex-direction: row;
        }

        :host .card.routes .route.query-params .info .text {
            font-size: 16px;
            color: black;
            margin-right: 12px;
        }

        :host .card.routes .route.query-params .info input {
            width: 500px;
        }

        :host .card.routes .route button {
            padding: 2px 10px;
            min-width: 104px;
            margin: 8px 12px 8px 8px;
        }

        :host .card.routes .route input {
            margin: 0 2px;
            padding: 4px;
        }

        :host .card.routes .route .info {
            padding-bottom: 2px;
            font-size: 14px;
            line-height: 22px;
            text-align: left;
            color: #0000008a;
        }

        :host .card.routes .box {
            height: 100px;
        }

        @media only screen and (max-width: 600px) {
            :host .card.apis .card-actions {
                flex-direction: column;
                margin-left: 3px;
            }
            :host .card.apis .card-actions button {
                margin-top: 12px;
                margin-left: 0;
                padding: 2px 10px;
                min-width: 104px;
                align-self: flex-start;
            }
            :host .card.apis .input label {
                text-align: left;
            }
            :host .card.apis .input {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            :host .card.apis input {
                width: inherit;
                align-self: normal;
            }

            :host .card.routes {
                margin-top: 12px;
            }
            :host .card.routes .route {
                margin-left: 3px !important;
            }
            :host .card.routes .route.query-params .info {
                display: flex;
                flex-direction: column;
                flex: 1;
                gap: 8px;
            }
            :host .card.routes .route.query-params .info input {
                margin: 0;
                width: inherit;
                align-self: normal;
            }
            :host .card.routes .route #roles-input {
                width: 90%;
            }
            :host .card.routes .route button {
                margin-left: 3px;
            }
        }
    </style>

    <div class="card apis">
        <div class="card-title row">
            APIs access
            <div id="api-status" class="card-status"></div>
        </div>
        <div class="card-actions row">
            <div class="column flex">
                <div class="input row">
                    <label for="api-url-input">Url</label>
                    <input id="api-url-input" class="flex" />
                </div>
                <div class="input row">
                    <label for="api-headers-input">Custom headers</label>
                    <input id="api-headers-input" class="flex" placeholder='ex: name1:one, name2=two' />
                </div>
            </div>
            <button id="api-get-button">GET</button>
        </div>
        <div class="box">
            <code>
                <pre id="api-response"></pre>
            </code>
        </div>
    </div>

    <div class="card routes">
        <div class="card-title">
            Guards access
        </div>
        <div class="card-actions column">
            <div class="route query-params">
                <div class="info">
                    <div class="text">Query params</div>
                    <input
                        id="guards-query-params-input"
                        placeholder="ex: param1=one&param2=two" />
                </div>
            </div>
            <div class="route">
                <button id="guards-home-button">HOME</button>
                <div class="info">Home page</div>
            </div>
            <div class="route">
                <button id="guards-public-button">PUBLIC</button>
                <div class="info">Public content (no login required)</div>
            </div>
            <div class="route">
                <button id="guards-private-button">PRIVATE</button>
                <div class="info">Private content (login required)</div>
            </div>
            <div class="route">
                <button id="guards-protected-button">PROTECTED</button>
                <div class="info">
                    Protected content (login required + role(s):<input id="guards-roles-input" />)
                </div>
            </div>
        </div>
        <div class="box">
            <slot id="cards"></slot>
        </div>
    </div>
`;xi=class extends HTMLElement{listeners=[];apiStatusEl;apiResponseEl;apiUrlEl;apiHeadersEl;apiBtnEl;guardsHomeBtnEl;guardsPublicBtnEl;guardsPrivateBtnEl;guardsProtectedBtnEl;guardsQueryParamsEl;guardsRolesEl;constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot?.appendChild(document.importNode(Da.content,!0)),this.apiStatusEl=this.shadowRoot?.querySelector("#api-status"),this.apiResponseEl=this.shadowRoot?.querySelector("#api-response"),this.apiUrlEl=this.shadowRoot?.querySelector("#api-url-input"),this.apiHeadersEl=this.shadowRoot?.querySelector("#api-headers-input"),this.apiBtnEl=this.shadowRoot?.querySelector("#api-get-button"),this.guardsHomeBtnEl=this.shadowRoot?.querySelector("#guards-home-button"),this.guardsPublicBtnEl=this.shadowRoot?.querySelector("#guards-public-button"),this.guardsPrivateBtnEl=this.shadowRoot?.querySelector("#guards-private-button"),this.guardsProtectedBtnEl=this.shadowRoot?.querySelector("#guards-protected-button"),this.guardsQueryParamsEl=this.shadowRoot?.querySelector("#guards-query-params-input"),this.guardsRolesEl=this.shadowRoot?.querySelector("#guards-roles-input")}connectedCallback(){let e=m=>{if("key"in m&&m.key!=="Enter")return!0;{let g=this.apiHeadersEl?.value.split(",").reduce((A,T)=>{if(T){let h=/^"?([^"]*)"?$/,_=T.split(":"),w=h.exec(_[0]?.trim())?.[1]??"",v=h.exec(_[1]?.trim())?.[1]??"";w&&(A[w]=v)}return A},{}),y=new CustomEvent("api",{bubbles:!0,composed:!0,detail:{url:this.apiUrlEl?.value,headers:g}});return this.dispatchEvent(y)}};this.apiBtnEl?.addEventListener("click",e),this.apiUrlEl?.addEventListener("keydown",e),this.apiHeadersEl?.addEventListener("keydown",e);let r=()=>{this.saveSettings({apiUrl:this.apiUrlEl?.value})};this.apiUrlEl?.addEventListener("input",r);let i=()=>{this.saveSettings({apiHeaders:this.apiHeadersEl?.value})};this.apiHeadersEl?.addEventListener("input",i);let s=()=>{this.saveSettings({queryParams:this.guardsQueryParamsEl?.value})};this.guardsQueryParamsEl?.addEventListener("input",s);let n=()=>{this.saveSettings({roles:this.guardsRolesEl?.value})};this.guardsRolesEl?.addEventListener("input",n);let o=m=>{let g={};return this.guardsQueryParamsEl?.value.split("&").forEach(y=>{let A=y.split("=");A.length===2&&(g[A[0]]=A[1])}),this.dispatchEvent(new CustomEvent(m,{bubbles:!0,composed:!0,detail:{queryParams:g}}))},a=()=>o("home");this.guardsHomeBtnEl?.addEventListener("click",a);let d=()=>o("public");this.guardsPublicBtnEl?.addEventListener("click",d);let c=()=>o("private");this.guardsPrivateBtnEl?.addEventListener("click",c);let p=m=>"key"in m&&m.key!=="Enter"?!0:o("protected");this.guardsProtectedBtnEl?.addEventListener("click",p),this.guardsRolesEl?.addEventListener("keydown",p),this.listeners.push(()=>this.apiBtnEl?.removeEventListener("click",e),()=>this.apiUrlEl?.removeEventListener("keydown",e),()=>this.apiHeadersEl?.removeEventListener("keydown",e),()=>this.apiUrlEl?.removeEventListener("input",r),()=>this.apiHeadersEl?.removeEventListener("input",i),()=>this.guardsQueryParamsEl?.removeEventListener("input",s),()=>this.guardsRolesEl?.removeEventListener("input",n),()=>this.guardsHomeBtnEl?.removeEventListener("click",a),()=>this.guardsPrivateBtnEl?.removeEventListener("click",c),()=>this.guardsProtectedBtnEl?.removeEventListener("click",p),()=>this.guardsRolesEl?.removeEventListener("keydown",p));let{otherSettings:f}=window.appSettings.getCurrentSettings();this.apiUrlEl&&(this.apiUrlEl.value=f?.apiUrl??""),this.apiHeadersEl&&(this.apiHeadersEl.value=f?.apiHeaders??""),this.guardsQueryParamsEl&&(this.guardsQueryParamsEl.value=f?.queryParams??""),this.guardsRolesEl&&(this.guardsRolesEl.value=f?.roles??"")}disconnectedCallback(){this.listeners.forEach(e=>{e()})}setApiStatus(e,r){this.apiStatusEl?.classList.remove(r?"success":"error"),this.apiStatusEl?.classList.add(r?"error":"success"),this.apiResponseEl&&(this.apiResponseEl.innerHTML=Oe(e))}saveSettings(e){let r=window.appSettings.getCurrentSettings();r.otherSettings=S(S({},r.otherSettings),e),window.appSettings.addOrUpdateSettings(r)}};window.customElements.define("demo-app-playground",xi)});var Ma,Si,Va=u(()=>{"use strict";Ue();hr();Ma=document.createElement("template");Ma.innerHTML=`
    <style>
        ${le}

        :host {
            display: flex;
            flex: 1;
            flex-direction: column;
            padding: 20px 28px;
        }

        :host .card {
            padding: 40px 16px 16px 16px;
        }

        :host form {
            position: relative;
        }

        :host form .input, :host .form-content > * {
            margin-bottom: 24px;
        }

        :host form div:has(#automaticInjectToken:not(:checked)) > div:has(#automaticInjectTokenheaderName),
        :host form div:has(#automaticInjectToken:not(:checked)) > div:has(#automaticInjectTokeninclude),
        :host form div:has(#automaticInjectToken:not(:checked)) > div:has(#automaticInjectTokenexclude) {
            label {
                color: lightgray;
            }
            input {
                opacity: 50%;
            }
        }

        :host form div.input:has(#automaticInjectTokenheaderName),
        :host form div.input:has(#automaticInjectTokeninclude),
        :host form div.input:has(#automaticInjectTokenexclude) {
            flex-direction: row;
            align-items: center;
            margin-left: 32px;

            label {
                margin-bottom: 0;
                margin-right: 8px;
            }

            input {
                flex: 1;
            }
        }

        :host form label {
            margin-bottom: 8px;
        }

        :host .form-actions {
            z-index: 10;
            position: fixed;
            bottom: calc(12px + var(--safe-area-inset-bottom));
            left: calc(50% - 120px);
            padding: 14px 0;
            border-radius: 4px;
            background-color: #E0E0E0;
            width: 240px;
            justify-content: center;
        }

        :host .form-actions button {
            padding: 2px 12px;
        }

        :host .form-actions button:not(:last-of-type) {
            margin-right: 12px;
        }

        :host button {
            cursor: pointer;
        }

        :host #setting-select {
            margin-left: 6px;
            color: black;
        }

        :host #add-settings-button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            color: darkgray;
        }

        :host #delete-settings-button {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            color: #EF5350;
        }

        :host #save-settings-button {
            color: white;
            padding: 4px 24px;
            border: none;
            border-radius: 4px;
            transition: background-color 150ms cubic-bezier(0.35, 0, 0.25, 1);
            background-color: #512da8;
        }

        :host #cancel-settings-button {
            padding: 4px 18px;
            border: none;
            border-radius: 4px;
            transition: background-color 150ms cubic-bezier(0.35, 0, 0.25, 1);
            background-color: white;
        }

        :host #save-settings-button:hover {
            background-color: #4527a0;
        }

        :host(.dirty) .form-actions {
            display: flex !important;
        }

        :host(.dirty) #delete-settings-button {
            display: none;
        }

        @media only screen and (max-width: 600px) {
            :host .setting-select {
                margin: 12px 8px;
            }
        }
    </style>

    <div class="setting-select row">
        <select id="setting-select"></select>
        <div id="add-settings-button" title="Create new settings">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="currentColor"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
        </div>
    </div>

    <div class="form-actions row hidden">
        <button id="save-settings-button" type="button">SAVE</button>
        <button id="cancel-settings-button" type="button">CANCEL</button>
    </div>

    <form class="column card">
        <div id="delete-settings-button">
            DELETE
        </div>
        <div class="input column">
            <label for="settingsName">Settings name *</label>
            <input id="settingsName" name="settingsName" required="">
        </div>
        <div class="form-content flex"></div>
    </form>
`;Si=class extends HTMLElement{listeners=[];formEl;formContentEl;selectEl;settingsNameEl;formIsDirty=!1;formIsNew=!1;constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot?.appendChild(document.importNode(Ma.content,!0))}connectedCallback(){this.formEl=this.shadowRoot?.querySelector("form"),this.formContentEl=this.shadowRoot?.querySelector(".form-content"),this.selectEl=this.shadowRoot?.querySelector("#setting-select"),this.settingsNameEl=this.shadowRoot?.querySelector("#settingsName");let e=f=>{!this.formIsDirty&&f.target.id!=="setting-select"&&(this.formIsDirty=!0,this.classList.add("dirty"))};this.formEl?.addEventListener("input",e),this.listeners.push(()=>{this.formEl?.removeEventListener("input",e)}),this.refreshSelect();let r=()=>{this.selectEl&&this.loadSettings(this.selectEl.selectedIndex)};this.selectEl?.addEventListener("change",r),this.listeners.push(()=>{this.selectEl?.removeEventListener("change",r)});let i=this.shadowRoot?.querySelector("#add-settings-button"),s=()=>{this.add()};i?.addEventListener("click",s),this.listeners.push(()=>i?.removeEventListener("click",s));let n=this.shadowRoot?.querySelector("#delete-settings-button"),o=()=>{this.delete()};n?.addEventListener("click",o),this.listeners.push(()=>n?.removeEventListener("click",o));let a=this.shadowRoot?.querySelector("#save-settings-button"),d=()=>{this.saveAndReload()};a?.addEventListener("click",d),this.listeners.push(()=>a?.removeEventListener("click",d));let c=this.shadowRoot?.querySelector("#cancel-settings-button"),p=()=>{this.cancel()};c?.addEventListener("click",p),this.listeners.push(()=>c?.removeEventListener("click",p)),this.refreshFormContent(window.appSettings.getCurrentSettings())}disconnectedCallback(){this.listeners.forEach(e=>{e()})}loadSettings(e){window.appSettings.setCurrentSettingsIndex(e),location.reload()}add(){let e="New settings",r=document.createElement("option");r.selected=!0,r.value=e,r.textContent=e,this.selectEl?.appendChild(r),this.formIsNew=!0,this.formIsDirty=!0,this.classList.add("dirty"),this.refreshFormContent({name:e,librarySettings:bt})}delete(){window.appSettings.deleteCurrentSettings(),window.appSettings.setCurrentSettingsIndex(0),location.reload()}cancel(){this.formIsNew=!1,this.formIsDirty=!1,this.classList.remove("dirty"),this.refreshSelect(),this.refreshFormContent(window.appSettings.getCurrentSettings())}setPathValue(e,r,i){let s=r.split(".");s.reduce((n,o,a)=>(a===s.length-1?(typeof i=="string"&&i.trim()===""&&(i=void 0),n[o]=i):(!(o in n)||typeof n[o]!="object"||n[o]===null)&&(n[o]={}),n[o]),e)}getPathValue(e,r){return r.split(".").reduce((i,s)=>i&&typeof i=="object"&&s in i?i[s]:void 0,e)}refreshSelect(){this.selectEl&&(this.selectEl.innerHTML="");let{settings:e,currentSettingsIndex:r}=window.appSettings.get();e.forEach((i,s)=>{let n=document.createElement("option");n.selected=s===r,n.value=i.name,n.textContent=i.name,this.selectEl?.appendChild(n)})}refreshFormContent(e){if(this.formContentEl&&(this.formContentEl.innerHTML=""),this.settingsNameEl){let r=window.appSettings.getLibrarySettingsDefinition(),{name:i,librarySettings:s}=e;this.settingsNameEl.value=i,r.sort((o,a)=>(a._sortIndex||0)-(o._sortIndex||0)).forEach(o=>{let a=document.createElement("div");this.formContentEl?.prepend(a);let d=document.createElement("label");d.htmlFor=o.name.replace(".",""),d.textContent=`${o.label}${o.required?" *":""}`;let c=document.createElement(o.type==="list"?"select":"input");switch(c.id=o.name.replace(".",""),c.name=o.name.replace(".",""),c.required=o.required===!0,o.type){case"boolean":c.checked=this.getPathValue(s,o.name),c.type="checkbox",a.appendChild(c),a.appendChild(d);break;case"list":o.values?.forEach(p=>{let f=document.createElement("option");f.value=String(p.value),f.textContent=p.label,c.appendChild(f)}),c.value=this.getPathValue(s,o.name),c.classList.add("flex"),a.classList.add("input","column"),a.appendChild(d),a.appendChild(c);break;default:{let p=this.getPathValue(s,o.name);o.type==="json"?c.value=p?JSON.stringify(p):"":c.value=p??"",o.placeholder&&(c.placeholder=o.placeholder),a.classList.add("input","column"),a.appendChild(d),a.appendChild(c);break}}});let n=this.shadowRoot?.querySelector("#automaticInjectToken");n&&(n.onclick=()=>{if(!n.checked){let o=this.shadowRoot?.querySelector("#automaticInjectTokenheaderName");o&&(o.disabled=!0,o.value="");let a=this.shadowRoot?.querySelector("#automaticInjectTokeninclude");a&&(a.disabled=!0,a.value="");let d=this.shadowRoot?.querySelector("#automaticInjectTokenexclude");d&&(d.disabled=!0,d.value="")}})}}saveAndReload(){if(this.formEl?.reportValidity()&&this.settingsNameEl){let e=window.appSettings.getLibrarySettingsDefinition(),r=this.formIsNew?{name:"",librarySettings:{}}:window.appSettings.getCurrentSettings();if(r.name=this.settingsNameEl.value,e.sort((s,n)=>(s._sortIndex||0)-(n._sortIndex||0)).forEach(s=>{let n=this.shadowRoot?.querySelector(`#${s.name.replace(".","")}`),o;switch(s.type){case"boolean":o=n.checked;break;case"list":o=n.value;break;case"json":try{let a=n.value;a&&a.trim()!==""&&(o=JSON.parse(a))}catch(a){console.error(a)}break;default:o=n.value;break}this.setPathValue(r.librarySettings,s.name,o)}),!this.shadowRoot?.querySelector("#automaticInjectToken")?.checked)r.librarySettings.automaticInjectToken=!1;else{let s=r.librarySettings.automaticInjectToken;typeof s=="object"&&((!s.headerName||s.headerName.trim()==="")&&(!s.include||s.include.trim()==="")&&(!s.exclude||s.exclude.trim()==="")?s=!0:(s.include&&(s.include=s.include.split(",")),s.exclude&&(s.exclude=s.exclude.split(","))),r.librarySettings.automaticInjectToken=s)}if(this.formIsNew){let s=window.appSettings.addOrUpdateSettings(r);this.selectEl&&s&&window.appSettings.setCurrentSettingsIndex(s)}else window.appSettings.addOrUpdateSettings(r,window.appSettings.get().currentSettingsIndex);location.reload()}}};window.customElements.define("demo-app-settings",Si)});var Ci=u(()=>{"use strict";Aa();Ia();Ra();Pa();Va();Ue();hr();va();mi()});var rh,jw,ih,Oa,sh,Ua,Na=u(()=>{"use strict";ve();ve();rh={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},jw=H(S({},rh),{"[class.ng-submitted]":"isSubmitted"}),ih=new It("",{providedIn:"root",factory:()=>Oa}),Oa="always",sh=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=br({type:t});static \u0275inj=wr({})}return t})(),Ua=(()=>{class t{static withConfig(r){return{ngModule:t,providers:[{provide:ih,useValue:r.callSetDisabledState??Oa}]}}static \u0275fac=function(i){return new(i||t)};static \u0275mod=br({type:t});static \u0275inj=wr({imports:[sh]})}return t})()});var nh,ja,Fa=u(()=>{"use strict";Wa();$a();ve();Na();Er();gi();Ci();ve();nh=["demoAppPlayground"],ja=(()=>{class t{demoAppPlaygroundEl;authService=G(wt);httpClient=G(Ni);router=G(je);callPrivateApi(r){let{url:i,headers:s}=r.detail;if(i){let n=this.demoAppPlaygroundEl.nativeElement;this.httpClient.get(i,s?{headers:new Ui(s)}:{}).subscribe({next:o=>{n.setApiStatus(o,!1)},error:o=>{n.setApiStatus(o,!0)}})}}navigate(r,i){return l(this,null,function*(){let{queryParams:s}=i.detail;yield this.router.navigate([r],{queryParams:s})})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=Ri({type:t,selectors:[["app-demo"]],viewQuery:function(i,s){if(i&1&&Pi(nh,5),i&2){let n;Mi(n=Vi())&&(s.demoAppPlaygroundEl=n.first)}},decls:15,vars:27,consts:[["demoAppPlayground",""],[3,"login","logout","silentRenew","isRenewing","isAuthenticated"],["tabLabel","Playground",3,"api","home","public","private","protected"],["tabLabel","Debug",3,"isAuthenticated","userProfile","userSession","idToken","idTokenDecoded","accessToken","accessTokenDecoded"],["tabLabel","Settings"]],template:function(i,s){if(i&1){let n=Di();Sr(0,"demo-app-main",1),te(1,"async"),te(2,"async"),Rt("login",function(){return ce(n),ue(s.authService.login())})("logout",function(){return ce(n),ue(s.authService.logout({redirectUrl:"/"}))})("silentRenew",function(){return ce(n),ue(s.authService.renew())}),Sr(3,"demo-app-playground",2,0),Rt("api",function(a){return ce(n),ue(s.callPrivateApi(a))})("home",function(a){return ce(n),ue(s.navigate("/",a))})("public",function(a){return ce(n),ue(s.navigate("public",a))})("private",function(a){return ce(n),ue(s.navigate("private",a))})("protected",function(a){return ce(n),ue(s.navigate("protected",a))}),Tt(5,"router-outlet"),Cr(),Tt(6,"demo-app-debug",3),te(7,"async"),te(8,"async"),te(9,"async"),te(10,"async"),te(11,"async"),te(12,"async"),te(13,"async"),Tt(14,"demo-app-settings",4),Cr()}i&2&&(xr("isRenewing",re(1,9,s.authService.isRenewing$))("isAuthenticated",re(2,11,s.authService.isAuthenticated$)),Ii(6),xr("isAuthenticated",re(7,13,s.authService.isAuthenticated$))("userProfile",re(8,15,s.authService.userProfile$))("userSession",re(9,17,s.authService.userSession$))("idToken",re(10,19,s.authService.idToken$))("idTokenDecoded",re(11,21,s.authService.idTokenDecoded$))("accessToken",re(12,23,s.authService.accessToken$))("accessTokenDecoded",re(13,25,s.authService.accessTokenDecoded$)))},dependencies:[Ua,ji,Oi],styles:[`.flex{flex:1}.hidden{display:none!important}.row{display:flex;flex-direction:row}.column{display:flex;flex-direction:column}.card{border:1px solid rgba(0,0,0,.12);border-radius:4px;background-color:#fff;margin:12px 6px}.card .card-status{display:block;width:10px;height:10px;border-radius:50%;margin-left:8px;background-color:#f2f2f2}.card .card-status.error{background-color:#ef5350}.card .card-status.success{background-color:#66bb6a}.card .card-title{padding:16px;font-size:20px;font-weight:500;color:#000000de;align-items:center}.card .box{height:200px;border-top:1px solid lightgray;word-break:break-all;overflow:auto;background-color:#f2f2f2;padding:12px}.card .box pre{margin:0}.card .card-actions{padding:0 14px 8px;min-height:50px}.card .card-actions .input{display:flex;align-items:center}.card .card-actions .input:not(:last-child){margin-bottom:8px}.card .card-actions .input label{width:125px;text-align:right;margin-right:14px}.card .card-actions .input input{padding:4px}.json-key{color:#7c4dff}.json-value{color:#437aed}.json-string{color:#53a053}.json-date{color:#c838c6}input{color:#5e35b1;padding:10px;border:1px solid rgba(0,0,0,.1215686275);border-radius:4px;font-size:14px}input:invalid{border-color:#f44336}input[type=checkbox]{margin-right:10px}select{color:#5e35b1;padding:8px 6px;border:1px solid rgba(0,0,0,.1215686275);border-radius:4px}button{cursor:pointer}@media only screen and (max-width: 600px){:host{padding:0 0 24px!important}:host .card{border-left:0;border-right:0;border-radius:0;margin:0 0 6px}}
`],encapsulation:3})}return t})()});var Ei,La,Ba=u(()=>{"use strict";gi();Ci();Fa();Ei=it({validator:Ca()}),La=[{path:"",component:ja,children:[{path:"forbidden",loadComponent:()=>import("./chunk-PKPGKJ5O.js").then(t=>t.PageComponent),runGuardsAndResolvers:"always",data:{title:"ACCESS FORBIDDEN"}},{path:"public",loadComponent:()=>import("./chunk-PKPGKJ5O.js").then(t=>t.PageComponent),runGuardsAndResolvers:"always",data:{title:"PUBLIC CONTENT"}},{path:"private",loadComponent:()=>import("./chunk-PKPGKJ5O.js").then(t=>t.PageComponent),runGuardsAndResolvers:"always",canMatch:[it()],canActivate:[it()],canActivateChild:[it()],data:{title:"PRIVATE CONTENT"}},{path:"protected",loadComponent:()=>import("./chunk-PKPGKJ5O.js").then(t=>t.PageComponent),runGuardsAndResolvers:"always",canMatch:[Ei],canActivate:[Ei],canActivateChild:[Ei],data:{title:"PROTECTED CONTENT"}}]}]});var ob,oh=u(()=>{"use strict";Ba();ob=[{path:"",children:La},{path:"**",pathMatch:"full",redirectTo:""}]});export{Fu as a,Lu as b,gi as c,_a as d,Ci as e,ob as f,oh as g};
